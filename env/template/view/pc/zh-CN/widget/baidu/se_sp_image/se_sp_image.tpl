{%fis_widget%}{%if $test%}<small>SP特型:image</small><p>{%/if%}{%$textOrImage = $res.dispData.StdStl%}{%if count($res.dispData.ImageAladdinResult) == 0%}{%$textOrImage = 1%}{%/if%}{%function name=image_rs%}{%$slinklength = 0%}{%foreach $res.dispData.ImageRsQuerys as $imgRsWord %}{%*计算子链总长度*%}{%$slinklength = $slinklength + $imgRsWord|limitlen:20|string_display_len%}{%if $imgRsWord@iteration > 4 || $slinklength > 56%}{%*如果子链的展现长度之和大于56字节时，则只展现N-1个子链接,最多只展现4个子链*%}{%break%}{%/if%}<a target="_blank" href="http://image.baidu.com/i?tn=baiduimage&ct=201326592&cl=2&lm=-1&st=-1&fm=rs{%$imgRsWord@iteration%}&fr=ala1&sf=1&fmq=1350297510862_R&pv=&ic=0&nc=1&z=&se=1&showtab=0&fb=0&width=&height=&face=0&istype=2&ie=utf-8&word={%urlencode($imgRsWord)%}" style="margin-right:15px">{%$imgRsWord|limitlen:20|highlight:4%}</a>{%/foreach%}{%/function%}{%if $textOrImage == 1%}{%if $test%}文字版{%/if%}<table cellpadding="0" cellspacing="0" class="result-op{%if $isSameSize==1%} c-res{%/if%}" id="{%$resIndex%}" srcid="{%$res.dispData.StdStg%}" mu="{%$res.dispData.TextAladdinSearchUrl%}"  tpl="se_sp_image"  data-click="{'rsv_bdr':'{%$res.burstFlag%}'}"><tr><td class="f" data-fm="{%enc_str str="altp"%}"><h3 class="t"><a target="_blank" href="{%enc_url url=$res.dispData.TextAladdinSearchUrl%}" ><em>{%$res.dispData.Query|vui_escape:'html'%}</em>_百度图片</a>{%fis_widget_inline%}{%if $isUserLogin == 1 && $isFavoOn == 1%}{%if $res.favoFlag == 1%}<span class="tsuf"><span class="fav fav_add" data-fav="1" data-id="{%$res.favoItemId%}" title="点击取消收藏" onmousedown="return c({'fm':'bfav','url':this.getAttribute('data-url'),'title':this.getAttribute('data-title'),'p1':bds.se.favo.favPos(this),'p2':0,'p3':1,tab:this.getAttribute('data-fav')});"></span></span>{%else%}<span class="tsuf"><span class="fav fav_nor" data-fav="0" data-id="0" title="点击收藏" onmousedown="return c({'fm':'bfav','url':this.getAttribute('data-url'),'title':this.getAttribute('data-title'),'p1':bds.se.favo.favPos(this),'p2':0,'p3':1,tab:this.getAttribute('data-fav')});"></span></span>{%/if%}{%/if%}{%/fis_widget_inline%}</h3><font size="-1">{%$res.dispData.TextAladdinTitle|highlight:4%}...{%$imageRsQuerylength = count($res.dispData.ImageRsQuerys)%}{%if $imageRsQuerylength>0%}<br>相关推荐：{%image_rs%}{%/if%}<br/><font color="#008000">{%$res.dispData.TextAladdinShowUrl%}{%$res.dispData.TextAladdinDate%}</font></font></td></tr></table>{%else if $textOrImage == 2%}{%if $resIndex == 1%}{%if $test%}第一位<br>{%/if%}{%$showType="big"%}{%else%}{%if $test%}不在第一位<br>{%/if%}{%$showType="small"%}{%/if%}{%if count($res.dispData.ImageAladdinResult)<11%}{%$showType="small"%}{%/if%}{%if $showType=="big"%}{%$bigImage = $res.dispData.ImageAladdinResult[0]%}{%$scale = $bigImage.Width / $bigImage.Height%}{%$bigImageLimit = 220%}{%if $scale > 1%}{%$bigImage.bigWidth = $bigImageLimit%}{%$bigImage.bigHeight = floor($bigImageLimit*$bigImage.Height/$bigImage.Width)%}{%else%}{%$bigImage.bigHeight = $bigImageLimit%}{%$bigImage.bigWidth = floor($bigImageLimit*$bigImage.Width/$bigImage.Height)%}{%/if%}{%if $bigImage.bigHeight < 167%}{%if $test%}高度不足165<br>{%/if%}{%$showType="small"%}{%/if%}{%/if%}{%if $showType=="big"%}{%$showcomplex=1%}{%else%}{%$bigImage.bigWidth=0%}{%/if%}{%$imgtotalwidth=538%}{%$imgmargin=0%}<table cellpadding="0" cellspacing="0" class="result-op{%if $isSameSize==1%} c-res{%/if%}" id="{%$resIndex%}" srcid="{%$res.dispData.StdStg%}" mu="{%$res.dispData.ImageAladdinSearchUrl%}" tpl="se_sp_image"  data-click="{'rsv_bdr':'{%$res.burstFlag%}'}"><tr><td class="f" data-fm="{%enc_str str="altp1"%}"><h3 class="t"><a href="{%$res.dispData.ImageAladdinSearchUrl%}" target="_blank" data-click="{'fm':'{%enc_str str="altp1"%}'}"><font size="3"><em>{%$res.dispData.Query|vui_escape:'html'%}</em>_百度图片</font></a>&nbsp;-&nbsp;<span class="OP_LOG_LINK" id="ala_img_report" style="font-size:13px;"><a style="color:#77c;" href="#" onclick="return BD.IMG.actions.showReport()">举报图片</a></span>{%fis_widget_inline%}{%if $isUserLogin == 1 && $isFavoOn == 1%}{%if $res.favoFlag == 1%}<span class="tsuf"><span class="fav fav_add" data-fav="1" data-id="{%$res.favoItemId%}" title="点击取消收藏" onmousedown="return c({'fm':'bfav','url':this.getAttribute('data-url'),'title':this.getAttribute('data-title'),'p1':bds.se.favo.favPos(this),'p2':0,'p3':1,tab:this.getAttribute('data-fav')});"></span></span>{%else%}<span class="tsuf"><span class="fav fav_nor" data-fav="0" data-id="0" title="点击收藏" onmousedown="return c({'fm':'bfav','url':this.getAttribute('data-url'),'title':this.getAttribute('data-title'),'p1':bds.se.favo.favPos(this),'p2':0,'p3':1,tab:this.getAttribute('data-fav')});"></span></span>{%/if%}{%/if%}{%/fis_widget_inline%}</h3><div id="ala_img_results" style="position:relative;margin-top:5px;margin-bottom:4px;width:{%$imgtotalwidth%}px;"><div id="ala_img_pics" style="position:relative;">{%if $showcomplex%}{%$leftbigimage = $res.dispData.ImageAladdinResult[0]%}<a id="ala_img_bigpic" data-click="{'fm':'{%enc_str str="altp1"%}'}" style="display:inline-block;position:relative;float:left;overflow:hidden;vertical-align:middle;outline:none;_margin-top:1px;margin-right:{%$imgmargin%}px;width:{%$bigImage.bigWidth%}px;" target="_blank" href="{%enc_url url=$leftbigimage.AladdinImageUrl%}"><img id="ala_img_bigimg" style="height:{%$bigImage.bigHeight%}px;width:{%$bigImage.bigWidth%}px;" onerror="BD.IMG.err(this)" src="{%if $leftbigimage.MiddleThumbnailImageUrl%}{%$leftbigimage.MiddleThumbnailImageUrl%}{%else%}{%$leftbigimage.LargeThumbnailImageUrl%}{%/if%}" /><input type="button" style="position:absolute;display:none;bottom:3px;right:3px;border:1px solid #CCC;background:#FAFAFA;width:35px;height:23px;padding:0 4px;text-align:center;cursor:pointer;opacity:0.8;filter:alpha(opacity=80)"class="OP_LOG_BTN" value="举报" onclick="BD.IMG.actions.reportPic('{%$leftbigimage.ImageFromUrl%}','{%$leftbigimage.ImageObjUrl%}','{%$leftbigimage.ImageID%}','{%$res.dispData.Query|vui_escape:'html'%}',this);return false;"/></a><div id="ala_img_ptline" style="float:left;width:{%$imgtotalwidth-$bigImage.bigWidth-$imgmargin%}px;"></div><div id="ala_img_pbline" style="float:left;width:{%$imgtotalwidth-$bigImage.bigWidth-$imgmargin%}px;margin-top:{%$imgmargin%}px;"></div>{%/if%}</div><a target="_blank" id="ala_img_hoverview" style="position:absolute;display:none;width:0px;height:0px;overflow:hidden;outline:none;box-shadow:rgb(100,100,100) 0 0 10px;"></a>{%$imageRsQuerylength = count($res.dispData.ImageRsQuerys)%}{%if $imageRsQuerylength>0%}<div style="margin:5px 0"><font size="-1">相关推荐：{%image_rs%}</font></div>{%/if%}</div><span id="ala_img_desc" style="color:#008000;font-size:13px;">image.baidu.com&nbsp;-&nbsp;<a style="color:#666;" target="_blank" href="{%$res.dispData.ImageAladdinSearchUrl%}">查看全部{%$res.dispData.DisplayTotalCountStr%}张图片</a></span></td><script >
		if(typeof(BD)!="undefined"){BD.IMG={}}else{BD={};BD.IMG={}};BD.IMG.fmdata="{%enc_str str="altp1"%}";BD.IMG.query="{%$res.dispData.Query|vui_escape:"html"%}";BD.IMG.boxwidth={%$imgtotalwidth-$bigImage.bigWidth-$imgmargin%};BD.IMG.boxheight={%if $showcomplex%}105{%else%}95{%/if%};BD.IMG.bleed=5;BD.IMG.margin={%$imgmargin%};{%if $showcomplex%}BD.IMG.complex=1;{%/if%}
		BD.IMG.pics = [{%section loop=$res.dispData.ImageAladdinResult name=i%}{%$imageItem=$res.dispData.ImageAladdinResult[i]%}{%if $smarty.section.i.index!= 0%},{%/if%}[{%$imageItem.Width%},{%$imageItem.Height%},"{%if $imageItem.MiddleThumbnailImageUrl%}{%$imageItem.MiddleThumbnailImageUrl%}{%else%}{%$imageItem.LargeThumbnailImageUrl%}{%/if%}","{%$imageItem.AladdinImageUrl%}","{%$imageItem.ImageFromUrl%}","{%$imageItem.ImageObjUrl%}","{%$imageItem.ImageID%}","{%$imageItem.HoverURL%}"]{%/section%}];
	</script><script compress>BD.IMG.err = function(obj){obj.style.display ="none";obj.parentNode.style.display ="none";};BD.IMG.disabledInput = [];BD.IMG.actions = {ini : function(){var titleHtml = "<a href='#' style='color:#77c' onclick='return BD.IMG.actions.showReport();'>举报图片</a>";document.getElementById("ala_img_report").innerHTML = titleHtml;BD.IMG.hideReportDiv();return false;},showReport : function(){var titleHtml = "请举报图片&nbsp;-&nbsp;<a href='#' style='color:#77c' onclick='return BD.IMG.a{%*i*%}ctions.ini();'>取消</a>&nbsp;";document.getElementById("ala_img_report").innerHTML = titleHtml;BD.IMG.showReportDiv();return false;},reportPic : function (f,u,di,q,_this){_this.value="已报";_this.disabled = true;BD.IMG.disabledInput.push(di);var matches = document.cookie.match(/BAIDUID=([^;]+)/);var cookie = "";if(matches !=null){cookie = "&uid="+matches[1];}var img = new Image();img.src = "http://imgstat.baidu.com/4.gif?p=18&fr=ala2&hostfr=imgstat&u="+u+"&f="+f+"&di="+di+"&q="+q+cookie+"&"+new Date{%*i*%}()*Math.random();this.hideReport();},hideReport : function(){var picNum = (document.getElementById("ala_img_pics").getElementsByTagName("a").length-1)/2;var continueHtml = "感谢您的举报&nbsp;-&nbsp;<a href='#' style='color:#77c' onclick='return BD.IMG.actions.showReport();'>继续举报</a>";var endHtml = "感谢您的举报";var reportLength = BD.IMG.disabledInput.length;if(reportLength<picNum&&reportLength>0){document.getElementById("ala_img_report").innerHTML = continueHtml;}else if(reportLength ==0){this.ini();}else{{%*i*%}document.getElementById("ala_img_report").innerHTML = endHtml;}BD.IMG.hideReportDiv();return false;}};BD.IMG.showReportDiv = function(){var reportdivs = document.getElementById("ala_img_pics").getElementsByTagName("input");for(var i=0;i<reportdivs.length;i++){var rd = reportdivs[i];if(rd!=null){rd.style.display = ""};};BD.IMG.reporting = 1;};BD.IMG.hideReportDiv = function(){var reportdivs = document.getElementById("ala_img_pics").getElementsByTagName("input");for(var i=0;i<reportdivs.length;i++{%*i*%}){var rd = reportdivs[i];if(rd!=null){rd.style.display = "none"};};BD.IMG.reporting = 0;};BD.IMG.justify = function(pics,images,boxwidth,boxheight,bleed,margin){var scaleimg = function(){var totalwidth = 0;for(var i=0;i<pics.length;i++){var scale = boxheight/pics[i][1];pics[i][0] = Math.round(pics[i][0] * scale);pics[i][1] = Math.round(pics[i][1] * scale);totalwidth += pics[i][0] + ((i==pics.length - 1) ? 0 : margin);};if(boxwidth > totalwidth){var lack = boxwidth - totalwidth;var last = pics.le{%*i*%}ngth - 1;var scale = (pics[last][0]+lack)/pics[last][0];pics[last][0] = pics[last][0]+lack;pics[last][1] = Math.round(pics[last][1]*scale);};};var calculate = function(){var totalwidth = 0;var totalshowwidth = 0;for(var i=0;i<pics.length;i++){totalwidth += pics[i][0] + margin;if(totalwidth >= boxwidth){totalwidth = totalwidth - margin;var cut = Math.ceil((totalwidth - boxwidth) / (i + 1));var paddingleft = Math.round(cut/2);var paddingtop = 0;if(paddingleft <= bleed){for(var index=0;index<(i+1);{%*i*%}index++){var showwidth = pics[index][0] - cut;totalshowwidth += showwidth;if(index!=i){totalshowwidth += margin};var showheight = boxheight;paddingtop = Math.round((pics[index][1] - boxheight)/2);var marginleft = margin;if(index==0){marginleft = 0};var imgobj = {};imgobj.rw = pics[index][0];imgobj.rh = pics[index][1];imgobj.sw = showwidth;imgobj.sh = showheight;imgobj.pl = paddingleft;imgobj.src = pics[index][2];imgobj.href = pics[index][3];imgobj.fromurl = pics[index][4];imgobj.objurl = pics[in{%*i*%}dex][5];imgobj.imgid = pics[index][6];imgobj.query = pics[index][7];imgobj.hsrc = pics[index][8];imgobj.ml = marginleft;images.push(imgobj);}var widthfixnum = boxwidth - totalshowwidth;if(widthfixnum > i + 1){widthfixnum = i + 1};if(paddingleft > 0){for(var f=0;f<widthfixnum;f++){images[f].sw++;images[f].pl--;}}return 0;}else{return paddingleft - bleed;}break;}}};scaleimg();return calculate();};BD.IMG.appendpic = function(box,img){box.innerHTML = box.innerHTML + "<a data-click='{\'fm\':\'"+BD.IM{%*i*%}G.fmdata+"\'}' style='display:inline-block;position:relative;overflow:hidden;vertical-align:middle;outline:none;margin-left:"+img.ml+"px;width:"+img.sw+"px;height:"+img.sh+"px;' target='_blank' href='"+img.href+"'><img style='height:"+img.rh+"px;width:"+img.rw+"px;margin-left:-"+img.pl+"px;' onerror='BD.IMG.err(this)' src='"+img.src+"' /><input type='button' style='position:absolute;display:none;bottom:3px;right:3px;border:1px solid #CCC;background:#FAFAFA;width:35px;height:23px;padding:0 4px;te{%*i*%}xt-align:center;cursor:pointer;opacity:0.8;filter:alpha(opacity=80)' class='OP_LOG_BTN' value='举报' onclick=\"BD.IMG.actions.reportPic('"+img.fromurl+"','"+img.objurl+"','"+img.imgid+"','"+BD.IMG.query+"',this);return false;\" data-hsrc='"+img.hsrc+"'/></a>";};if(BD.IMG.complex){BD.IMG.picts=[];BD.IMG.picbs=[];BD.IMG.imagets = [];BD.IMG.imagebs = [];BD.IMG.boxtheight = BD.IMG.boxheight;BD.IMG.boxbheight = BD.IMG.boxheight;for(var b=1;b<BD.IMG.pics.length;b++){if(b%2){BD.IMG.picbs.push(BD.IMG.pics{%*i*%}[b]);}else{BD.IMG.picts.push(BD.IMG.pics[b]);}};while(BD.IMG.justify(BD.IMG.picts,BD.IMG.imagets,BD.IMG.boxwidth,BD.IMG.boxtheight,BD.IMG.bleed,BD.IMG.margin)){BD.IMG.boxtheight--;if(BD.IMG.boxtheight<=0){break};};for(var m=0;m<BD.IMG.imagets.length;m++){BD.IMG.appendpic(document.getElementById("ala_img_ptline"),BD.IMG.imagets[m]);};while(BD.IMG.justify(BD.IMG.picbs,BD.IMG.imagebs,BD.IMG.boxwidth,BD.IMG.boxbheight,BD.IMG.bleed,BD.IMG.margin)){BD.IMG.boxbheight--;if(BD.IMG.boxbheight<=0){break};}{%*i*%};for(var m=0;m<BD.IMG.imagebs.length;m++){BD.IMG.appendpic(document.getElementById("ala_img_pbline"),BD.IMG.imagebs[m]);};document.getElementById("ala_img_bigpic").style.height = (BD.IMG.boxtheight+BD.IMG.boxbheight+BD.IMG.margin)+"px";if(document.getElementById("ala_img_bigimg").offsetHeight < (BD.IMG.boxtheight+BD.IMG.boxbheight+BD.IMG.margin)){document.getElementById("ala_img_bigimg").style.height = (BD.IMG.boxtheight+BD.IMG.boxbheight+BD.IMG.margin)+"px";};document.getElementById("ala_img_pi{%*i*%}cs").style.height = (BD.IMG.boxtheight+BD.IMG.boxbheight+BD.IMG.margin)+"px";document.getElementById("ala_img_ptline").style.height = BD.IMG.boxtheight+"px";document.getElementById("ala_img_pbline").style.height = BD.IMG.boxbheight+"px";}else{BD.IMG.images = [];while(BD.IMG.justify(BD.IMG.pics,BD.IMG.images,BD.IMG.boxwidth,BD.IMG.boxheight,BD.IMG.bleed,BD.IMG.margin)){BD.IMG.boxheight--;if(BD.IMG.boxheight<=0){break};};for(var m=0;m<BD.IMG.images.length;m++){BD.IMG.appendpic(document.getElementB{%*i*%}yId("ala_img_pics"),BD.IMG.images[m]);};};bds.ready(function(){A.use('jquery', function(){var $ = A.ui.jquery;var $container = $("#ala_img_results");var $con = $("#ala_img_pics");var $imgs = $con.find("a");var $vb = $("#ala_img_hoverview");var $alink,$img,dclick,dhref,ol,ot,w,h,rw,rh,scale,nw,nh;$imgs.bind("mouseenter",function(){if(!BD.IMG.reporting){$(this).css("cursor","default");showViewBox(this);}});$vb.bind("mouseleave",function(){hideViewBox();});$container.bind("mouseleave",function(){hi{%*i*%}deViewBox();});function showViewBox(alink){$alink = $(alink);$vb.html($alink.html()).css({"left":ol+"px","top":ot+"px"}).show();$img = $vb.find("img");dclick = $alink.attr("data-click");dhref = $alink.attr("href");ol = alink.offsetLeft;ot = alink.offsetTop;w = $alink.width();h = $alink.height();rw = $alink.find("img").width();rh = $alink.find("img").height();scale = 0.1;nw = w + w*scale*2;nh = h + h*scale*2;if(scale*h > 10){scale = 10/h;nh = h + h*0.2;nw = w + w*scale*2;}$img.stop().animate({wid{%*i*%}th : rw + rw*scale*2 + "px",height : rh + rh*scale*2 + "px"},100);$vb.stop().attr({"data-click":dclick,"href":dhref}).css({display : "block",left : ol,top : ot,width : w + "px",height : h + "px"}).animate({left : ol - w*scale,top : ot - h*scale,width : w + w*scale*2 + "px",height : h + h*scale*2 + "px"},100); };function hideViewBox(){if($img && $vb){$img.stop().animate({width : rw + "px",height : rh + "px"},100).css("cursor","pointer");$vb.stop().animate({left : ol,top : ot,width : w + "px",heig{%*i*%}ht : h + "px"},100).hide();}};});});</script></tr></table>{%else%}<table class="result-op{%if $isSameSize==1%} c-res{%/if%}" {%if $isUserLogin == 1%}data-favo="{'flag':'{%$res.favoFlag%}','id':'{%$res.favoItemId%}'}"{%/if%} cellpadding="0" cellspacing="0" id="{%$resIndex%}" mu="{%$res.offsetInfo.url%}" data-op="{'y':'{%$res.identifyStr%}'}"  tpl="se_sp_image">{%$res.offsetInfo.title%}</table>{%/if%}{%/fis_widget%}