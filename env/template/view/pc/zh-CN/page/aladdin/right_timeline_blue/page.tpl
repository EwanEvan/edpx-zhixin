{%extends 'c_right_base.tpl'%} {%block name='content'%}{%function name="showWeiboComment"%} <div style="background:#f5f5f5;padding:5px;{%if $border%}border-top:1px dotted #e5e5e5{%/if%}"> <span class="opr-timeline-weibo_comment"> <span class="opr-timeline-{%$itemcmt.userDegree|replace:' ':''|escape%}" style="color:#00c"><a href="{%$itemcmt.userUrl|escape%}" target="_blank">{%$itemcmt.userName|escape%}</a></span>:{%$itemcmt.text|escape%} &nbsp;&nbsp;<a href="{%$itemcmt.url|escape%}" target="_blank">转发</a> </span> </div>{%/function%}{%function name=showEventItem i=''%}<div {%if $i==1%}class="opr-timeline-first"{%/if%}> {%if $i==1%}<span class="opr-timeline-circle"></span><span class="c-text c-text-danger">最新</span><span class="c-gap-left-small c-gap-right-small opr-timeline-gray">-</span>{%/if%}{%if $itemData["type"]=="news"%}<a data-tp="news" href="{%$itemData.resrcTitle.url|escape%}" target="_blank" title="{%$itemData.resrcTitle.text|escape%}" class="opr-timeline-subitem_title">{%$itemData.resrcTitle.text|escape%}</a></div> <div class="opr-timeline-gray">{%$itemData.resrcRef|regex_replace:"/\s$/":""|escape%}<span class="c-gap-left">{%$itemData.resrcTime|escape%}</span></div>{%elseif $itemData["type"]=="img"%}<a data-tp="img" href="{%$itemData.resrcTitle.url|escape%}" target="_blank" title="{%$itemData.resrcTitle.text|escape%}" class="opr-timeline-subitem_title">{%$itemData.resrcTitle.text|escape%}</a></div> <div class="opr-timeline-imgbox c-gap-top-small c-gap-bottom-small"><a data-tp="img" data-ct="img" href="{%$itemData.resrcImg.url|escape%}" target="_blank"><img src="{%trim($itemData.resrcImg.src)|escape%}" class="c-img c-img6"></a></div> <div class="opr-timeline-gray">{%$itemData.resrcRef|regex_replace:"/\s$/":""|escape%}<span class="c-gap-left">{%$itemData.resrcTime|escape%}</span></div>{%elseif $itemData["type"]=="video"%}<a data-tp="video" href="{%$itemData.resrcTitle.url|escape%}" target="_blank" title="{%$itemData.resrcTitle.text|escape%}" class="opr-timeline-subitem_title">{%$itemData.resrcTitle.text|escape%}</a></div><div  class="opr-timeline-imgbox c-gap-top-small c-gap-bottom-small c-clearfix"><a class="opr-timeline-img-p" data-tp="video" data-ct="img" href="{%$itemData.resrcImg.url|escape%}" target="_blank"><img src="{%trim($itemData.resrcImg.src)|escape%}" alt="{%$itemData.resrcTitle.text|escape%}" class="c-img c-img6"><i href="javascript:;" class="c-icon c-icon-play-black opr-timeline-videoicon"></i></a></div> <div class="opr-timeline-gray">{%$itemData.resrcRef|regex_replace:"/\s$/":""|escape%}<span class="c-gap-left">{%$itemData.resrcTime|escape%}</span></div>{%elseif $itemData["type"]=="weibo"%}<span class="opr-timeline-weibo_content"><span class="opr-timeline-{%$itemData.weiboUser.userDegree|replace:' ':''|escape%}" style="color:#00c"><a data-tp="weibo" href="{%$itemData.weiboUser.userUrl|escape%}" target="_blank" >{%$itemData.weiboUser.userName|escape%}</a></span>:{%$itemData.weiboText%}</span></div> {%if $itemData.weiboVideo%} <div  class="opr-timeline-imgbox c-gap-top-small c-gap-bottom-small c-clearfix"><a class="opr-timeline-img-p" data-tp="weibo" data-ct="img" href="{%$itemData.weiboVideo.url|escape%}" target="_blank"><img src="{%trim($itemData.weiboVideo.src)|escape%}" class="c-img c-img6"><div class="opr-timeline-mask">&nbsp;</div><div class="opr-timeline-text">{%$itemData.weiboVideo.videoTime|escape%}</div></a></div> {%/if%} {%if $itemData.weiboImg%} <div class="c-gap-top-small c-gap-bottom-small"><a  data-tp="weibo" data-ct="img"  href="{%$itemData.weiboImg.url|escape%}" target="_blank"><img src="{%trim($itemData.weiboImg.src)|escape%}" class="c-img c-img6"></a></div>{%/if%} {%if $itemData.weiboHotCommentNum > 1%} {%foreach $itemData.weiboHotComment as $comment%} {%showWeiboComment itemcmt=$comment border=($comment@index>0)%} {%/foreach%} <div class="opr-timeline-weibo_comment_arr"></div> {%elseif $itemData.weiboHotCommentNum == 1%} {%showWeiboComment itemcmt=$itemData.weiboHotComment%} {%/if%} <div><a  data-tp="weibo" href="{%$itemData.weiboCC.url|escape%}" target="_blank">转发({%$itemData.weiboCC.num|escape%})</a><span class="c-gap-right c-gap-left opr-timeline-gray">|</span><a  data-tp="weibo" href="{%$itemData.weiboComment.url|escape%}" target="_blank">评论({%$itemData.weiboComment.num|escape%})</a></div> <div class="opr-timeline-gray">{%$itemData.resrcRef|regex_replace:"/\s$/":""|escape%}<span class="c-gap-left">{%$itemData.resrcTime|escape%}</span></div>{%else%} {%$itemData["type"]%}{%/if%}{%/function%}<!--[if lt IE 9]><style>.opr-timeline-first{text-indent:-45px}</style><![endif]-->{%if $extData.feData.hasOffset%}<style>.opr-timeline-logo{left:-26px}.opr-timeline-circle{left:-15px}</style>{%/if%}<div class="cr-title opr-timeline-tt c-gap-bottom"><div class="opr-timeline-logo"></div><span{%if !$extData.feData.hasOffset%} class="c-gap-left-small"{%/if%}>{%$tplData.title|escape%}</span></div><ul class="opr-timeline-box"> {%foreach $tplData.node as $itemevt%} {%if trim($itemevt.nodeType) == 'Year'%} <li class="opr-timeline-year"> <div class="opr-timeline-year_num"><i class="opr-timeline-circle"></i>{%$itemevt.nodeTitle|escape%}</div> </li> {%elseif trim($itemevt.nodeType) == 'New'%} <li class="opr-timeline-sub"> {%if $itemevt.abstract && trim($itemevt.abstract)%} <div class="opr-timeline-gray c-gap-top-small"> <span>{%$itemevt.abstract|escape%}</span> {%if $itemevt.abstractUrl && trim($itemevt.abstractUrl)%} <a href="{%$itemevt.abstractUrl|escape%}" target="_blank">详情&gt;&gt;</a> {%/if%} </div> {%/if%} {%if $itemevt.resrcNum == 1%} {%*showEventItem itemData=$itemevt.resrc*%} {%$itemevt.resrc=[$itemevt.resrc]%} {%/if%} {%foreach $itemevt.resrc as $srcitem%} <div class="opr-timeline-subitem {%if $srcitem@index>0%}opr-timeline-submore{%/if%}"> {%showEventItem itemData=$srcitem i=$srcitem@index+1%} </div> {%/foreach%} </li> {%else%} {%if trim($itemevt.nodeType) != 'New'%} <li class="opr-timeline-label c-clearfix"> <div class="opr-timeline-time"><i class="opr-timeline-circle"></i>{%if trim($itemevt.nodeTime)|strlen > 4%}{%$itemevt.nodeTime|regex_replace:"/201[0-9]\-?/":""|replace:" ":""|escape%}{%else%}{%$itemevt.nodeTime%}{%/if%}<span class="c-gap-right-small c-gap-left-small opr-timeline-hline">-</span></div> <div class="opr-timeline-title"> <a href="{%$itemevt.abstractUrl|escape%}" title="{%$itemevt.nodeTitle|escape%}" target="_blank" class="opr-timeline-title_a">{%$itemevt.nodeTitle|escape%}</a> </div> </li> {%/if%} {%/if%} {%/foreach%}</ul><script >
    A.setup({"platform": "{%$extData.feData.platform%}"});
</script><script>A.setup(function(){var _this = this;$(window).on("resize",winResize);function winResize(){if(_this.data.platform === 'pc' && bds.util.getWinWidth()>1207){$.each(_this.find('.opr-timeline-subitem_title'), function(i, a){a.innerHTML = lenlimt($.trim(a.getAttribute("title")),40);}); $.each(_this.find('.opr-timeline-title_a'), function(i, a){a.innerHTML = lenlimt($.trim(a.getAttribute("title")),40);}); }else{$.each(_this.find('.opr-timeline-subitem_title'), function(i, a){a.innerHTM{%*i*%}L = lenlimt($.trim(a.getAttribute("title")),30);}); $.each(_this.find('.opr-timeline-title_a'), function(i, a){a.innerHTML = lenlimt($.trim(a.getAttribute("title")),24);}); }}winResize();function lenlimt(str,length){if (length < 0 || $.getByteLength(str) <= length) {return str ;}str = str.substr(0,length).replace(/([^\x00-\xff])/g,"\x241 ").substr(0,length).replace(/[^\x00-\xff]$/,"").replace(/([^\x00-\xff]) /g,"\x241");return str + "...";};this.dispose = function(){$(window).off("resize",winRes{%*i*%}ize);};})</script>{%/block%}