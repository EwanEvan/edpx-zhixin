<?php 
  class CssJs_Util_right_singlepoint_hot
   {
      private static $cssStr = '';  // css字串，不含<style>和</style>标签
      private static $jsStr  = 'A.merge("right_singlepoint_hot",function(){A.setup(function(){var l=this,a,p=null,n=null,e=l.find(".opr-singlepoint-hot-map").eq(0),j=new Date().getTime(),d,g;var q="[,10)稀少 [10,70)密集 [70,)拥挤";var m={"稀少":"xishao","密集":"miji","拥挤":"yongji"};var i=l.find(".opr-singlepoint-hot-hot-level-tag");var h=("placeholder" in document.createElement("input"));A._____right_singlepoint_hot_map=function(){var R=false;var z=new BMap.Size(0,-115),I=new BMap.Size(0,-156),K=l.data.tplData.point[0],Q=new BMap.Point(K.lng,K.lat);map=new BMap.Map(l.find(".opr-singlepoint-hot-map").get(0),{enableMapClick:false});map.addControl(new BMap.NavigationControl({anchor:BMAP_ANCHOR_TOP_LEFT,type:BMAP_NAVIGATION_CONTROL_SMALL}));map.enableScrollWheelZoom();map.centerAndZoom(Q,10);var r="http://www.baidu.com/aladdin/img/jigou/markers.png",y=new BMap.Marker(Q),P=new BMap.Icon(r,new BMap.Size(34,39),{imageOffset:z}),C=new BMap.Icon(r,new BMap.Size(34,39),{imageOffset:I});y.setIcon(P);y.setTitle(K.title);map.addOverlay(y);var B=new BMap.Label(\'<a hideFocus="true" data-click="{fm:\\\'alxr\\\'}" href="\'+K.link+\'" target="_blank" class="opr-singlepoint-hot-map-label" title="\'+K.title+\'">\'+D(K.title,20)+"<a>",{offset:new BMap.Size(20,-10)});B.setStyle({border:"none",backgroundColor:"none"});y.setLabel(B);y.addEventListener("click",function(){window.open(K.link,"_blank");c({fm:"alxr",rsv_srcid:l.srcid,p1:l.p1,p5:l.p1,mu:l.mu,title:"point",rsv_xpath:"div-div3-div",rsv_tpl:"right_singlepoint_hot"})});map.addEventListener("dragstart",function(){c({fm:"beha",rsv_srcid:l.srcid,p1:l.p1,p5:l.p1,mu:l.mu,title:"drag",rsv_xpath:"div-div3-div",rsv_tpl:"right_singlepoint_hot"})});map.addEventListener("zoomstart",function(){c({fm:"beha",rsv_srcid:l.srcid,p1:l.p1,p5:l.p1,mu:l.mu,title:"zoom",rsv_xpath:"div-div3-div",rsv_tpl:"right_singlepoint_hot"})});map.addEventListener("tilesloaded",function(){if(!l.maploaded){l.maploaded=1;p=setTimeout(function(){e.attr("background","none")},500);g=new Date().getTime();ns_c({tab:"right_singlepoint_hot",waitTime:d-j,loadTime:g-d});var T=l.find(".BMap_stdMpPan .BMap_button");$.each(T,function(U,V){$(V).on("click",function(){c({fm:"beha",rsv_srcid:l.srcid,p1:l.p1,p5:l.p1,mu:l.mu,title:"control",rsv_xpath:"div-div3-div",rsv_tpl:"right_singlepoint_hot"})})})}});$(window).on("resize",J);var H=window.document.documentElement.clientWidth;function D(Z,T,W){var V=[],Y=Z.split("");W=W||"…";for(var X=0,U=Y.length;X<U;X++){if(Y[X].charCodeAt(0)>255){V.push("*")}V.push(Y[X])}if(T&&T>0&&V.length>T){Y=V.join("").substring(0,T-1).replace(/\\*/g,"")+W}else{return Z}return Y}function J(){var T=window.document.documentElement.clientWidth;if((H<1207&&T>1207)||(H>1207&&T<1207)){H=T;n=setTimeout(function(){map.centerAndZoom(Q,10)},100)}}if(l.data.isHotMap){var O=window.navigator.userAgent.match(/MSIE\\s*(\\d+)/);var L=O&&O[1]&&parseInt(O[1])<9;var N="rgb(215,57,32)";var v=l.data.tplData.poiname;if(!v){return}var t=l.data.tplData.cityname;var x=(bds&&bds.comm&&bds.comm.serverTime)?bds.comm.serverTime-60:parseInt(new Date().getTime()/1000)-60;x=parseInt((+new Date())/1000)-60;var w;var E="http://spotshot.baidu.com/getPoint.php?poiname="+encodeURIComponent(v)+"&city="+encodeURIComponent(t)+"&time="+x;var M="http://spotshot.baidu.com/getHotW.php?poiname="+encodeURIComponent(v)+"&city="+encodeURIComponent(t)+"&time="+x;var s="http://spotshot.baidu.com/getRankHotView.php?poiname="+encodeURIComponent(t)+"&subpoiname="+encodeURIComponent(v)+"&time="+x;$.ajax({url:s,dataType:"jsonp",timeout:6000}).done(function(U){if(U&&U.data&&U.data.hot!==undefined){var V=U.data.hot;var T=b(V,q);i.html(T).addClass("opr-singlepoint-hot-hot-level-"+m[T])}});if(L){$.ajax({url:"http://spotshot.baidu.com/getVersion.php",dataType:"jsonp",timeout:6000,jsonp:"callback",success:function(T){if(R){return}w=T.version;S();return}})}else{var G=document.createElement("script");l.container.appendChild(G);G.src="http://spotshot.baidu.com/js/heatmap.js";var F=document.createElement("script");l.container.appendChild(F);F.src="http://spotshot.baidu.com/js/heatmap-bmaps.js";$.ajax({url:M,dataType:"jsonp",timeout:6000,jsonp:"callback",success:function(V){if(R){return}var U=new HeatmapOverlay(map,{radius:10,visible:true,opacity:30});map.addOverlay(U);function W(Y){var aa=null;var ac=null;var Z=null;var X=null;T.data=[];for(var ab=0;ab<Y.length;ab++){tmpp=Y[ab];ac=tmpp.x;Z=tmpp.y;X=tmpp.hot;T.data.push({lat:ac,lng:Z,count:X})}}var T={max:4,data:[]};W(V.data);U.setDataSet(T)}});$.ajax({url:E,dataType:"jsonp",timeout:6000,jsonp:"callback",success:function(U){if(R){return}var aa=U.point;t=U.city?U.city:t;var X=[];for(var W=0,Y;Y=aa[W];W++){var Z=Y.split("|");var V=new BMap.Pixel(Z[0],Z[1]);X[W]=map.getMapType().getProjection().pointToLngLat(V)}var T="http://spotshot.baidu.com/getRankHotView.php?poiname="+encodeURIComponent(t)+"&time="+x;$.ajax({url:T,dataType:"jsonp",timeout:6000,jsonp:"callback",success:function(ab){for(var ad=0,ae;ae=ab.data[ad];ad++){if(ae.poiname==v){N=u(ae.hot)}}var ac=new BMap.Polygon(X,{strokeColor:N,strokeWeight:2,strokeOpacity:0.7,fillColor:N,fillOpacity:0.2});map.addOverlay(ac);map.setViewport(ac.getPath())}})}})}function u(U){var T=parseInt(U);if(1<=T&&T<10){return"rgb(44,200,2)"}else{if(10<=T&&T<25){return"rgb(255,201,115)"}else{if(25<=T&&T<40){return"rgb(254,170,58)"}else{if(40<=T&&T<55){return"rgb(254,135,0)"}else{if(55<=T&&T<70){return"rgb(255,84,18)"}else{if(70<=T&&T){return"rgb(215,57,32)"}}}}}}}function S(){var T=["http://shangetu0.map.bdimg.com/it/","http://shangetu1.map.bdimg.com/it/","http://shangetu2.map.bdimg.com/it/","http://shangetu3.map.bdimg.com/it/","http://shangetu4.map.bdimg.com/it/"];var W=new BMap.TileLayer({isTransparentPng:true});var U={x:K.lng,y:K.lat};var V=15;W.getTilesUrl=function(Y,aa){var ab=Y.x;var Z=Y.y;var X=T[Math.abs(ab+Z)%T.length]+"u=x="+ab+";y="+Z+";z="+aa+";v="+w+";type=hot&fm=44&t="+parseInt((new Date().getTime())/1000*60*10);return X.replace(/-(\\d+)/gi,"M$1")};map.addTileLayer(W)}}};function b(r,s){return s.replace(/(\\[|\\()(\\s?|\\d+)\\,(\\s?|\\d+)(\\]|\\))([^\\s]+)\\s?/g,function(y,w,v,t,u,x){v=w==="["?v:v===""?"":v-1;t=u==="]"?t:t===""?"":t-1;return(v===""?r<=t:r>=v&&(t===""?true:r<=t))?x:""})}k();function k(){var r=l.find(".opr-singlepoint-hot-content");r.each(function(u,v){var t=$(v);var w=t.find(".opr-singlepoint-hot-input").eq(0);if(!h){o(w)}var s=t.find(".opr-singlepoint-hot-btn");s.each(function(y,x){var z=$(x);z.click(function(){var E=$.trim(w.val());var D=w.attr("data-placeholder");if(E===""||E===D){return false}var C=z.attr("data-d")==="bus"?"bse":"nse";var B=z.attr("data-b");f(C,B,E)})})})}function f(w,r,t){var u="http://map.baidu.com/?newmap=1&s=";var s=w+"&wd="+t+"&t="+(+(r=="sn"))+"&"+r+"=1$$$$"+l.data.tplData.coord+"$$"+l.data.tplData.poiname+"$$$$$$";s=encodeURIComponent(s+l.data.tplData.mapurl);s="http://map.baidu.com/?newmap=1&s="+s+"&req="+encodeURIComponent(s);window.open(s)}function o(s){var r=$.trim(s.attr("data-placeholder"));if(r){s.val(r).css("color","#666").focus(function(){if(s.val()==r){s.val("").css("color","")}}).blur(function(){if($.trim(s.val())==""){s.val(r).css("color","#666")}})}}A.use("tabs5",function(){A.ui.tabs5(l.find(".opr-singlepoint-hot-tabs")[0],{toggleSep:false})});bds.ready(function(){d=new Date().getTime();$.getScript("http://api.map.baidu.com/api?v=1.4&callback=A._____right_singlepoint_hot_map")});this.dispose=function(){ajaxFinished=true;clearTimeout(p);clearTimeout(n)}})});';   // js字串，不含<script标签
      private static $uiList = 'input,tabs,btn';   // 包含的组件，以','分割的字符串，比如'input,text,button'这样
      
      public static function getHeadCss()
      {
         if (!is_string(self::$cssStr))
         {
            return '';
         }
         return self::$cssStr;
      }
      
      public static function getFootJs()
      {
         if (!is_string(self::$jsStr))
         {
            return '';
         }
         return self::$jsStr;
      }
      
      // 返回数组
      public static function getCssUI()
      {
		 if ( empty(self::$uiList) ) return array();

         $arr = @explode(',', self::$uiList);
         if (!is_array($arr))
         {
            $arr = array();
         }
         return $arr;
      }
   }
