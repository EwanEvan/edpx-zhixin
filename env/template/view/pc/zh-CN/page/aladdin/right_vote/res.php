<?php 
  class CssJs_Util_right_vote
   {
      private static $cssStr = '.opr-vote-container,.opr-vote-head-icon,.opr-vote-flipboard div,.opr-vote-btn-rank,.opr-vote-btn-start,.opr-vote-btn-end,.opr-vote-sharebtn,.opr-vote-share-icon{background:url(http://www.baidu.com/aladdin/img/chinavoice/chinavoice-vote-bg.png) no-repeat;}.opr-vote-container{position:relative;border:1px solid #efe7e6;background-position:0 -100px;padding-left:12px;padding-bottom:12px;zoom:1;}.opr-vote-head{height:40px;line-height:40px;}.opr-vote-head-icon{position:absolute;left:0;top:0;width:18px;height:29px;background-position:-204px 0;float:left;}.opr-vote-title{float:left;font-size:16px;font-weight:bold;color:#440a02;padding-left:10px;}.opr-vote-rule{float:left;margin-left:65px;color:#7b423a;}.opr-vote-flipboard-container{height:32px;line-height:32px;color:#7b423a;}.opr-vote-flipboard div{width:22px;height:31px;background-position:-204px -50px;float:left;margin-right:2px;padding:2px 1px 0 1px;}.opr-vote-flipboard span{width:20px;height:25px;background:url(http://www.baidu.com/aladdin/img/chinavoice/flipboardnums.png) no-repeat;display:block;}.opr-vote-rank-container{height:40px;margin-top:12px;}.opr-vote-btn-start,.opr-vote-btn-end{float:left;width:92px;height:40px;display:none;}.opr-vote-btn-rank{background-position:0 0;width:85px;float:left;text-align:center;color:#7b423a;}.opr-vote-btn-rank a{color:#7b423a;text-decoration:none;padding-top:2px;position:relative;top:2px;}.opr-vote-btn-rank a:hover{text-decoration:underline;}.opr-vote-currank{font-weight:bold;color:#c03320;}.opr-vote-btn-start{outline:none;font-size:23px;text-decoration:none;color:#fff;text-align:center;line-height:36px;cursor:pointer;margin-left:-1px;font-family:"Microsoft YaHei",微软雅黑;}.opr-vote-btn-start:link{background-position:-102px 0;}.opr-vote-btn-start:visited{background-position:-102px 0;}.opr-vote-btn-start:hover{background-position:-0 -50px;}.opr-vote-btn-start:active{background-position:-102px -50px;}.opr-vote-btn-end{background-position:-236px -50px;color:#fff;text-align:center;padding-top:2px;margin-left:-1px;}.opr-vote-btn-end-text{font-size:15px;font-family:"Microsoft YaHei",微软雅黑;}.opr-vote-btn-end-subend{line-height:12px;font-size:12px;}.opr-vote-share-box{height:22px;margin-top:9px;cursor:pointer;position:relative;display:none;}.opr-vote-sharebtn{background-position:-232px 0;width:45px;height:20px;line-height:20px;padding-left:10px;position:relative;float:left;overflow:hidden;}.opr-vote-share-icon{display:inline-block;width:7px;height:4px;left:38px;position:absolute;top:8px;overflow:hidden;}.opr-vote-sharebtn.opr-vote-sharebtn-down .opr-vote-share-icon{background-position:-298px 0;}.opr-vote-sharebtn.opr-vote-sharebtn-up .opr-vote-share-icon{background-position:-298px -4px;}.opr-vote-more{float:left;margin-left:10px;}.opr-vote-morelink{display:inline-block;color:#7b423a;}.opr-vote-container #bdshare{border:1px solid #bbb;display:none;margin-top:-1px;background:#fff;padding:3px 4px;box-shadow:1px 1px 1px rgba(0,0,0,0.1);}.opr-vote-bdshare-fillbox{height:38px;display:none;}.container_l .opr-vote-container{width:418px;padding-left:22px;}.container_l .opr-vote-title{padding-left:0;}.container_s .opr-vote-container{width:258px;padding-left:12px;}.container_s .opr-vote-title{padding-left:10px;}.container_l .opr-vote-rule{margin-left:75px;}.container_s .opr-vote-rule{margin-left:65px;}';  // css字串，不含<style>和</style>标签
      private static $jsStr  = 'A.merge("right_vote",function(){A.setup(function(){var d=this;var L=false;var D=d.find(".opr-vote-container").get(0);var J=d.find(".opr-vote-flipboard").eq(0);var x=d.find(".opr-vote-btn-start").eq(0);var q=d.find(".opr-vote-btn-end").eq(0);var c=d.find(".opr-vote-share-box").eq(0);var O=d.find(".opr-vote-sharebtn").eq(0);var C=d.find(".opr-vote-currank").eq(0);var h=d.container;var l=$.trim(d.data.playername);var I="";var i="https://openapi.baidu.com/rest/2.0/tieba/v1/superboy/player?player_name="+encodeURIComponent(l);var s="https://openapi.baidu.com/rest/2.0/tieba/v1/superboy/vote?player_id=#{playerid}&";var a="http://dev.open.baidu.com/gentoken.php?";var K=false;var v=1000;var p=3600;var M=bds.comm.serverTime;var y=null,r=null,o=null;y=setInterval(function(){M++},1000);var S=$(h);var f=$(D);var n=S.find("#bdshare");var G;var F=0;var N=0;var B=0;var k=0;var R;var H;var t=S.find("#bdshell_js");j();w();z();r=setTimeout(function(){Q()},5000);function w(){A.use("localstorage",function(){G=A.ui.localstorage({fileName:"bd_right_vote_chinavoice",expiresDay:7});G.init();g()})}function b(U){var T=G.get(U);var W={};if(T){try{W=$.parseJSON(T)}catch(V){}}return W}function g(){$.ajax({url:a+"baiduid="+encodeURIComponent($.getCookie("BAIDUID")),dataType:"jsonp",success:function(T){if(L){return}if(T.status==0){I=T.content;$.ajax({url:i+"&access_token="+encodeURIComponent(I),dataType:"jsonp",success:function(V){if(L){return}if(V&&V.errno===0&&V.errmsg=="success"&&V.ret){var U=V.ret;if(U&&U.length!=0&&U.player_id){F=U.vote_number;N=U.player_rank;R=U.player_id;if(u(R)){P()}else{m()}e(N,F)}else{e(0,0);m()}}else{e(0,0);m()}}})}else{e(0,0);m()}}})}function u(T){var U=b("chinavoice");var V=U["player"+T];if(V){B=V.votes;k=V.ranks;if(V.votetime&&(M-V.votetime)<=p){return false}else{return true}}else{return true}}function e(T,U){T=(k&&((T&&T<k)||!T))?k:T||0;U=(B&&((U&&U<B)||!U))?B:U||0;H=J.flipBoard({flipStep:"25px",flipTime:v});setTimeout(function(){H.flip(U)},0);C.html(T)}function E(){if(J.data("fliped")){F++;if(R){$.ajax({url:$.format(s+"cookie="+encodeURIComponent($.getCookie("BAIDUID"))+"&access_token="+encodeURIComponent(I),{playerid:R}),dataType:"jsonp",success:function(U){if(L){return}if(U&&U.errno==0){H.flip(F);var T=b("chinavoice");T["player"+R]={votetime:M,votes:F,ranks:N};G.set("chinavoice",$.stringify(T));m()}}})}}}function m(){x.css("display","none");q.show();c.show()}function P(){x.css("display","inline-block");q.hide();c.hide()}function z(){x.click(function(){E()});O.click(function(){Q();O.toggleClass("opr-vote-sharebtn-down opr-vote-sharebtn-up");n.toggle()})}function Q(){if(!K){t.get(0).src="http://share.baidu.com/static/js/shell_v2.js?cdnversion="+Math.ceil(new Date()/3600000);K=true}}function j(){(function(T){var V=document.createElement("div"),U=/([^ ]*) (.*)/;if(V.style.backgroundPositionX!==""){T(["X","Y"]).each(function(W,X){var Z="backgroundPosition"+X,Y=X=="X";T.cssHooks[Z]={set:function(aa,ab){var ac=aa.style.backgroundPosition;aa.style.backgroundPosition=(Y?ab+" ":"")+(ac?ac.match(U)[Y+1]:"0")+(Y?"":" "+ab)},get:function(ab,aa){var ac=aa?T.css(ab,"backgroundPosition"):ab.style.backgroundPosition;return ac.match(U)[!Y+1]}};T.fx.step[Z]=function(aa){T.cssHooks[Z].set(aa.elem,aa.now+aa.unit)}})}V=null})(jQuery);(function(T){T.fn.extend({flipBoard:function(ac){var V={flipStep:"25px",flipTime:1400};T.extend(V,ac);var Y=T(this);var U=Y.find("div");var ab=U.length;var Z=Y.find("span");var W=parseInt(V.flipStep);function X(ad){ad=ad||0;ad=""+Math.abs(parseInt(ad));if(ad.length<ab){ad=Array(ab-ad.length+1).join("0")+ad}return ad.split("")}var aa=function(){};return{get:function(){return Y},init:function(ad){ad=X(ad);T.each(ad,function(af,ag){var ae=Z.eq(af);ag&&ae.css("background-position-y","-"+ag*W+"px");ae.data("flipNum",ag)})},flip:function(ad){ad=X(ad);T.each(ad,function(ai,ak){Y.data("fliped",false);ak=parseInt(ak);var ag=Z.eq(ai);var af=ag.data("flipNum")||0;ag.css("backgroundPositionY","-"+af*W+"px");var aj=ak-af;var ah=Math.abs(aj);if(aj!=0){var ae="-="+(aj>0?(ah*W):((10-af+ak)*W))+"px";ag.animate({backgroundPositionY:ae},V.flipTime,function(){ag.data("flipNum",ak)})}o=setTimeout(function(){Y.data("fliped",true)},V.flipTime)})}}}})})(jQuery)}this.dispose=function(){clearInterval(y);clearTimeout(r);clearTimeout(o);if(!L){L=true}}})});';   // js字串，不含<script标签
      private static $uiList = '';   // 包含的组件，以','分割的字符串，比如'input,text,button'这样
      
      public static function getHeadCss()
      {
         if (!is_string(self::$cssStr))
         {
            return '';
         }
         return self::$cssStr;
      }
      
      public static function getFootJs()
      {
         if (!is_string(self::$jsStr))
         {
            return '';
         }
         return self::$jsStr;
      }
      
      // 返回数组
      public static function getCssUI()
      {
		 if ( empty(self::$uiList) ) return array();

         $arr = @explode(',', self::$uiList);
         if (!is_array($arr))
         {
            $arr = array();
         }
         return $arr;
      }
   }
