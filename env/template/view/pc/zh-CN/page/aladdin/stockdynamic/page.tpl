{%extends 'c_base.tpl'%} {%block name='data_modifier'%}{%/block%}{%block name='content'%}<!--[if IE]><script>document.createElement('canvas');</script><![endif]-->{%$tempDataColor=''%}{%if $tplData.cur['color']=='#f54545'%} {%$tempDataColor='-red'%}{%elseif $tplData.cur['color']=='#0f990f'%} {%$tempDataColor='-green'%}{%/if%}{%if $tplData.tab && !$tplData.tab[0]%}{%$tplData.tab=[$tplData.tab]%}{%/if%}{%if $tplData.tab[0].p && !$tplData.tab[0].p[0]%}{%$tplData.tab.p=[$tplData.tab.p]%}{%/if%}{%if $tplData.tab[0].cy.o && !$tplData.tab[0].cy.o[0]%}{%$tplData.tab[0].cy.o=[$tplData.tab[0].cy.o]%}{%/if%}{%if $tplData.tabs.tab && !$tplData.tabs.tab[0]%}{%$tplData.tabs.tab=[$tplData.tabs.tab]%}{%/if%}{%*
{%function name="opStockDynamicGetYMaxWidth"%}{%strip%}
{%$tempDataY=''%}
{%foreach $tplData.tab[0].cy[0].o as $item%}
    {%if !tempDataY || strlen($item) > strlen($tempDataY)%}
        {%$tempDataY = $item%}
    {%/if%}
{%/foreach%}
{%strlen($tempDataY)*5%}
{%/strip%}{%/function%}
*%}{%*y轴宽度*%}{%*
{%$tempDataYWidth=(int){%opStockDynamicGetYMaxWidth%}%}
*%}{%$tempDataType=['1'=>'开盘中', '2'=>'已收盘', '3'=>'停牌中', '4'=>'净值未公布', '5'=>'净值已公布', '6'=>'未开盘', '7'=>'休市']%}<div class="op-sotckdynamic"> <div class="op-stockdynamic-top"> <div class="op-stockdynamic-top-left"> {%if $tplData.tabs && $tplData.tabs.tab && $tplData.tabs.tab[0] && $tplData.tabs.tab[0].cur%}{%foreach $tplData.tabs.tab as $item%} {%$tempDataCur=$item.cur%} {%$tempDataTip=$item.tip%}{%$tempDataColor=''%} {%if $tempDataCur['color']=='#f54545'%} {%$tempDataColor='-red'%} {%elseif $tempDataCur['color']=='#0f990f'%} {%$tempDataColor='-green'%} {%/if%} <div class="op-stockdynamic-cur op-stockdynamic-cur-{%$item@index%}" style="{%if $tempDataCur['color']%}color:{%$tempDataCur['color']%};{%/if%}{%if !$item@first%}display:none;{%/if%}"> <span class="op-stockdynamic-cur-num c-gap-right-small">{%$tempDataCur['num']|escape%}</span>{%if $tempDataCur['status']=='up' || $tempDataCur['status']=='down'%}<i class="op-stockdynamic-cur-status-icon op-stockdynamic-cur-status{%$tempDataColor%}{%if $tempDataCur['status']=='up'%}-up{%elseif $tempDataCur['status']=='down'%}-down{%else%}{%/if%} c-gap-right-small"></i>{%/if%}{%if $tempDataCur['info']%}<span class="op-stockdynamic-cur-info">{%$tempDataCur['info']|escape%}</span>{%/if%} {%if $tempDataTip%}<span class="op-stockdynamic-cur-tip op-stockdynamic-cur-tip-{%$item@index%}">{%$tempDataTip['label']|escape%}<span class="op-stockdynamic-cur-tip-text"><span class="op-stockdynamic-cur-tip-text-inner"><i class="c-icon c-icon-triangle-up-empty"></i>{%$tempDataTip['text']%}</span></span></span>{%/if%} </div> {%/foreach%} {%else%} <div class="op-stockdynamic-cur"{%if $tplData.cur['color']%} style="color:#666;color:{%$tplData.cur['color']%}"{%/if%}> <span class="op-stockdynamic-cur-num c-gap-right-small">{%$tplData.cur['num']|escape%}</span>{%if $tplData.cur['status']=='up' || $tplData.cur['status']=='down'%}<i class="op-stockdynamic-cur-status-icon op-stockdynamic-cur-status{%$tempDataColor%}{%if $tplData.cur['status']=='up'%}-up{%elseif $tplData.cur['status']=='down'%}-down{%else%}{%/if%} c-gap-right-small"></i>{%/if%}{%if $tplData.cur['info']%}<span class="op-stockdynamic-cur-info">{%$tplData.cur['info']|escape%}</span>{%/if%} {%if $tplData.tip%}<span class="op-stockdynamic-cur-tip">{%$tplData.tip['label']|escape%}<span class="op-stockdynamic-cur-tip-text"><span class="op-stockdynamic-cur-tip-text-inner"><i class="c-icon c-icon-triangle-up-empty"></i>{%$tplData.tip['text']%}</span></span></span>{%/if%} </div> {%/if%} <div class="op-stockdynamic-update"> {%$tplData.update['text']|escape%} <span class="c-gap-left-small"> {%if $tplData.update['type']=='1'%} {%if $tplData.update['time']%} {%strip%} {%$tempDataMinutes=round((time()-$tplData.update['time'])/60)%} {%if $tempDataMinutes<60%} {%$tempDataMinutes%}分钟前更新 {%elseif $tempDataMinutes>=60%} {%$tempDataHours=floor($tempDataMinutes/60)%} {%$tempDataMM=$tempDataMinutes-($tempDataHours*60)%} {%if $tempDataHours<24%} {%$tempDataHours%}小时{%$tempDataMM%}分钟前更新 {%else%} {%$tempDataDay=floor($tempDataHours/24)%} {%$tempDataHH=$tempDataHours-($tempDataDay*24)%} {%$tempDataDay%}天{%$tempDataHH%}小时{%$tempDataMM%}分钟前更新 {%/if%} {%/if%} {%/strip%} {%/if%} {%else%} {%$tempDataType[$tplData.update['type']]%} {%/if%} </span> {%if $tplData.update['timezone']%} <span>{%$tplData.update['timezone']|escape%}</span> {%/if%} </div> </div> <div class="op-stockdynamic-top-right"> {%if $tplData.pan && !$tplData.pan[0]%}{%$tplData.pan=[$tplData.pan]%}{%/if%} <div class="op-stockdynamic-pan"> {%foreach $tplData.pan as $item%} <div>{%if $item['url']%}<a href="{%$item['url']%}" target="_blank">{%/if%}{%$item['name']|escape%}{%if $item['url']%}</a>{%/if%}：{%$item['value']|escape%}</div> {%/foreach%} </div> </div> </div> <div class="op-stockdynamic-middle c-gap-top"> <div class="op-stockdynamic-middle-left"> {%foreach $tplData.tabs.tab as $item%} <div class="op-stockdynamic-content"{%if !$item['selected']%}style="display:none;"{%/if%}> <div class="op-stockdynamic-map-x"></div> <a class="op-stockdynamic-map-a" href="{%$tplData.url%}" target="_blank"><div class="op-stockdynamic-map"> <canvas class="op-stockdynamic-map-canvas" width="358" height="106"></canvas> <canvas class="op-stockdynamic-map-canvas-mask" width="358" height="106"></canvas> <div class="op-stockdynamic-map-tip"></div> <div class="op-stockdynamic-map-tag"></div> </div></a> <div class="op-stockdynamic-map-y"></div> </div> {%/foreach%} <ul class="op-stockdynamic-tabs-nav c-gap-top{%if count($tplData.tabs.tab)==1%} op-stockdynamic-tabs-nav-one{%/if%}"> {%foreach $tplData.tabs.tab as $item%} <li class="op-stockdynamic-tab {%if $item['selected']%}op-stockdynamic-tabs-nav-selected{%/if%} OP_LOG_BTN" data-tabid="{%$item.id%}"{%if $item@index>0%} data-resourceid="{%trim($item['dayupdate'])%}"{%/if%} data-click="{fm: 'beha'}">{%$item['text']|escape%}</li> {%/foreach%} </ul> </div> <div class="op-stockdynamic-middle-right"> <ul class="op-stockdynamic-info"> {%if $tplData.info && !$tplData.info[0]%}{%$tplData.info=[$tplData.info]%}{%/if%} {%foreach $tplData.info as $item%} <li><span class="op-stockdynamic-info-name">{%$item['name']|escape%}</span><span class="op-stockdynamic-info-value"{%if $item['color']%}style="color:{%$item['color']%}"{%/if%}>{%$item['value']|escape%}</span></li> {%/foreach%} </ul> </div> </div> <div class="op-stockdynamic-bottom c-gap-top"> <div class="op-stockdynamic-bottom-left"> {%if $tplData.news && !$tplData.news[0]%}{%$tplData.news=[$tplData.news]%}{%/if%} <ul class="op-stockdynamic-news"> {%foreach $tplData.news as $item%} <li><span>{%$item['tag']|escape%}</span><span class="c-gap-left-small c-gap-right-small"><a href="{%$item['url']%}" target="_blank">{%$item['text']|limitlen:40|escape%}</a></span><span>{%$item['date']|escape%}</span></li> {%/foreach%} </ul> </div> <div class="op-stockdynamic-bottom-right"> {%if isset($tplData.more) && $tplData.more[1]%} {%if $tplData.more|count >= 2%} <ul class="op-stockdynamic-more op-stockdynamic-fr"> <li><a href="{%$tplData.more[0]['url']%}" target="_blank">{%$tplData.more[0]['text']|limitlen:8|escape%}</a></li> <li><a href="{%$tplData.more[1]['url']%}" target="_blank">{%$tplData.more[1]['text']|limitlen:8|escape%}</a></li> </ul> {%if $tplData.more|count >=4%} <ul class="op-stockdynamic-more op-stockdynamic-fr c-gap-right"> <li><a href="{%$tplData.more[2]['url']%}" target="_blank">{%$tplData.more[2]['text']|limitlen:8|escape%}</a></li> <li><a href="{%$tplData.more[3]['url']%}" target="_blank">{%$tplData.more[3]['text']|limitlen:8|escape%}</a></li> </ul> {%/if%} {%/if%} {%/if%} </div> </div></div><script >
    A.setup({
        'code': '{%$tplData.code%}',
        'tab0': {%json_encode($tplData.tab[0])%}
    });
</script>{%/block%}