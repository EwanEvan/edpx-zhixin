<?php 
  class CssJs_Util_vd_sitcom
   {
      private static $cssStr = '.vd-sitcom-icon{width:16px;height:16px;margin:2px 2px 0 0;background-repeat:no-repeat;float:left;}.vd-sitcom-new-jmore{clear:both;}.vd-sitcom-jmoreo,.vd-sitcom-jmorec{position:relative;}.vd-sitcom-jmoreo a.vd-sitcom-jmoreo-a{display:block;}.vd-sitcom-jmoreo a.vd-sitcom-jmorec-a{display:none;}.vd-sitcom-jmorec a.vd-sitcom-jmoreo-a{display:none;}.vd-sitcom-jmorec a.vd-sitcom-jmorec-a{display:block;}.vd-sitcom-jmoreo .c-icon,.vd-sitcom-jmorec .c-icon{_vertical-align:middle;}.vd-sitcom-jmoreo a,.vd-sitcom-jmorec a{cursor:pointer;color:#00c;text-decoration:underline;}.vd-sitcom-pagebar{border-bottom:1px solid #eee;color:#666;padding:5px 0 10px 0;}.vd-sitcom-pagebar div{cursor:pointer;zoom:1;display:inline-block;width:16.6%;color:#0000ce;float:left;}.vd-sitcom-pagebar a{text-decoration:underline;}.vd-sitcom-pagebar .vd-sitcom-pageon a{cursor:default;color:#000;text-decoration:none;}.vd-sitcom-content{position:relative;height:1%;}.vd-sitcom-loading{position:absolute;left:0;top:0;height:77px;width:100%;background:#fff;z-index:1;text-align:center;display:none;}.vd-sitcom-loading-icon{width:30px;height:30px;display:inline-block;background:url(http://www.baidu.com/aladdin/img/videoidea/loading_L.gif) no-repeat;}.vd-sitcom-new-ulbox li{position:relative;}.vd-sitcom-new-ulbox li i{position:absolute;overflow:hidden;display:none;}.vd-sitcom-new-ulbox li div{display:none;}.vd-sitcom-new-ulbox li.vd-sitcom-new i{*zoom:1;display:block;right:-10px;top:-3px;}.vd-sitcom-finish,.vd-sitcom-update{padding:0 1px;text-align:center;color:#fff;font-size:.92em;background:#2b99ff;}.vd-sitcom-first{width:100%;text-overflow:ellipsis;overflow:hidden;white-space:nowrap;color:#333;}.vd-sitcom-split{color:#d8d8d8;}.vd-sitcom-summary{padding-left:3em;text-indent:-3em;}';  // css字串，不含<style>和</style>标签
      private static $jsStr  = 'A.merge("vd_sitcom",function(){A.setup(function(){var _this=this;var initIndex=0;var ajaxFinished=false;if(_this.data.aldjson){var vd_sitcom_new_dataArr=eval("("+_this.data.aldjson+")");var sites=vd_sitcom_new_dataArr.sites;var videoId=vd_sitcom_new_dataArr.id;var finish=parseInt(vd_sitcom_new_dataArr.finish);var innerli="";var conbox="";var isSel="";var isShow="";for(var i=0;i<sites.length&&i<4;i++){if(i==0){isSel="c-tabs-nav-selected";isShow="block"}else{if(i==1){innerli+=\'<li class="c-tabs-nav-sep" style="visibility:hidden;"></li>\'}else{innerli+=\'<li class="c-tabs-nav-sep"></li>\'}isSel="";isShow="none"}innerli+=\'<li class="c-tabs-li \'+isSel+\' OP_LOG_BTN"><b class="vd-sitcom-icon" style="background-image:url(\'+sites[i].site_logo+\')"></b>\'+sites[i].site_name+"</li>";conbox+=\'<div style="display:\'+isShow+\'" class="vd-sitcom-box vd-sitcom-box\'+(i+1)+\'"><div class="c-clearfix c-gap-bottom-small vd-sitcom-new-ulbox c-numberset"></div></div>\'}conbox+=\'<table class="vd-sitcom-loading" cellspacing="0" cellpadding="0"><tr><td><div class="vd-sitcom-loading-icon"></div></td></tr></table>\';_this.find(".c-tabs-nav").html(innerli);if(sites.length>1){_this.find(".c-tabs-nav").removeClass("c-tabs-nav-one")}_this.find(".vd-sitcom-content").html(conbox);if(finish){_this.find(".vd-sitcom-sum").html("共"+vd_sitcom_new_dataArr.max_episode+"集")}else{_this.find(".vd-sitcom-cur").html(vd_sitcom_new_dataArr.cur_episodes+"集/共"+vd_sitcom_new_dataArr.max_episode+"集")}}else{var sites=_this.data.sites;var videoId=_this.data.videoResourceId;var finish=_this.data.finish}var lessSize=_this.data.lessSize;var pageSize=_this.data.pageSize;var boxes=_this.find(".vd-sitcom-box");var loading=_this.find(".vd-sitcom-loading")[0];var $tabs=_this.find(".c-tabs-li");var $contents=_this.find(".vd-sitcom-box");var episode=sites[initIndex].episode;var $curTab=$tabs.eq(initIndex);var $curContent=$contents.eq(initIndex);var $loading=$(loading);bindTabEvent();showLoading();asyncGetData(initIndex);function bindTabEvent(){$tabs.click(function(){var $tab=$(this);var index=$tab.index(".c-tabs-li");var $content=$contents.eq(index);if($tab.get(0)!==$curTab.get(0)){showLess();$curTab.toggleClass("c-tabs-nav-selected");$curTab.prev(".c-tabs-nav-sep").css("visibility","visible");$curTab.next(".c-tabs-nav-sep").css("visibility","visible");$tab.toggleClass("c-tabs-nav-selected");$tab.prev(".c-tabs-nav-sep").css("visibility","hidden");$tab.next(".c-tabs-nav-sep").css("visibility","hidden");$content.show();$curContent.hide()}$curTab=$tab;$curContent=$content;if(index>0&&!$curContent.data("loaded")){showLoading();asyncGetData(index)}})}function showLoading(){$curContent.css({height:"77px"});$loading.show()}function hideLoading(){$curContent.css("height","");$loading.hide()}function asyncGetData(index){var url="http://v.baidu.com/htvplaysingles/?id=";$.ajax({url:url+videoId+"&site="+sites[index]["site_url"],dataType:"jsonp",success:function(data){if(ajaxFinished){return}initContent(prepareData(data.videos,finish),index);hideLoading()}})}function prepareData(episode,finish){return finish?episode:episode.reverse()}function initContent(episode,index){var $content=$contents.eq(index);var $ulbox=$content.find(".vd-sitcom-new-ulbox:first");var contentArray=buildContent(episode,index);if(!$ulbox.find("ul.vd-sitcom-new-ulbox_ul_less").length){$ulbox.append(contentArray[0])}$ulbox.append(contentArray[1]);var $pager=$(buildPager(episode,index));$ulbox.after($pager);bindPagerEvent($pager);var $more=$content.find(".vd-sitcom-new-jmore");if(!$more.length&&episode.length>lessSize){$more=$(buildMore(episode));$content.append($more)}bindMoreEvent($more);$content.data("loaded",true)}function buildContent(episode,index){var counter=0,less="",more="";less+=\'<ul class="vd-sitcom-new-ulbox_ul_less">\';$.each(episode,function(k,ee){if(k==lessSize){return false}liHtmlClass="";var liatype="";if(k==0&&!finish){liHtmlClass+="vd-sitcom-new"}if((k+1)%8==0){liHtmlClass+=" c-numberset-last"}if(parseInt(ee.is_play)==1){var linkurl=ee.url;liatype=\'target="_blank"\'}else{var linkurl="javascript:;";liatype=\'class="c-gray"\'}less+=\'<li class="c-gap-top \'+liHtmlClass+\'"><a href="\'+linkurl+\'" \'+liatype+">"+ee.episode+\'集</a><div></div><i class="c-text c-text-danger">新</i></li>\'});less+="</ul>";if(episode.length>lessSize){more=\'<ul class="vd-sitcom-new-ulbox_ul_more vd-sitcom-new-ulbox_ul_more_1" style="display:none;">\';$.each(episode,function(j,ee){counter=j+1;liHtmlClass="";var liatype="";if(j==0&&!finish){liHtmlClass+="vd-sitcom-new"}if((j+1)%8==0){liHtmlClass+=" c-numberset-last"}if(parseInt(ee.is_play)==1){var linkurl=ee.url;liatype=\'target="_blank"\'}else{var linkurl="javascript:;";liatype=\'class="c-gray"\'}more+=\'<li class="c-gap-top \'+liHtmlClass+\'"><a href="\'+linkurl+\'" \'+liatype+">"+ee.episode+\'集</a><div></div><i class="c-text c-text-danger">新</i></li>\';if(counter&&counter%pageSize==0&&counter!=episode.length){more+=\'</ul><ul class="vd-sitcom-new-ulbox_ul_more vd-sitcom-new-ulbox_ul_more_\'+(counter/pageSize+1)+\'" style="display:none;">\'}});more+="</ul>"}return[less,more]}function buildPager(episode,index){var html="";var pageNum=Math.floor(episode.length/pageSize);if(episode.length%pageSize>0){pageNum++}if(pageNum>1){html=\'<div class="c-gap-top c-gap-bottom vd-sitcom-pagebar" style="display:none;overflow:hidden;zoom:1">\';for(var n=0;n<pageNum;n++){var eon=(n==0)?"vd-sitcom-pageon":"";var startNum,endNum;if(finish){startNum=pageSize*n+1;endNum=((startNum+pageSize-1)>episode.length)?episode.length:startNum+pageSize-1;html+=\'<div class="\'+eon+\' OP_LOG_BTN"><a>\'+startNum+"~"+endNum+"集</a></div>"}else{startNum=episode.length-pageSize*n;endNum=((startNum-pageSize+1)<=0)?1:startNum-pageSize+1;html+=\'<div class="\'+eon+\' OP_LOG_BTN"><a>\'+endNum+"~"+startNum+"集</a></div>"}}html+="</div>"}return html}function bindPagerEvent($pager){var $episodes=$pager.parent().find("ul.vd-sitcom-new-ulbox_ul_more");var $pagers=$pager.find("div");$pagers.click(function(){var $p=$(this);if(!$p.is(".vd-sitcom-pageon")){$pagers.filter(".vd-sitcom-pageon").removeClass("vd-sitcom-pageon");$p.addClass("vd-sitcom-pageon");$episodes.filter(":visible").hide();$episodes.eq($p.index()).show()}})}function buildMore(episode){var html=\'<div class="vd-sitcom-new-jmore vd-sitcom-jmoreo OP_LOG_BTN" style="display:block"><a class="vd-sitcom-jmoreo-a"><i class="c-icon c-icon-unfold c-gap-icon-right-small"></i>显示全部《<em>\'+_this.data.title+\'</em>》视频</a><a class="vd-sitcom-jmorec-a"><i class="c-icon c-icon-fold c-gap-icon-right-small"></i>收起</a></div>\';return html}function bindMoreEvent($more){$more.click(function(){$more.is(".vd-sitcom-jmoreo")?showMore():showLess()})}function showMore(){$curContent.find(".vd-sitcom-new-ulbox_ul_less").hide();$curContent.find(".vd-sitcom-new-ulbox_ul_more_1").show();$curContent.find(".vd-sitcom-pagebar").show();$curContent.find(".vd-sitcom-new-jmore").removeClass("vd-sitcom-jmoreo").addClass("vd-sitcom-jmorec")}function showLess(){$curContent.find(".vd-sitcom-new-ulbox_ul_less").show();$curContent.find(".vd-sitcom-pagebar>div:first").click();$curContent.find(".vd-sitcom-new-ulbox_ul_more").hide();$curContent.find(".vd-sitcom-pagebar").hide();$curContent.find(".vd-sitcom-new-jmore").removeClass("vd-sitcom-jmorec").addClass("vd-sitcom-jmoreo")}this.dispose=function(){if(!ajaxFinished){ajaxFinished=true}}})});';   // js字串，不含<script标签
      private static $uiList = 'img,tabs,numberset';   // 包含的组件，以','分割的字符串，比如'input,text,button'这样
      
      public static function getHeadCss()
      {
         if (!is_string(self::$cssStr))
         {
            return '';
         }
         return self::$cssStr;
      }
      
      public static function getFootJs()
      {
         if (!is_string(self::$jsStr))
         {
            return '';
         }
         return self::$jsStr;
      }
      
      // 返回数组
      public static function getCssUI()
      {
		 if ( empty(self::$uiList) ) return array();

         $arr = @explode(',', self::$uiList);
         if (!is_array($arr))
         {
            $arr = array();
         }
         return $arr;
      }
   }
