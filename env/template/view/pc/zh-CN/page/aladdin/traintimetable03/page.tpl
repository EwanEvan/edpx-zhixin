{%extends 'c_base.tpl'%} {%block name="data_modifier"%}{%$extData.feData.hasBorder = true%}{%/block%}{%block name='content'%} <div class="op_traintable03_act_station"> <form id="op_traintable03_tr_q_01_form" action="{%$tplData.posturl|escape:'html'%}" target="_blank" style="position:static;" accept-charset="gb2312"> <table cellpadding="0" cellspacing="0"> <tr> <td><span class="c-gap-right">站站查询</span></td> <td> <span class="c-input c-input-small c-gap-right-small op_traintable03_station_start_field"> <i class="c-icon c-icon-map"></i> <input id="op_traintable03_s1" name="s1" type="text" value="{%if $tplData.departure%}{%$tplData.departure|escape:'html'%}{%else%}{%if $extData.AutoExtendedLocation%}{%$extData.AutoExtendedLocation|escape:'html'%}{%/if%}{%/if%}" maxlength="100" tip="" class="op_traintable03_ipt_input1"> </span> </td> <td><a class="c-btn c-gap-right-small op_traintable03_swap OP_LOG_BTN" id="op_traintable03_swap" title="起止城市互换" href="javascript:;"><i class="c-icon c-icon-exchange"></i></a></td> <td> <span class="c-input c-input-small c-gap-right op_traintable03_station_end_field"> <i class="c-icon c-icon-map"></i> <input id="op_traintable03_s2" name="s2" type="text" value="" maxlength="100" class="op_traintable03_ipt_default" tip="城市名"{%*i*%}> </span> </td> <td> <a id="op_traintable03_tr_q_01" class="c-btn c-btn-primary op_traintable03_q_btn OP_LOG_BTN" href="#" onclick="return false;">查询</a> <input type="submit" style="overflow:hidden;width:0;height:0;position:absolute;left:-10000px;"> </td> </tr> </table> <input type="hidden" name="wd" value="{%if $extData.OriginQuery%}{%$extData.OriginQuery|escape:'html'%}{%/if%}"> <input type="hidden" name="act" value="station"> <input type="hidden" name="tempid" value="3"> {%if $tplData.gaotie%} <input type="hidden" name="s5" value="g"> {%/if%} </form> </div> {%if $tplData.doubleMode%} <div class="c-gap-top op_traintable03_act_train""> <form id="op_traintable03_tr_q_02_form" action="{%$tplData.posturl|escape:'html'%}" target="_blank" accept-charset="gb2312"> <table cellpadding="0" cellspacing="0"> <tr> <td><span class="c-gap-right">车次查询</span></td> <td> <span class="c-input c-input-small c-gap-right op_traintable03_train_field"> <i class="c-icon c-icon-bus"></i> <input id="op_traintable03_s3" name="s3" type="text" value="" maxlength="100" class="op_traintable03_ipt_default" tip="车次"> </span> </td> <td><a id="op_traintable03_tr_q_02" class="c-btn c-btn-primary op_traintable03_q_btn OP_LOG_BTN" href="#" oncli{%*i*%}ck="return false;">查询</a></td> </tr> </table> <input type="hidden" name="wd" value="{%if $extData.OriginQuery%}{%$extData.OriginQuery|escape:'html'%}{%/if%}"> <input type="hidden" name="act" value="train"> <input type="hidden" name="tempid" value="3"> {%if $tplData.gaotie%} <input type="hidden" name="s5" value="g"> {%/if%} </form> </div> <div class="c-gap-top op_traintable03_act_trainstation"> <form id="op_traintable03_tr_q_03_form" action="{%$tplData.posturl|escape:'html'%}" target="_blank" accept-charset="gb2312"> <table cellpadding="0" cellspacing="0"  class="op_traintable03_table"> <tr> <td><span class="c-gap-right">车站查询</span></td> <td> <span class="c-input c-input-small c-gap-right op_traintable03_trainstation_field"> <i class="c-icon c-icon-flag"></i> <input id="op_traintable03_s4" name="s4" type="text" value="" maxlength="100" class="op_traintable03_ipt_default" tip="车站"> </span> </td> <td><a id="op_traintable03_tr_q_03" class="c-btn c-btn-primary op_traint{%*i*%}able03_q_btn OP_LOG_BTN" href="#" onclick="return false;">查询</a></td> </tr> </table> <input type="hidden" name="act" value="trainstation"> <input type="hidden" name="wd" value="{%if $extData.OriginQuery%}{%$extData.OriginQuery|escape:'html'%}{%/if%}"> <input type="hidden" name="tempid" value="3"> {%if $tplData.gaotie%} <input type="hidden" name="s5" value="g"> {%/if%} </form> </div> {%/if%} <div class="c-gap-top" style="color:#666;">{%$tplData.description|escape:'html'%}</div> {%if $tplData.morelink1[0]['txt'] || $tplData.morelink2[0]['txt'] || $tplData.morelink3[0]['txt'] || $tplData.morelink4[0]['txt']%} {%$morelinks=[$tplData.morelink1[0],$tplData.morelink2[0],$tplData.morelink3[0],$tplData.morelink4[0]]%} <div class="c-gap-top-small op-traintable03_c666"> {%foreach $morelinks as $item%} {%if $item%}<a href="{%$item['url']|escape:'html'%}" target="_blank">{%$item['txt']|escape:'html'%}</a>{%if !$item@last%}<span>&nbsp;-</span>{%/if%}{%/if%} {%/foreach%} {%/if%} </div>{%if $extData.AutoExtendedLocation%} <script >var op_traintable03_currentLocation = '{%$extData.AutoExtendedLocation|escape:'html'%}';var citylist = {baseurl: 'http://j.map.baidu.com/',links: {'北京': 'fHZm','上海': 'mUs0','上饶': 'XVs0','东莞': '4Ws0','东营': 'cXs0','中山': 'wXs0','临汾': 'dEs0','佛山': '0ab0','佳木斯': 'Qab0','保定': 'hJb0','兰州': 'ncb0','包头': 'tdb0','北海': '8gb0','南京': 'ehb0','南充': 'uKb0','南宁': '3Kb0','南昌': 'aib0','南通': 'yib0','厦门': '_ib0','台州': '3kb0','合肥': 'fMb0','吉林': 'BMb0','呼伦贝尔': 'Qlb0','呼和浩特': 'inb0','哈尔滨': '_nb0','唐山': 'zob0','大庆': 'Xbb0','大连': 'stb0','天津': 'Utb0','太原': 'Xvb0','威海': 'oxb0','宁德': '2xb0','宁波': 'Exb0','安康'{%*i*%}: '7yb0','宜宾': 'xzb0','宜昌': '00b0','宝鸡': 'U0b0','常州': 'W3b0','广安': 'DDb0','广州': 'YDb0','延边': 'f8b0','开封': '38b0','德州': 'I9b0','惠州': '_Bb0','成都': 'mCb0','抚州': 'xFb0','攀枝花': '0Hb0','新乡': 'YHb0','新余': 'sjb0','无锡': 'ejb0','昆明': 'Meb0','景德镇': 'rNb0','杭州': 'pOb0','松原': 'eOb0','柳州': '6Pb0','株洲': '7Pb0','桂林': 'kZb0','梧州': 'GZb0','武汉': 'C2b0','江门': 'B-b0','沈阳': 'dQb0','泉州': 'VQb0','泰州': 'KSb0','泸州': '4Sb0','洛阳': 'YSb0','济南': 'vUb0','济宁': '8Ub0','海口': 'lVb0','海西': 'qWb0','淄博': '9Wb0','深圳': 'oXb0','温州': '7{%*i*%}Xb0','湖州': 'cEb0','湛江': 'eEb0','潍坊': 'KYb0','潮州': 'GYb0','濮阳': 'oat0','烟台': 'jat0','牡丹江': 'Gct0','玉林': 'vdt0','珠海': 'nft0','白城': 'put0','白山': 'kgt0','益阳': 'sht0','盘锦': 'uKt0','眉山': 'Bit0','石家庄': 'rkt0','福州': 'lMt0','秦皇岛': 'mMt0','绵阳': 'Lvt0','聊城': 'rwt0','自贡': '9xt0','苏州': 'vyt0','荆门': 'pzt0','莆田': 'Lzt0','萍乡': 'jmt0','葫芦岛': 'V0t0','蚌埠': 'y1t0','衡水': 'a3t0','衡阳': 'G3t0','衢州': 'E5t0','襄樊': '1Dt0','西安': '27t0','贵阳': 'iFt0','贺州': 'UFt0','赣州': 'eHt0','辽阳': 'Hjt0','达州': 'iet0','运城': 'AIt0','连云港': 'MN{%*i*%}t0','通化': 'iOt0','通辽': '2Ot0','遂宁': 'qPt0','遵义': 'iZt0','邢台': 'e2t0','邯郸': 'hGt0','郑州': '7Gt0','郴州': 'EGt0','酒泉': '5-t0','重庆': 'E-t0','金华': 'sQt0','钦州': 'wRt0','铁岭': 'JSt0','铜川': '5St0','银川': 'lUt0','锦州': '8Ut0','镇江': 'ZUt0','长春': 'rVt0','长沙': '_Vt0','长治': '5Wt0','阜阳': '3Xt0','防城港': 'pEt0','阳江': '9Et0','阳泉': 'f_t0','随州': 'R_t0','青岛': 'DYt0','韶关': 'nav0','鹤壁': 'Wav0','鹰潭': 'pJv0','黄冈': '-Jv0','黔东南': '6dv0','齐齐哈尔': 'Gdv0','龙岩': '7fv0'}};</script> {%/if%}<script>A.setup(function() {var _this = this;var ajaxFinished = false;var traintimer;var s1 = _this.find('.op_traintable03_ipt_input1')[0],s2 = _this.find('.op_traintable03_ipt_default')[0],s3 = _this.find('.op_traintable03_ipt_default')[1],s4 = _this.find('.op_traintable03_ipt_default')[2],op_traintable03_sug_citys = [],nums = [];{%if $extData.AutoExtendedLocation%};var domnode = _this.find('.op_traintable03_ticketagent')[0];if (op_traintable03_currentLocation === '') return;else{var url = citylist.links[op_traintable03_currentLocation] || '';if (url !== '' && domnode) {domnode.href = citylist.baseurl + url;}}{%/if%};var sugUrl1 = 'http://opendata.baidu.com/ala_sug/ala_s.php?query=#{0}&ie=utf-8&sug_type=station&t=#{1}';var sugUrl3 = 'http://opendata.baidu.com/ala_sug/ala_s.php?query=#{0}&ie=utf-8&sug_type=checi&t=#{1}';function fnSuccess(FD,sd,word) {op_traintable03_sug_citys = [];if (sd[0] == 'dataerror') {FD.push('<div class="op_traintable03_sug_error_info">您输入的城市无车站</div>');op_traintable03_sug_citys.push('');}else {$.each(sd, function(i,o) {var da = o.split('|');op_traintable03_sug_citys.push(da[0] + '|'{%*i*%} + da[2]);w = word.toLowerCase();w1 = word.toUpperCase();var str = da[0] + '(' + da[1].toLowerCase() + ')',str2 = da[0] + '(' + da[2].toUpperCase() + ')';if (w && str.indexOf(w) != -1) {FD.push(str.replace(w, "<span class='op_traintable03_sug_key'>" + w + '</span>'));}else if (w1 && str2.indexOf(w1) != -1) {FD.push(str2.replace(w1, "<span class='op_traintable03_sug_key'>" + w1 + '</span>'));}});}return (word, FD);}var sug1 = {view:function(){var s=_this.find('.op_traintable03_station_start_field{%*i*%}')[0],p=$(s).position();return {top:p.top+26,left:p.left,width:s.offsetWidth};},getData: function(word) {var _this = this;var fn = function(data) {if(ajaxFinished) return;var SD = [];if (data.status == 0) {var datas = data.data;var len = datas.length;if (len > 0) {$.each(datas, function(i,o) {SD.push(o.s);});}else {SD.push('dataerror');}if (s1.value == '城市名')return;var FD = [];fnSuccess(FD, SD, word);_this.show(word, FD);_this.highLight(0);}};if (swapflag1) {$.ajax({url:$.format(sugUrl1, encodeU{%*i*%}RIComponent(word), new Date().getTime())+'&cb=traintb03',dataType:'jsonp',success:fn,jsonpCallback:'traintb03'});}else {swapflag1 = true;}},onpick: function(ev) {if (!isNaN(ev.data.index)) {var cs = op_traintable03_sug_citys[ev.data.index].split('|');ev.data.item.value = cs[0];}}};var sug2 = {view:function(){var e=_this.find('.op_traintable03_station_end_field')[0],p=$(e).position();return {top:p.top+26,left:p.left,width:e.offsetWidth};},getData: function(word) {var _this = this;var fn = functio{%*i*%}n(data) { if(ajaxFinished) return;var SD = [];if (data.status == 0) {var datas = data.data;var len = datas.length;if (len > 0) {$.each(datas, function(i,o) {SD.push(o.s);});}else {SD.push('dataerror');}if (s2.value == '城市名')return;var FD = [];fnSuccess(FD, SD, word);_this.show(word, FD);_this.highLight(0);}};if (swapflag2) {$.ajax({url:$.format(sugUrl1, encodeURIComponent(word), new Date().getTime())+'&cb=traintb03',dataType:'jsonp',success:fn,jsonpCallback:'traintb03'});}else {swapflag2 = true;{%*i*%}return;}},onpick: function(ev) {if (!isNaN(ev.data.index)) {var cs = op_traintable03_sug_citys[ev.data.index].split('|');ev.data.item.value = cs[0];}} };var sug4 = {view:function(){var e=_this.find('.op_traintable03_trainstation_field')[0],p=$(e).position();return {top:p.top+26,left:p.left,width:e.offsetWidth};},getData: function(word) {var _this = this;var fn = function(data) {if(ajaxFinished) return;var SD = [];if (data.status == 0) {var datas = data.data;var len = datas.length;if (len > 0) {${%*i*%}.each(datas, function(i,o) {SD.push(o.s);});}else {SD.push('dataerror');}if (s4.value == '车站')return;var FD = [];fnSuccess(FD, SD, word);_this.show(word, FD);_this.highLight(0);}};$.ajax({url:$.format(sugUrl1, encodeURIComponent(word), new Date().getTime())+'&cb=traintb03',dataType:'jsonp',success:fn,jsonpCallback:'traintb03'});},onpick: function(ev) {if (!isNaN(ev.data.index)) {var cs = op_traintable03_sug_citys[ev.data.index].split('|');ev.data.item.value = cs[0];}} };var sug3 = {view:function{%*i*%}(){var e=_this.find('.op_traintable03_train_field')[0],p=$(e).position();return {top:p.top+26,left:p.left,width:e.offsetWidth};},getData: function(word) {var _this = this;var fn = function(data) {if(ajaxFinished) return;var SD = [];if (data.status == 0 && data.length != 0) {var datas = data.data;var len = datas.length;if (len > 0) {$.each(datas, function(i,o) {SD.push(o.s);});}else {if (s3.value == '车次')return;SD.push('dataerror');}fnSuccess(SD);}};$.ajax({url:$.format(sugUrl3, encodeURIComponen{%*i*%}t(word), new Date().getTime())+'&cb=traintb03',dataType:'jsonp',success:fn,jsonpCallback:'traintb03'});function fnSuccess(sd) {var FD = [];nums = [];if (sd[0] == 'dataerror') {FD.push('<div class="op_traintable03_sug_error_info">您输入的车次有误</div>');nums.push('');}else {$.each(sd, function(i,o) {var da = o.split('|'),w = word.toLowerCase(),w1 = word.toUpperCase();nums.push(da[0]);var str = da[0] + '  (' + da[1] + ' - ' + da[2] + ')',str2 = da[0] + '  (' + da[1] + ' - ' + da[2] + ')';if (w && str.ind{%*i*%}exOf(w) != -1) {FD.push(str.replace(w, "<span class='op_traintable03_sug_key'>" + w + '</span>') + "<span class='op_traintable03_sug_en'></span>");}else if (w1 && str2.indexOf(w1) != -1) {FD.push(str2.replace(w1, "<span class='op_traintable03_sug_key'>" + w1 + '</span>') + "<span class='op_traintable03_sug_en'></span>");}});}_this.show(word, FD);_this.highLight(0);}},onpick: function(ev) {if (!isNaN(ev.data.index)) {ev.data.item.value = nums[ev.data.index];}}};var op_traintable03_sg_s1,op_traint{%*i*%}able03_sg_s2,op_traintable03_sg_s3,op_traintable03_sg_s4;$(function(){A.use('suggestion',function(){op_traintable03_sg_s1 = A.ui.suggestion(sug1);op_traintable03_sg_s2 = A.ui.suggestion(sug2);op_traintable03_sg_s3 = A.ui.suggestion(sug3);op_traintable03_sg_s4 = A.ui.suggestion(sug4);traintimer = setTimeout(function() {op_traintable03_sg_s1.render(s1);op_traintable03_sg_s2.render(s2);op_traintable03_sg_s3.render(s3);op_traintable03_sg_s4.render(s4);},100);});});_this.find("#op_traintable03_s1")[0{%*i*%}].style.color="black";{%if $tplData.departure%};var itrain = 1;s1.value = '{%$tplData.departure|escape:'html'%}';s1.onclick = function() {if (itrain == 1) {itrain = 0;s1.select();}};{%else%};{%if $extData.AutoExtendedLocation%};var itrain = 1;s1.value = '{%$extData.AutoExtendedLocation|escape:'html'%}';s1.onclick = function() {if (itrain == 1) {itrain = 0;s1.select();}};{%/if%};{%/if%};var swap = _this.find('.op_traintable03_swap').eq(0);var swapflag1 = true;var swapflag2 = true;swap.on( 'click', function() {swapflag1 = false;swapflag2 = false;var t = s1.value;s1.value = s2.value;s2.value = t;});var trainJS = (function(){function g_almid(){return "train3";}var init_pos = 0;var initValues = ["","",""];var isIE = navigator.userAgent.indexOf('MSIE') != -1 && !window.opera;function G(id){return document.getElementById(id);}function addEvent(elem, type, handler){if(isIE){elem.atta{%*i*%}chEvent('on' + type, (function(elm){return function() {handler.call(elm);}})(elem));}else{elem.addEventListener(type, handler, true);}}function setInputDefault(obj){if (obj){obj.className = "op_traintable03_ipt_default";if(obj.id!='op_traintable03_s1')obj.value = obj.getAttribute("tip");}}function setInputNormal(obj){if (obj && obj.value != obj.getAttribute("tip")){obj.className = "op_traintable03_ipt_normal";}else {setInputDefault(obj);}}function submitForm(formId){var fm = G(formId);fm.method {%*i*%}= "GET";fm.submit(); }var radioArray = [];var formArray = [_this.find(".op_traintable03_act_station")[0],_this.find(".op_traintable03_act_train")[0],_this.find(".op_traintable03_act_trainstation")[0]];var inputArray = [G("op_traintable03_s1"),G("op_traintable03_s2"),G("op_traintable03_s3"),G("op_traintable03_s4")];var submitArray = [G("op_traintable03_tr_q_01"),G("op_traintable03_tr_q_02"),G("op_traintable03_tr_q_03")];formArray[init_pos].style.display = "block";for (var index = 0, len = submitA{%*i*%}rray.length; index < len; index++) {var aLink = submitArray[index];addEvent(aLink,"click",(function(link) {return function() {submitForm(link.id+"_form");}})(aLink));}for (var index = 0,len = radioArray.length;index < len ;index ++){var radioObj = radioArray[index]; addEvent(radioObj,"click",(function(pos) {return function() {for (var i = 0,len2 = formArray.length;i < len2 ;i ++) formArray[i].style.display = "none";formArray[pos].style.display = "block";}})(index));}for (var index = 0, len = inp{%*i*%}utArray.length; index < len; index++) {var inputObj = inputArray[index];inputObj.autocomplete="off";inputObj.maxlength="off";if (initValues[index] && initValues[index] != ""){inputObj.value = initValues[index];setInputNormal(inputObj);}else {setInputDefault(inputObj);}addEvent(inputObj,"focus",(function(obj) {return function() {if(obj.id!="op_traintable03_s1"){if (obj.className == "op_traintable03_ipt_default"){obj.value = "";setInputNormal(obj);} else {obj.select();obj.oldValue = obj.value;}}}}{%*i*%})(inputObj));addEvent(inputObj,"blur",(function(obj) {return function() {if (obj.value == ""){setInputDefault(obj);}else {if (obj.value!=obj.oldValue) {switch(obj.id){case 'op_traintable03_s1':if (obj.value == op_traintable03_sg_s1.getTargetValue())c({'almid':g_almid(),'stl':'input','tp':9,'p1':2,'p2':1,'p3':1,'q1':obj.value});else c({'almid':g_almid(),'stl':'input','tp':8,'p1':2,'p2':1,'p3':1,'q1':obj.value});break;case 'op_traintable03_s2':if (obj.value == op_traintable03_sg_s2.getTargetValue({%*i*%}))c({'almid':g_almid(),'stl':'input','tp':9,'p1':2,'p2':1,'p3':2,'q1':obj.value});else c({'almid':g_almid(),'stl':'input','tp':8,'p1':2,'p2':1,'p3':2,'q1':obj.value});break;case 'op_traintable03_s3':if (obj.value == op_traintable03_sg_s3.getTargetValue()){c({'almid':g_almid(),'stl':'input','tp':9,'p1':2,'p2':2,'p3':1,'q1':obj.value});}else{c({'almid':g_almid(),'stl':'input','tp':8,'p1':2,'p2':2,'p3':1,'q1':obj.value});}break;default:break; }}}}})(inputObj));}function legalInput(obj){if ( obj.val{%*i*%}ue=="" || obj.value == obj.getAttribute("tip")){obj.focus();return false;}else {return true;}}function preventEvt(e){if ( e && e.preventDefault ){e.preventDefault();}else{window.event.returnValue = false;}}addEvent(G("op_traintable03_tr_q_01_form"),"submit",(function(){return function(e){if (legalInput(G("op_traintable03_s1"))&&legalInput(G("op_traintable03_s2"))){return true;}else{preventEvt(e);return false;}}; })());addEvent(G("op_traintable03_tr_q_02_form"),"submit",(function(){return functio{%*i*%}n(e){if (legalInput(G("op_traintable03_s3"))){return true;}else{preventEvt(e);return false;}}; })());addEvent(G("op_traintable03_tr_q_03_form"),"submit",(function(){return function(e){if (legalInput(G("op_traintable03_s4"))){return true;}else{preventEvt(e);return false;}}; })());return {"G":G,"submitForm":submitForm};})();this.dispose = function(){clearTimeout(traintimer);if(!ajaxFinished){ajaxFinished = true;}op_traintable03_sg_s1&&op_traintable03_sg_s1.dispose&&op_traintable03_sg_s1.dispose();{%*i*%}op_traintable03_sg_s2&&op_traintable03_sg_s2.dispose&&op_traintable03_sg_s2.dispose();op_traintable03_sg_s3&&op_traintable03_sg_s3.dispose&&op_traintable03_sg_s3.dispose();op_traintable03_sg_s4&&op_traintable03_sg_s4.dispose&&op_traintable03_sg_s4.dispose();};});</script>{%/block%}