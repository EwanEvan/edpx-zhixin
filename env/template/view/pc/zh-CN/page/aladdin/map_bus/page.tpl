{%extends 'c_base.tpl'%} {%block name="data_modifier"%} {%$extData.feData.hasShowURLGap = true%} {%$tplData.title=$tplData.titleDesc%} {%$tplData.url=$tplData.titleUrl%} {%function fe_fn_bus_tag_map tag=''%}{%$colors=['yellow', 'blue']%}{%$tempDataColor=$colors[0]%}{%if $tag=='路'%}{%$tempDataColor=$colors[1]%}{%/if%}{%$tempDataColor%}{%/function%} {%function fe_fn_bus_font_size_zoom str='' zoomMap=''%}{%$tempDataSize=13%}{%$strLength=preg_match_all("/./us", $str, $match)%}{%foreach $zoomMap as $item%}{%if $strLength<=$item@key%}{%$tempDataSize=$item%}{%break%}{%/if%}{%/foreach%}{%$tempDataSize%}{%/function%} {%$tempDataNumFontSizeZoomMap=['2'=> '60', '3'=> '46', '4'=> '36', '5'=> '30']%} {%$tempDataStartEndFontSizeZoomMap=['11'=> '24', '12'=> '22', '13'=> '20', '14'=> '18', '15'=> '17', '16'=> '16', '17'=> '15', '18'=> '14', '19'=> '13', '20'=> '13']%}{%/block%}{%block name='content'%}{%$multiLine=$tplData.lines|count>1%}<div class="op-map-bus-tabs{%if $multiLine%} c-tabs{%/if%}"> {%if $multiLine%} <ul class="c-tabs-nav" data-click="{fm:'beha'}"> {%foreach $tplData.lines as $tab%} <li class="c-tabs-nav-li{%if $tab@index==0%} c-tabs-nav-selected{%/if%} op-map-bus-tabs-nav-li">{%$tab.lineName|escape%}</li> {%if !$tab@last%}<li class="c-tabs-nav-sep"></li>{%/if%} {%/foreach%} </ul> {%/if%} {%foreach $tplData.lines as $tab%} <div class="{%if $multiLine%}c-tabs c-tabs-content {%/if%}op-map-bus-tabs-content" style="height:282px;*height:auto;{%if $tab@index>0%}display:none;{%/if%}"> <div class="op-map-bus-tabs-content-inner"> {%foreach $tab.detail as $item%} <div class="op-map-bus-content{%if $item@index==1%} op-map-bus-content-back{%/if%}" style="z-index:{%10-$item@index%};{%if $item@index>0%}*display:none;{%/if%}"> <table class="op-map-bus-info"> <tr> {%if $item.busName1||$item.busName2%} <td class="op-map-bus-info-left"> <div class="op-map-bus-info-num" style="font-size:{%fe_fn_bus_font_size_zoom str=$item.busName1 zoomMap=$tempDataNumFontSizeZoomMap%}px;">{%$item.busName1|escape%}</div> <div class="op-map-bus-info-tag op-map-bus-info-tag-{%fe_fn_bus_tag_map tag=$item.busName2%}">{%$item.busName2|escape%}</div> </td> {%/if%} <td class="op-map-bus-info-right"> <div class="op-map-bus-info-right-container"> <table class="op-map-bus-info-start-end"> <tr> {%$tempDataStartEndFontSize={%fe_fn_bus_font_size_zoom str=$item.startName|cat:$item.endName zoomMap=$tempDataStartEndFontSizeZoomMap%}%} <td class="op-map-bus-info-start" style="font-size:{%$tempDataStartEndFontSize%}px;line-height:{%if $tempDataStartEndFontSize<20%}20{%else%}{%$tempDataStartEndFontSize%}{%/if%}px;">{%$item.startName|escape%}</td> <td class="op-map-bus-info-derection">&nbsp;</td> <td class="op-map-bus-info-end" style="font-size:{%$tempDataStartEndFontSize%}px;line-height:{%if $tempDataStartEndFontSize<20%}20{%else%}{%$tempDataStartEndFontSize%}{%/if%}px;">{%$item.endName|escape%}</td> </tr> </table> <div class="op-map-bus-info-info"> <div class="c-clearfix"> <span class="op-map-bus-info-starttime">首车：{%$item.startTime|escape%}</span> <span class="op-map-bus-info-length"></span> </div> <div class="c-clearfix"> <span class="op-map-bus-info-endtime">末车：{%$item.endTime|escape%}</span> <span class="op-map-bus-info-price">票价：{%$item.price|escape%}</span> </div> </div> {%if $tab.detail|count > 1%} <div class="op-map-bus-info-switcher-border"></div><div class="op-map-bus-info-switcher OP_LOG_BTN" data-click="{fm:'beha'}">返程</div> {%/if%} <a href="{%$item.lineUrl%}" target="_blank" class="op-map-bus-info-link">在地图上显示路线</a> </div> </td> </tr> </table> <div class="op-map-bus-station"> <ul class="c-clearfix"> {%foreach $item.stopInfo as $stop%} {%$tempDataStopNameMaxLength=12%} {%$tempDataStopNameLength=$stop.stopName|string_display_len%} <li class="op-map-bus-stop{%if $stop.diffFlag%} op-map-bus-stop-diff{%/if%}"{%if $tempDataStopNameLength>$tempDataStopNameMaxLength%} title="{%$stop.stopName|escape%}"{%/if%} data-title="{%$stop.stopName|escape%}"> <a href="{%$stop.stopUrl%}" target="_blank"> <span class="op-map-bus-stop-num">{%$stop.stopNo|escape%}</span> <span class="op-map-bus-stop-sign"><span class="op-map-bus-stop-sign-right"></span><span class="op-map-bus-stop-sign-left"></span></span> <span class="op-map-bus-stop-text"> {%preg_replace('/\.\.\.$/', '<span class="op-map-bus-stop-tail"></span>', $stop.stopName|limitlen:$tempDataStopNameMaxLength)%} </span> </a> </li> {%if $stop@index!=0 && ($stop@index+1)%20==0 && $stop@index!=($item.stopInfo|count-1)%} </ul> {%if $stop@index==19%} <div class="op-map-bus-showmore OP_LOG_BTN" data-click="{fm:'beha'}"> <div class="op-map-bus-showmore-inner">查看完整站点 <i class="c-icon c-icon-chevron-bottom"></i></div> </div> {%/if%} <ul class="c-clearfix" style="display:none;"> {%/if%} {%/foreach%} </ul> {%if $item.stopInfo|count>20%} <div class="op-map-bus-showless OP_LOG_BTN" data-click="{fm:'beha'}" style="display:none;"> <div class="op-map-bus-showless-inner">收起 <i class="c-icon c-icon-chevron-top"></i></div> </div> {%/if%} </div> </div> {%/foreach%} </div> </div> {%/foreach%}</div>{%/block%}