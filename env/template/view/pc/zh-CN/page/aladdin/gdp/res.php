<?php 
  class CssJs_Util_gdp
   {
      private static $cssStr = '.op_gdp_title{font-size:1.07em;color:#666;font-weight:bold;}.op_gdp_subtitle{font-size:1.84em;color:#000;font-family:"Microsoft YaHei",SimHei;}.op_gdp_map_canvas{margin:0 140px 35px 50px;display:block;}.op_gdp_map_mask,.op_gdp_map_bg{position:absolute;top:0;left:50px;}.op_gdp_map_bg{z-index:-1;}.op_gdp_map_x{position:absolute;bottom:0;left:50px;height:25px;}.op_gdp_map_y{position:absolute;left:0;top:0;width:50px;}.op_gdp_info{position:absolute;right:0;top:0;width:130px;}.op_gdp_map_x span,.op_gdp_map_y span{position:absolute;font-size:.92em;white-space:nowrap;color:#666;}.op_gdp_map_y span{display:block;text-align:right;width:90%;}.op_gdp_map_x span i{position:absolute;left:50%;top:-10px;border:none;border-left:1px solid #ebebeb;width:1px;height:4px;line-height:4px;display:block;}.op_gdp_info li{padding-left:30px;font-size:.92em;}.op_gdp_info_icon{position:absolute;left:15px;}.op_gdp_info a{text-decoration:none;color:#333;}.op_gdp_map_x .op_gdp_tips{position:absolute;background:#bdc1c7;color:#fff;white-space:nowrap;padding:0 5px;height:20px;line-height:20px;font-size:.77em;}.op_gdp_tools a{text-decoration:none;}.op_gdp_tools a:hover{text-decoration:underline;}.op_gdp_tools{color:#999;font-size:.92em;text-align:right;}.op_gdp_tools a{color:#999;}.op_gdp_tools_sep{color:#ccc;margin:0 8px;}';  // css字串，不含<style>和</style>标签
      private static $jsStr  = 'A.merge("gdp",function(){A.setup(function(){var s=this;var t=["rgb(56,139,255)","rgb(255,179,26)","rgb(88,199,88)"];var l=["rgba(56,139,255,0.3)","rgba(255,179,26,0.3)","rgba(88,199,88,0.3)"];var q=["rgba(255,185,178,0.1)","rgba(178,217,255,0.1)","rgba(179,255,178,0.1)"];var g=s.find(".op_gdp_map_canvas")[0];var j=s.find(".op_gdp_map_bg",s)[0];var x=s.find(".op_gdp_map_mask",s)[0];var v=3,f=1;var n=null;var d=null;var e=null;var b=$(".op_gdp_info");s.find(".op_gdp_tools_fb").on("click",function(){$(this).hide().after("<span>感谢反馈</span>")});if(g){var p=!!document.createElement("canvas").getContext;if(!p){A.use("canvas",function(){A.ui.canvas.init(g);A.ui.canvas.init(x);A.ui.canvas.init(j);i()})}else{i()}}function i(){var T=g.getContext("2d");var X=x.getContext("2d");var P=j.getContext("2d");var O=[];for(var S=0;S<s.data.data.length;S++){s.data.data[S].p=s.data.data[S].p.replace(/\\;$/,"");var C=s.data.data[S].p.split(";");O[S]=[];for(var R=0;R<C.length;R++){var J=C[R].split(",")[0];var H=C[R].split(",")[1];O[S].push({x:J,y:H})}if(s.data.data[S].order=="1"){n=O[S][O[S].length-1].x}}P.strokeStyle="#ebebeb";w(P,0,g.height-0.5,g.width,g.height-0.5);var I=[];s.data.ycell.reverse();for(var S=0;S<s.data.ycell.length;S++){var Q=y(s.data.ycell[S].value);if(Q>0){w(P,0,Q,g.width,Q);I.push("<span style=\'top:"+Q+"px\'>"+s.data.ycell[S].text+"</span>")}}I.push("<span style=\'top:100%\'>0</span>");s.find(".op_gdp_map_y").html(I.join(""));var U=[];for(var S=0;S<s.data.xcell.length;S++){var V=z(s.data.xcell[S].value);U.push("<span class=\'c-gap-top\' style=\'left:"+V+"px\'><i></i>"+s.data.xcell[S].text+"</span>")}s.find(".op_gdp_map_x").html(U.join(""));$("span",".op_gdp_map_y").each(function(){$(this).css("margin-top",-($(this).height()/2))});$("span",".op_gdp_map_x").each(function(){$(this).css("margin-left",-($(this).width()/2))});var L=[];for(var S=0;S<O.length;S++){if(s.data.data[S].order==1){d=O[S]}var K=O[S][0],E=K.x,D=K.y;var F=O[S][O[S].length-1],N=F.x,M=F.y;c(T,O[S],t[s.data.data[S].order-1],s.data.data[S].order==1?v:f);if(n==O[S][O[S].length-1].x){var W=o(M)+s.data.currency}else{var W="-"}L.push("<li class=\'c-gap-bottom\'><span class=\'op_gdp_info_icon\' style=\'color:"+t[s.data.data[S].order-1]+"\'>●</span><a href=\'http://wwww.baidu.com/s?ie=utf-8&wd="+s.data.data[S].queryWord+"\'><span>"+s.data.data[S].name+"</span>：<p>"+W+"</p><p>&nbsp;</p></a></li>")}if(d){c(T,d,t[0],v)}b.html(L.join(""));var G=null;s.find(x).on("mousemove",function(ag){var Z=r(g);var ah={x:(ag.pageX||(ag.clientX+document.documentElement.scrollLeft))-Z.left,y:(ag.pageY||(ag.clientY+document.documentElement.scrollTop))-Z.top};var ad=a(B(ah.x),O);var aa={x:z(ad.x),y:y(ad.y)};if(G===null||aa.x!==G){X.clearRect(0,0,this.width,this.height);X.strokeStyle="#bdc1c7";u(X,aa.x,0,aa.x,g.height,1);var ac=null;for(var ae=0;ae<O.length;ae++){if(s.data.data[ae].order==1){ac=O[ae]}X.fillStyle=t[s.data.data[ae].order-1];var Y=(s.data.data[ae].order==1)?5:3;k(X,aa.x,y(h(ad.x,O[ae])),Y)}X.fillStyle=t[0];k(X,aa.x,y(h(ad.x,ac)),5);G=aa.x;if(s.find(".op_gdp_tips").length<=0){s.find(".op_gdp_map_x").append("<span class=\'op_gdp_tips\'></span>")}var af=s.find(".op_gdp_tips");af.html(ad.x);af.show();af.each(function(){$(this).css({left:aa.x,"margin-left":-($(this).outerWidth()/2)})});var ab=b.find("li");ab.each(function(ai){var aj=h(ad.x,O[ai]);if(aj=="-10"){$("p:first",this).html("-");$("p:last",this).html("")}else{$("p:first",this).html(o(aj)+s.data.currency);$("p:last",this).html("("+ad.x+"年)")}})}});s.find(x).on(navigator.userAgent.indexOf("msie")!=-1?"mouseleave":"mouseout",function(Z){G=null;X.clearRect(0,0,this.width,this.height);s.find(".op_gdp_tips").hide();var Y=b.find("li");Y.each(function(aa){if(n==O[aa][O[aa].length-1].x){$("p:first",this).html(o(O[aa][O[aa].length-1].y)+s.data.currency)}else{$("p:first",this).html("-")}$("p:last",this).html("&nbsp;")})});b.find("li").hover(function(){clearTimeout(e);b.find("a").css("color","#999");b.find(".op_gdp_info_icon").css({opacity:"0.3",filter:"alpha(opacity=50)"});$("a",this).css("color","#333");$(".op_gdp_info_icon",this).css({opacity:"1",filter:"alpha(opacity=100)"});$("a>span",this).css("text-decoration","underline");T.clearRect(0,0,g.width,g.height);for(var Z=0;Z<O.length;Z++){var aa=t[s.data.data[Z].order-1];var Y=v;if(Z!=$(this).index()){aa=l[s.data.data[Z].order-1];Y=1}c(T,O[Z],aa,Y)}},function(){b.find("a>span").css("text-decoration","none");e=setTimeout(function(){b.find("a").css("color","#333");b.find(".op_gdp_info_icon").css({opacity:"1",filter:"alpha(opacity=100)"});T.clearRect(0,0,g.width,g.height);for(var Y=0;Y<O.length;Y++){c(T,O[Y],t[s.data.data[Y].order-1],s.data.data[Y].order==1?v:f)}if(d){c(T,d,t[0],v)}},100)})}function r(D){var C=0,E=0;while(D!=null){C+=D.offsetLeft;E+=D.offsetTop;D=D.offsetParent}return{left:C,top:E}}function a(D,F){var G=null;for(var E=0;E<F.length;E++){for(var C=0;C<F[E].length;C++){if(G===null||Math.abs(F[E][C]["x"]-D)<Math.abs(G.x-D)){G=F[E][C]}}}return G}function h(D,C){for(var E=0;E<C.length;E++){if(C[E].x==D){return C[E].y}}return -10}function B(C){return Math.round(C/s.data.escaped_canvasWidth*(s.data.xmax-s.data.xmin))+parseInt(s.data.xmin)}function z(C){var D=Math.round(s.data.escaped_canvasWidth*(C-s.data.xmin)/(s.data.xmax-s.data.xmin));if(D>s.data.escaped_canvasWidth){return D-0.5}else{return D+0.5}}function y(D){if(D<0){return -10}var C=Math.round(s.data.escaped_canvasHeight-s.data.escaped_canvasHeight*(D-s.data.ymin)/(s.data.ymax-s.data.ymin))+5;if(C>g.height){return C-0.5}else{return C+0.5}}function c(C,I,K,F){C.strokeStyle=K;C.beginPath();var G=I[0],E=G.x,D=G.y;var M=I[I.length-1],L=M.x,J=M.y;C.moveTo(z(E),y(D));for(var H=0;H<I.length-1;H++){C.lineWidth=F;m(C,z(I[H].x),y(I[H].y),z(I[H+1].x),y(I[H+1].y))}C.stroke()}function m(F,D,G,C,E){F.lineTo(C,E)}function w(F,D,G,C,E){F.beginPath();F.moveTo(D,G);F.lineTo(C,E);F.stroke()}function u(E,F,L,C,K,D){D=D===undefined?5:D;var H=C-F;var G=K-L;var J=Math.floor(Math.sqrt(H*H+G*G)/D);E.beginPath();for(var I=0;I<J;++I){E[I%2===0?"moveTo":"lineTo"](F+(H/J)*I,L+(G/J)*I)}E.closePath();E.stroke()}function k(D,C,F,E){D.beginPath();D.arc(C,F,E,0,Math.PI*2);D.closePath();D.fill()}function o(C){if(s.data.ycell[0].text.indexOf("万亿")!=-1){if(C>1){return parseFloat(C).toFixed(2)+"万亿"}else{if(C*10000>1){return(C*10000).toFixed(2)+"亿"}else{return(C*100000000).toFixed(2)+"万"}}}else{if(s.data.ycell[0].text.indexOf("亿")!=-1){if(C>1){return parseFloat(C).toFixed(2)+"亿"}else{return(C*10000).toFixed(2)+"万"}}else{return parseFloat(C).toFixed(2)+"万"}}}this.dispose=function(){clearTimeout(e)}})});';   // js字串，不含<script标签
      private static $uiList = '';   // 包含的组件，以','分割的字符串，比如'input,text,button'这样
      
      public static function getHeadCss()
      {
         if (!is_string(self::$cssStr))
         {
            return '';
         }
         return self::$cssStr;
      }
      
      public static function getFootJs()
      {
         if (!is_string(self::$jsStr))
         {
            return '';
         }
         return self::$jsStr;
      }
      
      // 返回数组
      public static function getCssUI()
      {
		 if ( empty(self::$uiList) ) return array();

         $arr = @explode(',', self::$uiList);
         if (!is_array($arr))
         {
            $arr = array();
         }
         return $arr;
      }
   }
