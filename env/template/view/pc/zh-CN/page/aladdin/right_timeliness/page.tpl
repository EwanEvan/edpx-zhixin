{%extends 'c_right_base.tpl'%} {%block name='content'%}<style>{%if $extData.feData.platform === 'pc'%}.opr_timeliness_narrow{width:259px}{%/if%}</style>{%function name="getImgHTML" item=""%}{%if $item.imglink%}{%if $item.imgcontent%}<div class="opr_timeliness_imga" style="height:{%$item.imgheight|escape%}px">{%/if%}<a href="{%$item.imglink%}" target="_blank">{%/if%}<img src="{%$item.imgsrc%}" class="c-img" width="{%$item.imgwidth|escape%}px" height="{%$item.imgheight|escape%}px"/>{%if $item.imglink%}</a>{%if $item.imgcontent%}<span class="opr_timeliness_imgmask" style="width:{%$item.imgwidth|escape%}px"><a href="{%$item.imglink%}" class="c-gap-left-small" title="{%$item.imgcontent%}" target="_blank">{%if $item.imgwidth<=70%}{%$item.imgcontent|limitlen:8|escape%}{%else%}{%$item.imgcontent|limitlen:32|escape%}{%/if%}</a></span></div>{%/if%}{%/if%}{%/function%}<div class="{%if $tplData.narrow%} opr_timeliness_narrow{%/if%}"> {%$max_count=count($tplData.tips)%}{%for $index=0 to 4%}{%if $index<$max_count%} {%$item=$tplData.tips[$index]%} {%if $item.title%} <div {%if $index!=0%} class="c-gap-top-small"{%/if%}> <div class="cr-title{%if $item.seq=='1'&& $item.imgsrc%} c-gap-bottom{%/if%}"> {%if $item.titlelink%}<div class="cr-title-sub">{%build_search_url_limit_ubburl content=$item.titlelink%}</div>{%/if%} {%$item.title|limitlen:30|replace:'...':''|escape%} </div> <div class="opr_timeliness_tip_tip"> {%if $item.seq=='1'%} <table class="opr_timeliness_table"> <tr> <td> {%if $item.imgsrc%} {%getImgHTML item=$item%} {%if $item.imgwidth<=70%}</td><td>{%/if%} {%/if%} {%if !$item.imgsrc && $item.imglittle0%} <div class="c-row c-gap-top-small" style="width:101%"> {%for $index=0 to 2%} {%$params="imglittle{%$index%}"%} {%$paramlink="imglittlelink{%$index%}"%} {%if $item[$params]%} <div class="c-span4 {%if $index ==2%} c-span-last{%/if%}"> <a href="{%$item[$paramlink]%}" target="_blank"><img class="c-img c-img4" src="{%$item[$params]%}" /></a> </div> {%/if%} {%/for%} </div> {%/if%} {%if $item.label0%} <p class="c-gap-top-small">{%build_search_url_limit_ubburl content=$item.label0%}</p> {%/if%} {%if $item.label1%} <ul class="{%if $item.imgsrc&&$item.imgwidth<=70%}c-gap-left-small{%else%}c-gap-top-small{%/if%}"> {%if $item.label2%} {%for $ind=1 to 10%} {%$param="label{%$ind%}"%} {%if $item[$param]%} <li> {%build_search_url_limit_ubburl content=$item[$param]%} </li> {%else%} {%break%} {%/if%} {%/for%} {%else%} <li>{%build_search_url_limit_ubburl content=$item.label1%}</li> {%/if%} </ul> {%/if%} </td> </tr> </table> {%else%} {%if !$item.imgsrc && $item.imglittle0%} <div class="c-row c-gap-top c-gap-bottom-small"> {%for $index=0 to 2%} {%$params="imglittle{%$index%}"%} {%$paramlink="imglittlelink{%$index%}"%} {%if $item[$params]%} <div class="c-span4 {%if $index ==2%} c-span-last{%/if%}"> <a href="{%$item[$paramlink]%}" target="_blank"><img class="c-img c-img4" src="{%$item[$params]%}" /></a> </div> {%/if%} {%/for%} </div> {%/if%} {%if $item.label0%} <p class="c-gap-top-small">{%build_search_url_limit_ubburl content=$item.label0%}</p> {%/if%} {%if $item.label1%} <ul class="c-gap-top-small"> {%if $item.label2%} {%for $ind=1 to 10%} {%$param="label{%$ind%}"%} {%if $item[$param]%} {%$hotico = 'hotico'|cat:$ind%} {%$newico = 'newico'|cat:$ind%} <li> {%build_search_url_limit_ubburl content=$item[$param]%}{%if $item.$hotico && substr($hotico,-1)==$ind%}<i class="c-text c-text-danger c-gap-icon-left-small">热</i>{%/if%}{%if $item.$newico && substr($newico,-1)==$ind%}<i class="c-text c-text-danger c-gap-icon-left-small">新</i>{%/if%} </li> {%else%} {%break%} {%/if%} {%/for%} {%else%} <li>{%build_search_url_limit_ubburl content=$item.label1%}</li> {%/if%} </ul> {%/if%} {%if $item.imgsrc%} {%getImgHTML item=$item%} {%/if%} {%/if%} </div> </div> {%/if%} {%else%} {%break%} {%/if%} {%/for%}</div>{%if $tplData.activities[0]%}<div class="op_timeliness_inNum"> {%$tplData.activities[0].beforeTip%}<span>{%$tplData.activities[0].num%}</span>{%$tplData.activities[0].afterTip%}</div>{%/if%}{%if $tplData.mh%}<div class="op_timeliness_light op_timeliness_lightcursor OP_LOG_BTN" data-click="{'fm':'beha'}"> <img src="http://www.baidu.com/aladdin/img/right_timeliness/lightBefore.png" width="139" height="148" class="op_timeliness_lightB"> <div class="op_timeliness_box"{%if !isset($tplData.mharea)%} style="display:none"{%/if%}><textarea class="op_timeliness_area c-gap-top">{%$tplData.mharea%}</textarea></div> <div class="op_timeliness_tip"{%if !isset($tplData.mhtip)%} style="display:none"{%/if%}>{%$tplData.mhtip%}</div> <div class="op_timeliness_close"></div></div><div class="op_timeliness_mh" style="display:none;"> <div> <div class="op_timeliness_mhbtn_wrap"><span class="op_timeliness_mhbtn OP_LOG_BTN" data-click="{'fm':'beha'}"></span></div> {%if $tplData.share%} <div class="op_timeliness_share" style="float:right" data-click="{fm:'beha'}"></div> <div class="op_timeliness_sharetip">分享：</div> <script>A.setup({'sharetext':'{%$tplData.share[0].text%}','sharepic':'{%$tplData.share[0].pic%}'});</script>{%/if%} </div></div><script>A.setup({'misslist':'{%$tplData.misslist|escape:"javascript"|escape:"html"%}','misstitle':'{%$tplData.misstitle|escape:"javascript"|escape:"html"%}'});</script><script>A.setup(function(){var _this = this, ajaxFinished = false;var lights = [], lightNum = 15, lightTimer, lightSp = null;var pattern=window.navigator.userAgent.match(/MSIE\s*(\d+)/);if (pattern && pattern[1] && parseInt(pattern[1])<7) return;var $shareDom = _this.find('.op_timeliness_share');function light(index){var _me = this;this.screenWidth = document.documentElement.clientWidth || document.body.clientWidth;this.screenHeight = document.documentElement.clientHeight || documen{%*i*%}t.body.clientHeight;this.img = null;this.moveInterval = null;this.hideInterval = null;this.index = index;}light.prototype = {_init : function() {this.initData();this.draw();this.startMove(); },initData : function() {this.direction = (Math.random() - 0.5) > 0;this.moveX = Math.random() * (this.screenWidth-150) + 50;this.moveY = document.documentElement.clientHeight*2/3 || document.body.clientHeight*2/3;this.speedX = this.direction?(0.01 + Math.random()/100):-(0.01 + Math.random()/100);this.angleX{%*i*%} = 0;this.speedY = -1 - Math.random() * 2;this.amplitude = Math.random() * 2;this.opacity = 1;this.scrollTop = $(document).scrollTop();},draw : function() {var _me = this;_me.img = document.createElement('img');var cssStyle = {'position':'absolute','opacity':_me.opacity,'zIndex':'1000000'};var imgNum = Math.floor(Math.random() * 10 % 2);_me.img.src = 'http://www.baidu.com/aladdin/img/right_timeliness/light'+ imgNum +'.png';for( var i in cssStyle) {_me.img.style[i] = cssStyle[i];}_me.img.style.le{%*i*%}ft = _me.moveX + 'px';_me.img.style.top = _me.moveY + $(document).scrollTop() + 'px';$(_me.img).attr('data-nolog','1');_this.container.appendChild(_me.img);},move : function() {var _me = this,screenWNow = document.documentElement.clientWidth || document.body.clientWidth,screenHNow = document.documentElement.clientHeight || document.body.clientHeight;_me.angleX += _me.speedX;_me.moveX = _me.moveX + _me.amplitude * Math.sin(_me.angleX);_me.moveY += _me.speedY;if ( 50 < _me.moveX && _me.moveX < (sc{%*i*%}reenWNow - 50) && _me.moveY > 50 ) {_me.img.style.left = _me.moveX + 'px';_me.img.style.top = _me.moveY + $(document).scrollTop() + 'px';} else {if ( !_me.hideInterval) {_me.opacity = 1;_me.hideInterval = setInterval(function(){ _me.img.style.left = _me.moveX + 'px';_me.img.style.top = _me.moveY + $(document).scrollTop() + 'px';if (_me.opacity >= 0) {_me.opacity -= 0.2;_me.img.style.opacity = _me.opacity;} else {_me.stopMove();_me.reDraw();_me.startMove();}}, 50);}}},reDraw : function() {var _me{%*i*%} = this;clearInterval(_me.hideInterval);_me.hideInterval = null;this.initData();_me.img.style.left = _me.moveX + 'px';_me.img.style.top = _me.moveY + $(document).scrollTop() + 'px';_me.img.style.opacity = 1;},stopMove : function() {var _me = this;clearInterval(_me.moveInterval);},startMove : function() {var _me = this;_me.moveInterval = setInterval(function(){_me.move();}, 50)},destory : function() {var _me = this;clearInterval(_me.hideInterval);clearInterval(_me.moveInterval);if (_me.img.parent{%*i*%}Node) {_me.img.parentNode.removeChild(_me.img); }_me = null;}};function lightS(div){var _me = this;this.screenWidth = document.documentElement.clientWidth || document.body.clientWidth;this.screenHeight = document.documentElement.clientHeight || document.body.clientHeight;this.div = div; this.moveX = $(div).position().left;this.moveY = $(div).position().top - $(document).scrollTop();this.moveInterval = null;this.hideInterval = null;this.direction = (Math.random() - 0.5) > 0;this.speedX = this.dir{%*i*%}ection?(0.01 + Math.random()/100):-(0.01 + Math.random()/100);this.angleX = 0;this.speedY = -1 - Math.random() * 2;this.amplitude = Math.random() * 2;this.opacity = 1;this.scrollTop = $(document).scrollTop();}lightS.prototype = {move : function() {var _me = this,screenWNow = document.documentElement.clientWidth || document.body.clientWidth,screenHNow = document.documentElement.clientHeight || document.body.clientHeight;_me.angleX += _me.speedX;_me.moveX = _me.moveX + _me.amplitude * Math.sin(_me{%*i*%}.angleX);_me.moveY += _me.speedY;if ( 50 < _me.moveX && _me.moveX < (screenWNow - 50) && _me.moveY > 50 ) {_me.div.style.left = _me.moveX + 'px';_me.div.style.top = _me.moveY + $(document).scrollTop() + 'px';} else {if ( !_me.hideInterval) {_me.opacity = 1;_me.hideInterval = setInterval(function(){ _me.div.style.left = _me.moveX + 'px';_me.div.style.top = _me.moveY + $(document).scrollTop() + 'px';if (_me.opacity >= 0) {_me.opacity -= 0.2;_me.div.style.opacity = _me.opacity;} else {_me.destory(){%*i*%};}}, 50);}}},stopMove : function() {var _me = this;clearInterval(_me.moveInterval);},startMove : function() {var _me = this;_me.moveInterval = setInterval(function(){_me.move();}, 50)},destory : function() {var _me = this;clearInterval(_me.hideInterval);clearInterval(_me.moveInterval);if (_me.div.parentNode) {_me.div.parentNode.removeChild(_me.div); }_me = null;}};var $mhBtn = _this.find('.op_timeliness_mhbtn').eq(0), $mhDiv = _this.find('.op_timeliness_mh').eq(0); if ($mhBtn.length>0) {$mhBtn.o{%*i*%}n('click', function() { destroyEgg();$mhDiv.hide();});}var $close = $('.op_timeliness_close');$close.on('click', function(e){e.stopPropagation(); destroyEgg();});var $lightDom = $('.op_timeliness_light').eq(0);var $lightB = $('.op_timeliness_lightB').eq(0);var $lightTip = $('.op_timeliness_tip').eq(0);var $wishBox = $('.op_timeliness_box').eq(0);var $wishArea = $('.op_timeliness_area').eq(0);var $mask = $('<div class="op_timeliness_mask"></div>');$('body').append($mask);if (_this.data.misslist) {%*i*%}{var $missList = $('<div class="op_timeliness_mask_list"><div class="op_timeliness_mask_title">'+_this.data.misstitle+'</div><marquee direction="up" scrollamount="1" height="65">'+_this.data.misslist+'</marquee></div>');$mask.append($missList);}initStars();var image = new Image(),imgCache=[];image.src = 'http://www.baidu.com/aladdin/img/right_timeliness/lightAfter.png';imgCache.push(image);$wishArea.on('focus', function(){$wishArea.animate({'height':'45px','max-height':'45px'});});$lightB.on('cl{%*i*%}ick', makeAWish);$lightTip.on('click', makeAWish);function makeAWish(){$lightDom.removeClass('op_timeliness_lightcursor');$lightB.attr('src', 'http://www.baidu.com/aladdin/img/right_timeliness/lightAfter.png');$mask.show(); $mhDiv.show();$close.hide();initLights();var left = Math.random() * ((document.documentElement.clientWidth || document.body.clientWidth) - 400) + 100;var bottom = Math.random() * 200;$lightB.animate({'width':'32', 'height':'31'}, 5000);$lightDom.animate({'left':left,'bottom':{%*i*%}200}, 5000, function(){$lightDom.css({'position':'absolute','left':$lightDom.position().left,'top':$lightDom.position().top, 'bottom':''});var lightSp = new lightS($lightDom.get(0));lightSp.startMove();}); $lightTip.hide();$wishBox.hide();}function initStars(){if ($mask.length <= 0) return;for(var i=0; i < 20; i++){ var left = 5 + Math.random()*90 + '%';var top = 5 + Math.random()*60 + '%';var opacity = 0.5 + Math.random() * 0.5;var size = 8 + Math.random() * 16;var $statImg = $('<img src="http:{%*i*%}//www.baidu.com/aladdin/img/right_timeliness/star.png" class="op_timeliness_star" />').css({'left':left,'top':top, 'opacity':opacity,'width':size,'height':size,'filter':''});$mask.append($statImg);}}function initLights(){for (var i = 0; i < 5; i ++) {lights[i] = new light(i);lights[i]._init();}lightTimer = setInterval( function() {var lightCount = lights.length;if ( lightCount < lightNum) {lights[lightCount] = new light(lightCount);lights[lightCount]._init();} else {clearInterval(lightTimer);}},{%*i*%} 2000); }var mhshare;if (_this.data.sharetext) {bds.ready(function(){A.use('share', function(){mhshare = A.ui.share($shareDom.get(0),{text:_this.data.sharetext,pic:_this.data.sharepic,hideMore:true,data:[{id: 'tsina', title: "分享到新浪微博"},{id: 'tieba', title: "分享到百度贴吧"}]});}); });}function destroyEgg(){var maskWrap = $mask.get(0);if (maskWrap&&maskWrap.parentNode) {maskWrap.parentNode.removeChild(maskWrap); }clearInterval(lightTimer);if (lightSp) {lightSp.destory();} else {var lightWrap = $lightDom{%*i*%}.get(0);if (lightWrap&&lightWrap.parentNode) {lightWrap.parentNode.removeChild(lightWrap); }}if(lights.length>0){for (var i = 0; i < lights.length; i ++) {lights[i].destory();}}mhshare && mhshare.dispose && mhshare.dispose();};this.dispose = function(){destroyEgg();};});</script>{%/if%}{%/block%}