{%*
* @fileOverview 中间页模板-公共函数
* @author       刘悦
* @version      1.0
* @date         2012/12/11
*%}{%function name=display_time%}{%$timeDiff=$serverTime-$second%}{%$timeDiffMin=$timeDiff/60%}{%$timeDiffHour=$timeDiff/3600%}{%$timeDiffDay=$timeDiff/86400%}{%if $timeDiff > 0%}{%if $timeDiffMin < 60%}{%($timeDiffMin <= 1) ? "1" : $timeDiffMin|string_format:'%d' %}分钟{%else%}{%($timeDiffHour < 24) ? "`$timeDiffHour|string_format:'%d'`小时" : "`$timeDiffDay|string_format:'%d'`天"%}{%/if%}前{%/if%}{%/function%}{%function name=make_url%}{%(strlen($eurl)>0 && strlen($eurl)<$urlEncMaxLen)?"`$urlEncryption_jump``$eurl`":"`$ourl`"%}{%/function%}{%function name=enc_url%}{%if $urlEncryption%}{%if $token && $resToken[$token]%}{%$urlTokenMd5Str = "`$url``$serverTime`"%}{%$urlTokenMd5 = md5($urlTokenMd5Str)%}{%$urlToken = "`$urlTokenMd5`&`$serverTime`"|encryptUrl:3:$productEncKey%}{%if strlen($urlToken)>0 && strlen($urlToken)<$urlEncMaxLen%}{%$url = "`$url`&__bd_tkn__=`$urlToken`"%}{%/if%}{%/if%}{%make_url eurl=$url|encryptUrl ourl=$url%}{%else%}{%$url|vui_escape:'html'%}{%/if%}{%/function%}{%* 循环结果，用于上侧结果、右侧结果 *%}{%function name=loop_results%}{%if $theResult%}<div id="con-{%$fm%}">{%foreach $theResult.item as $res%} {%$useSmarty = $res.dispData.strategy && $res.dispData.strategy.ctplOrPhp%} {%$aladdinHTML = ''%}{%if $useSmarty%}{%if $res.dispData.strategy.tempName == 'mid_right_timeline'%}{%$aladdinHTML = $res.dispData|aladdin_render:$res.dispData.strategy.tempName:$res@index%}{%/if%} {%/if%} {%if $aladdinHTML != ''%} <div class="result-op xpath-log" data-click="{fm:'{%$fm%}',p1:'{%$res@index + 1%}'{%if $res.dispData.SrcId%},rsv_srcid:'{%$res.dispData.SrcId%}'{%/if%},mu:'{%trim($res.itemUrl)%}'}">{%$aladdinHTML%}</div> {%/if%} {%/foreach%}</div>{%/if%}{%/function%}