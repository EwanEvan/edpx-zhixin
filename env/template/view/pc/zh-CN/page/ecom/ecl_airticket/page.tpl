{%extends 'base_div.tpl'%}

{%block name='content'%}

{%if $extData.ecomtn == 'list'%}

<style type="text/css">
.ecl-left_airticket-main{width:600px;font-size:12px;background:#fdfdfd}.ecl-left_airticket-main strong{font-size:inherit;font-weight:normal}.ecl-left_airticket-main h2,.ecl-left_airticket-main h3,.ecl-left_airticket-main h4,.ecl-left_airticket-main h5{margin:0;padding:0;font-weight:normal;line-height:inherit;font-size:inherit}.ecl-left_airticket-ui-city{width:360px;position:absolute;z-index:1000;border:1px solid #ddd;background-color:#fff;padding:5px;font-size:12px;color:#555}.ecl-left_airticket-ui-city a{text-decoration:none}
.ecl-left_airticket-ui-city .ecl-left_airticket-ui-city-labels,.ecl-left_airticket-ui-city .ecl-left_airticket-ui-city-panels{list-style:none}.ecl-left_airticket-ui-city .ecl-left_airticket-ui-city-close{color:#b4b4b4;font:bold 12px/1.2 'Comic Sans MS';padding:0 3px;position:absolute;right:3px;top:8px}.ecl-left_airticket-ui-city .ecl-left_airticket-ui-city-close:visited{color:#b4b4b4}.ecl-left_airticket-ui-city .ecl-left_airticket-ui-city-labels{border-top:1px dashed #ddd;border-bottom:1px solid #ddd;padding-top:8px;margin-top:5px}
.ecl-left_airticket-ui-city .ecl-left_airticket-ui-city-labels li{border:1px solid #ddd;background-color:#fff;float:left;padding:3px 5px;margin-right:10px;margin-bottom:-1px;cursor:pointer;color:#0069ca;line-height:16px}.ecl-left_airticket-ui-city .ecl-left_airticket-ui-city-labels .ecl-left_airticket-ui-city-active{background-color:#e8edf1}.ecl-left_airticket-ui-city .ecl-left_airticket-ui-city-panels li{display:none;float:left;line-height:18px}.ecl-left_airticket-ui-city .ecl-left_airticket-ui-city-panels .ecl-left_airticket-ui-city-active{display:block}
.ecl-left_airticket-ui-city .ecl-left_airticket-ui-city-panels a{color:#555;width:70px;display:inline-block;float:left;padding:5px 0;text-align:center;text-decoration:none}.ecl-left_airticket-ui-city .ecl-left_airticket-ui-city-panels a:visited{color:#555}.ecl-left_airticket-ui-cal{position:absolute;border:1px solid #b5b5b5;background:#fff;text-align:center;z-index:10}.ecl-left_airticket-ui-cal h3{margin:0;padding:0;text-align:center;line-height:19px;height:19px;overflow:hidden;font-size:14px;background:url(http://s1.bdstatic.com/r/www/cache/biz/ecom/hotel/img/hotel_cal.gif) 1px 0 repeat-x;color:#41537b;margin-bottom:2px;border:1px solid #c6cede;border-top-color:#e9eff9;border-left-color:#e9eff9}
.ecl-left_airticket-ui-cal ul{background:#f1f4f9;color:#000}.ecl-left_airticket-ui-cal ul li{font-weight:bold;padding:4px 0}.ecl-left_airticket-ui-cal li,.ecl-left_airticket-ui-cal p a{float:left;width:25px;font:12px tahoma,arial,sans-serif}.ecl-left_airticket-ui-cal p a{color:#000;height:18px;font:normal 12px/18px tahoma,arial,sans-serif;margin-top:3px;text-decoration:none;outline:0;overflow:hidden}.ecl-left_airticket-ui-cal p a:visited{color:#000}.ecl-left_airticket-ui-cal p a:hover{color:#fff;background:#eb4f03}
.ecl-left_airticket-ui-cal p a.ecl-left_airticket-ui-cal-pre-month,.ecl-left_airticket-ui-cal p a.ecl-left_airticket-ui-cal-next-month{color:#999}.ecl-left_airticket-ui-cal p a.ecl-left_airticket-ui-cal-pre-month:visited,.ecl-left_airticket-ui-cal p a.ecl-left_airticket-ui-cal-next-month:visited{color:#999}.ecl-left_airticket-ui-cal p a.ecl-left_airticket-ui-cal-disabled,.ecl-left_airticket-ui-cal p a.ecl-left_airticket-ui-cal-disabled:hover{color:#ddd;cursor:not-allowed;background:0}.ecl-left_airticket-ui-cal p a.ecl-left_airticket-ui-cal-disabled:visited,.ecl-left_airticket-ui-cal p a.ecl-left_airticket-ui-cal-disabled:hover:visited{color:#ddd}
.ecl-left_airticket-ui-cal-month{float:left;margin:auto 2px;width:175px;border-left:1px solid #dae2f5}.ecl-left_airticket-ui-cal-month .ecl-left_airticket-ui-cal-weekend{color:#c60b02}.ecl-left_airticket-ui-cal-month .ecl-left_airticket-ui-cal-weekend:visited{color:#c60b02}.ecl-left_airticket-ui-cal-month .ecl-left_airticket-ui-cal-today{color:#f00}.ecl-left_airticket-ui-cal-month .ecl-left_airticket-ui-cal-today:visited{color:#f00}.ecl-left_airticket-ui-cal-month .ecl-left_airticket-ui-cal-checked{color:#fff;background:#3977d2}
.ecl-left_airticket-ui-cal-month .ecl-left_airticket-ui-cal-checked:visited{color:#fff}.ecl-left_airticket-ui-cal-pre,.ecl-left_airticket-ui-cal-next{width:5px;height:9px;font-size:0;position:absolute;display:block;overflow:hidden;top:6px;background:url(http://s1.bdstatic.com/r/www/cache/biz/ecom/hotel/img/hotel_cal.gif) 0 -19px}.ecl-left_airticket-ui-cal-pre{left:6px}.ecl-left_airticket-ui-cal-next{right:6px;background-position:0 -28px}.ecl-left_airticket-price-calendar{position:absolute;border:1px solid #adb0b6;background:#fdfdfd;text-align:center;z-index:10}
.ecl-left_airticket-price-calendar h3{margin:0;padding:0;text-align:center;line-height:20px;height:20px;overflow:hidden;font-size:14px;background:#fdfdfd;color:#666;margin:2px 0}.ecl-left_airticket-price-calendar ul{background:#fdfdfd;color:#666}.ecl-left_airticket-price-calendar ul li{font-weight:bold;padding:4px 0;width:45px;margin:1px}.ecl-left_airticket-price-calendar li,.ecl-left_airticket-price-calendar p a{float:left;font:12px tahoma,arial,sans-serif}.ecl-left_airticket-price-calendar p{padding-bottom:10px;padding-left:4px}
.ecl-left_airticket-price-calendar p a{color:#c5c5c5;width:37px;height:37px;padding:8px 8px 0 0;font:normal 12px/18px tahoma,arial,sans-serif;margin:1px;text-decoration:none;outline:0;overflow:hidden;background:#f3f3f3;text-align:right;line-height:14px}.ecl-left_airticket-price-calendar p a:visited{color:#f80}.ecl-left_airticket-price-calendar p a:hover{color:#fff;background:#f80}.ecl-left_airticket-price-calendar p a:hover b{color:#fff}.ecl-left_airticket-price-calendar p a.ecl-left_airticket-price-calendar-pre-month,.ecl-left_airticket-price-calendar p a.ecl-left_airticket-price-calendar-next-month{color:#999}
.ecl-left_airticket-price-calendar p a.ecl-left_airticket-price-calendar-pre-month:visited,.ecl-left_airticket-price-calendar p a.ecl-left_airticket-price-calendar-next-month:visited{color:#999}.ecl-left_airticket-price-calendar p a.ecl-left_airticket-price-calendar-disabled,.ecl-left_airticket-price-calendar p a.ecl-left_airticket-price-calendar-disabled:hover{color:#ddd;cursor:not-allowed;background:0}.ecl-left_airticket-price-calendar p a.ecl-left_airticket-price-calendar-disabled:visited,.ecl-left_airticket-price-calendar p a.ecl-left_airticket-price-calendar-disabled:hover:visited{color:#ddd}
.ecl-left_airticket-price-calendar p a b{display:block;color:#f80;font-weight:normal;padding-top:5px}.ecl-left_airticket-price-calendar-month{float:left;margin:auto 2px;width:338px}.ecl-left_airticket-price-calendar-month .ecl-left_airticket-price-calendar-weekend{color:#c60b02}.ecl-left_airticket-price-calendar-month .ecl-left_airticket-price-calendar-weekend:visited{color:#c60b02}.ecl-left_airticket-price-calendar-month .ecl-left_airticket-price-calendar-today{color:#f00}.ecl-left_airticket-price-calendar-month .ecl-left_airticket-price-calendar-today:visited{color:#f00}
.ecl-left_airticket-price-calendar-month .ecl-left_airticket-price-calendar-checked{color:#fff;background:#f80}.ecl-left_airticket-price-calendar-month .ecl-left_airticket-price-calendar-checked b{color:#fff}.ecl-left_airticket-price-calendar-month .ecl-left_airticket-price-calendar-checked:visited{color:#fff}.ecl-left_airticket-price-calendar-pre,.ecl-left_airticket-price-calendar-next{width:18px;height:18px;font-size:0;position:absolute;display:block;overflow:hidden;top:5px}.ecl-left_airticket-price-calendar-pre{left:8px;background:url(http://s1.bdstatic.com/r/www/cache/biz/ecom/airticket/20130625a/list.gif) 0 -334px}
.ecl-left_airticket-price-calendar-next{right:8px;background:url(http://s1.bdstatic.com/r/www/cache/biz/ecom/airticket/20130625a/list.gif) -64px -334px}.ecl-left_airticket-flight-pager{display:inline-block;*display:inline;*zoom:1}.ecl-left_airticket-flight-pager a{display:block;float:left;margin:3px;text-decoration:none;border:1px solid #CCC;overflow:hidden;padding:2px 5px;color:#03C;font:normal 12px/1.2 Arial,Helvetica,sans-serif;text-align:center}.ecl-left_airticket-flight-pager a em{vertical-align:middle;border:5px solid #fff;font-size:0;margin:auto 3px;*zoom:1}
.ecl-left_airticket-flight-pager a:visited{color:#03C}.ecl-left_airticket-flight-pager a:hover{background-color:#eff4fa}.ecl-left_airticket-flight-pager a:hover em{border-color:#eff4fa}.ecl-left_airticket-flight-pager a.ecl-left_airticket-flight-pager-ellipsis{border:0}.ecl-left_airticket-flight-pager .ecl-left_airticket-flight-pager-current{font-weight:700;border:0;color:#666;cursor:default}.ecl-left_airticket-flight-pager .ecl-left_airticket-flight-pager-current:visited{color:#666}.ecl-left_airticket-flight-pager .ecl-left_airticket-flight-pager-current:hover,.ecl-left_airticket-flight-pager .ecl-left_airticket-flight-pager-ellipsis:hover,.ecl-left_airticket-flight-pager .ecl-left_airticket-flight-pager-disabled:hover{background:0}
.ecl-left_airticket-flight-pager .ecl-left_airticket-flight-pager-current:hover em,.ecl-left_airticket-flight-pager .ecl-left_airticket-flight-pager-ellipsis:hover em,.ecl-left_airticket-flight-pager .ecl-left_airticket-flight-pager-disabled:hover em{border-color:#FFF}.ecl-left_airticket-flight-pager .ecl-left_airticket-flight-pager-prev em,.ecl-left_airticket-flight-pager .ecl-left_airticket-flight-pager-prev:hover em{border-right-color:#999;border-left:none}.ecl-left_airticket-flight-pager .ecl-left_airticket-flight-pager-next em,.ecl-left_airticket-flight-pager .ecl-left_airticket-flight-pager-next:hover em{border-left-color:#999;border-right:0}
.ecl-left_airticket-flight-pager .ecl-left_airticket-flight-pager-disabled{display:none}h2.ecl-left_airticket-title{height:16px;font-size:16px;font-weight:normal;margin-top:0;padding-bottom:10px;background:#fff}h2.ecl-left_airticket-title a{float:left;font-size:16px;text-decoration:underline;outline:0}.ecl-left_airticket-clearfix{zoom:1}.ecl-left_airticket-clearfix:after{clear:both;content:".";display:block;height:0;visibility:hidden}.ecl-left_airticket-hide{display:none}.ecl-left_airticket-highlight{color:#f80}
.ecl-left_airticket-main .ecl-left_airticket-error{background-color:#c30;color:#fff;padding:2px}.ecl-left_airticket-toparea{background:#fdfdfd;border:1px solid #f5f5f5;border-bottom:0;padding:8px 0 0}.ecl-left_airticket-query{line-height:25px;height:25px;padding-left:9px}.ecl-left_airticket-query .ecl-left_airticket-query-item{float:left;margin-right:10px}.ecl-left_airticket-query .ecl-left_airticket-query-item h5{float:left;margin-right:10px;line-height:24px}.ecl-left_airticket-query .ecl-left_airticket-query-item b{display:block;width:17px;height:17px;margin-top:2px;float:left;cursor:pointer}
.ecl-left_airticket-input,.ecl-left_airticket-cal{float:left;border:1px solid #b5b5b5;background:#FFF;height:21px;line-height:21px}.ecl-left_airticket-input input,.ecl-left_airticket-cal input{float:left;padding-left:5px;height:21px;line-height:21px;border:0;outline:0;font-size:12px}.ecl-left_airticket-input,.ecl-left_airticket-cal{margin-top:1px}.ecl-left_airticket-input{width:96px;_width:91px}.ecl-left_airticket-input input{width:56px;*width:50px;_width:46px}.ecl-left_airticket-input label{float:left;width:20px;margin-top:1px;line-height:20px;text-align:center;color:#999}
.ecl-left_airticket-input .ecl-left_airticket-layer{white-space:nowrap;width:160px}.ecl-left_airticket-tocity{margin-right:10px}.ecl-left_airticket-cal{width:158px;*width:154px}.ecl-left_airticket-cal input{width:138px;*width:128px;cursor:pointer;-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;-khtml-user-select:none;user-select:none}.ecl-left_airticket-cal b{background:url("http://s1.bdstatic.com/r/www/cache/biz/ecom/hotel/img/hotel_cbtn.gif") no-repeat}.ecl-left_airticket-cal-layer{z-index:10;zoom:1}.ecl-left_airticket-exchange{display:block;float:left;border:0;padding:0;background:0;width:43px;height:23px;background:url(http://s1.bdstatic.com/r/www/cache/biz/ecom/airticket/20130625a/list.gif) no-repeat 5px -170px;cursor:pointer;text-indent:-9999px}
.ecl-left_airticket-layer{position:absolute;zoom:1;left:-10000px;margin-top:2px;margin-left:-1px;border:#d0d0d0 solid 1px;background:#fff;z-index:10;color:#666;line-height:20px}.ecl-left_airticket-layer button,.ecl-left_airticket-input b{border:0;background:0;background:url("http://s1.bdstatic.com/r/www/cache/biz/ecom/hotel/img/hotel_btn.png") 0 0 no-repeat;overflow:hidden}.ecl-left_airticket-layer button{float:right;margin:6px 5px auto auto;width:9px;height:9px;background-position:0 -25px;cursor:pointer}.ecl-left_airticket-submit{display:block;border:0;margin:0;padding:0;background:0;float:left;width:82px;height:26px;line-height:26px;background:url(http://s1.bdstatic.com/r/www/cache/biz/ecom/hotel/img/button_sprites.png) no-repeat no-repeat;overflow:hidden;text-align:center;text-decoration:none;color:#333;font-size:12px;cursor:pointer}
.ecl-left_airticket-submit.ecl-left_airticket-submit-hover{background-position:-84px 0}.ecl-left_airticket-submit.ecl-left_airticket-submit-press{background-position:-168px 0}.ecl-left_airticket-weekprice{margin-top:10px;padding-left:10px;height:50px;_height:51px}.ecl-left_airticket-weekprice li{float:left;display:block;border:1px solid #b8b8b8;height:50px;width:82px;margin:-1px -1px -1px 0;background:0;cursor:pointer;text-align:center;position:relative;zoom:1;z-index:1;color:#666}.ecl-left_airticket-weekprice li.ecl-left_airticket-cur{background:#e8f5ff;border-color:#92bbe0;z-index:5}
.ecl-left_airticket-weekprice li.ecl-left_airticket-cur em{font-weight:bold}.ecl-left_airticket-weekprice li em{color:#f80;font-size:13px}.ecl-left_airticket-weekprice li p{margin:7px 0}.ecl-left_airticket-weekprice li.ecl-left_airticket-price-calendar-tab{height:15px;line-height:15px;padding:18px 0 17px;color:#f80}.ecl-left_airticket-weekprice li.ecl-left_airticket-price-calendar-tab-expanded{border-bottom:1px solid #fff;position:relative;z-index:12}.ecl-left_airticket-price-calendar-target{display:none}.ecl-left_airticket-resultinfo,.ecl-left_airticket-filter,.ecl-left_airticket-filter-more{color:#666;padding-left:9px}
.ecl-left_airticket-filter{margin-right:0;position:relative}.ecl-left_airticket-resultinfo{margin:10px 0 8px}.ecl-left_airticket-resultinfo i{font-style:normal}.ecl-left_airticket-resultinfo em{color:#f80;margin:0 5px}.ecl-left_airticket-resultinfo span{margin-right:20px}.ecl-left_airticket-ft-wrap{position:relative;margin-top:10px}.ecl-left_airticket-filter,.ecl-left_airticket-filter-more{line-height:22px;height:22px;margin-bottom:4px}.ecl-left_airticket-filter .ecl-left_airticket-option,.ecl-left_airticket-filter-more .ecl-left_airticket-option{float:left;width:310px}
.ecl-left_airticket-filter .ecl-left_airticket-option-short,.ecl-left_airticket-filter-more .ecl-left_airticket-option-short{width:275px}.ecl-left_airticket-filter .ecl-left_airticket-option-short strong,.ecl-left_airticket-filter-more .ecl-left_airticket-option-short strong{width:30px}.ecl-left_airticket-filter strong,.ecl-left_airticket-filter-more strong{color:#000;font-weight:bold;float:left;width:55px;line-height:22px;margin-right:10px}.ecl-left_airticket-filter p,.ecl-left_airticket-filter-more p{float:left;color:#666}
.ecl-left_airticket-filter-fill{height:auto;margin-bottom:4px}.ecl-left_airticket-filter-fill .ecl-left_airticket-option{float:none;width:auto;margin:0}.ecl-left_airticket-filter-fill table{line-height:25px;width:100%}.ecl-left_airticket-filter-fill table td.label{width:55px}.ecl-left_airticket-filter-fill tr,.ecl-left_airticket-filter-fill td{vertical-align:top}.ecl-left_airticket-filter-fill p{float:none;width:524px;display:block}.ecl-left_airticket-option span{display:inline-block;white-space:nowrap;margin-right:16px}
.ecl-left_airticket-option span input{vertical-align:top;width:15px;height:15px;margin:3px 1px 0 0;*margin-top:2px;_margin-top:4px;float:left}.ecl-left_airticket-option span label{display:inline-block;vertical-align:top;*vertical-align:middle;font-family:tahoma;cursor:pointer;padding:0 1px 0 2px;*padding:0 2px;_padding-left:0;*margin-top:1px;height:20px;_width:auto;line-height:20px;color:#333;white-space:nowrap}.ecl-left_airticket-filter-trigger{position:absolute;width:62px;height:12px;right:20px;top:0;margin-top:5px;line-height:12px;cursor:pointer;color:#00c}
.ecl-left_airticket-filter-trigger b{display:inline-block;*display:inline;*zoom:1;vertical-align:top;width:10px;height:10px;margin-left:4px;overflow:hidden;background:url(http://s1.bdstatic.com/r/www/cache/biz/ecom/airticket/icon_sprites.gif) 0 0 no-repeat}.ecl-left_airticket-filter-trigger.ecl-left_airticket-expand b{background-position:-24px 0}.ecl-left_airticket-sug-main{position:absolute;zoom:1;left:-10000px;z-index:10;margin-left:-1px;margin-top:4px;width:160px}.ecl-left_airticket-sug-main ul{padding:2px;border:#d0d0d0 solid 1px;background:#fff;line-height:20px;color:#414141;cursor:pointer;font-size:12px}
.ecl-left_airticket-sug-current{background-color:#36c;color:#fff}.ecl-left_airticket-sug li{padding-right:10px;white-space:nowrap}.ecl-left_airticket-sug-append,.ecl-left_airticket-sug-prepend{display:none}.ecl-left_airticket-clearfix{zoom:1}.ecl-left_airticket-clearfix:after{clear:both;content:".";display:block;height:0;visibility:hidden}.ecl-left_airticket-flight-list-box *{font-size:12px}.ecl-left_airticket-flight-header{zoom:1;height:23px;border:1px solid #e2e2e2;border-bottom:0;background:#fff;position:relative}
.ecl-left_airticket-flight-header:after{clear:both;content:".";display:block;height:0;visibility:hidden}.ecl-left_airticket-flight-header h4{float:left;height:12px;line-height:12px;margin:5px 0;padding:0;border:0;display:inline;color:#666;vertical-align:middle;-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.ecl-left_airticket-flight-header .ecl-left_airticket-flight-header-info{width:150px;margin-left:48px}
.ecl-left_airticket-flight-header .ecl-left_airticket-flight-header-time{width:57px;text-align:center}.ecl-left_airticket-flight-header .ecl-left_airticket-flight-header-airport{width:167px;text-align:center}.ecl-left_airticket-flight-header .ecl-left_airticket-flight-header-lowest-offer{width:129px}.ecl-left_airticket-sortable{cursor:pointer;display:inline;zoom:1}.ecl-left_airticket-sortable span{float:left;margin-right:3px}.ecl-left_airticket-sortable i{float:left;display:inline;width:6px;height:12px;line-height:12px;background:url(http://s1.bdstatic.com/r/www/cache/biz/ecom/airticket/20130625a/list.gif) no-repeat transparent -31px -31px;zoom:1}
.ecl-left_airticket-asc i{background:url(http://s1.bdstatic.com/r/www/cache/biz/ecom/airticket/20130625a/list.gif) transparent no-repeat -15px -31px}.ecl-left_airticket-desc i{background:url(http://s1.bdstatic.com/r/www/cache/biz/ecom/airticket/20130625a/list.gif) transparent no-repeat 0 -31px}.ecl-left_airticket-flight-list{zoom:1;border-left:1px solid #ebebeb;border-right:1px solid #ebebeb;background:#fff;font-size:0}.ecl-left_airticket-flight-list:after{clear:both;content:".";display:block;height:0;visibility:hidden}
.ecl-left_airticket-flight-list li{float:left;width:100%;display:block;margin:0;padding:0;border:0;border-top:1px solid #eee;background:#fff;zoom:1;font-size:12px}.ecl-left_airticket-flight-list li.last{border-bottom:1px solid #eee}.ecl-left_airticket-flight-list li.hide{display:none}.ecl-left_airticket-flight-list button{float:right;display:inline;width:82px;height:24px;line-height:24px;margin:18px 8px 0 0;padding:0 18px 0 8px;border:0;cursor:pointer;box-sizing:border-box;text-align:center;text-decoration:none;color:#fff;background:url(http://s1.bdstatic.com/r/www/cache/biz/ecom/airticket/20130625a/list.gif) transparent no-repeat 0 -107px;vertical-align:middle}
.ecl-left_airticket-flight-list button.expanded{background-position:0 -70px}.ecl-left_airticket-flight-list button::-moz-focus-inner{border:0}.ecl-left_airticket-flight-direct-expanded{overflow:visible;zoom:1}.ecl-left_airticket-flight-direct-expanded .ecl-left_airticket-flight-info{border-bottom:1px solid #e1e7f0;height:80px;zoom:1;background-color:#e8f5ff}.ecl-left_airticket-flight-direct-expanded .ecl-left_airticket-flight-info-over{border-bottom:1px solid #e1e7f0;height:80px;background:#e8f5ff}.ecl-left_airticket-flight-direct-expanded .ecl-left_airticket-flight-extra{display:block;zoom:1}
.ecl-left_airticket-flight-direct-expanded .ecl-left_airticket-flight-order-list{zoom:1;display:block}.ecl-left_airticket-flight-direct-collapsed{height:60px;overflow:hidden}.ecl-left_airticket-flight-direct-collapsed .ecl-left_airticket-flight-info{border-bottom:0;height:60px}.ecl-left_airticket-flight-direct-collapsed .ecl-left_airticket-flight-basic{height:60px}.ecl-left_airticket-flight-direct-collapsed .ecl-left_airticket-flight-extra{display:none}.ecl-left_airticket-flight-direct-collapsed .ecl-left_airticket-flight-info-over{border-bottom:0;height:60px;background:#e8f5ff;border-color:#e1e7f0}
.ecl-left_airticket-flight-direct-collapsed .ecl-left_airticket-flight-order-list{zoom:1;display:none}.ecl-left_airticket-flight-info,.ecl-left_airticket-flight-info-over{overflow:hidden}.ecl-left_airticket-flight-basic{zoom:1}.ecl-left_airticket-flight-basic:after{clear:both;content:".";display:block;height:0;visibility:hidden}.ecl-left_airticket-flight-basic .ecl-left_airticket-flight-property-name,.ecl-left_airticket-flight-basic .ecl-left_airticket-flight-property-time,.ecl-left_airticket-flight-basic .ecl-left_airticket-flight-property-airport,.ecl-left_airticket-flight-basic .ecl-left_airticket-flight-property-lowest-offer{float:left;_display:inline;padding:15px 0 0 0;margin:0;height:33px}
.ecl-left_airticket-flight-basic h4{color:#000;line-height:12px}.ecl-left_airticket-flight-basic p{color:#888;line-height:12px;margin-top:6px}.ecl-left_airticket-flight-basic b{font-weight:bold;font-size:14px}.ecl-left_airticket-flight-basic img{position:absolute;top:20px;left:20px;width:16px;height:16px}.ecl-left_airticket-flight-basic .ecl-left_airticket-flight-property-name{width:150px;padding-left:48px;position:relative}.ecl-left_airticket-flight-basic .ecl-left_airticket-flight-property-name em{color:#00c;padding-left:1px}
.ecl-left_airticket-flight-basic .ecl-left_airticket-flight-property-name h4{color:#00c;cursor:pointer}.ecl-left_airticket-flight-basic .ecl-left_airticket-flight-property-time{width:32px;padding-left:8px;padding-right:17px}.ecl-left_airticket-flight-basic .ecl-left_airticket-flight-property-time p{position:relative}.ecl-left_airticket-flight-basic .ecl-left_airticket-flight-property-time em{position:absolute;display:block;background:url(http://s1.bdstatic.com/r/www/cache/biz/ecom/airticket/20130625a/list.gif) no-repeat transparent 0 -51px;color:#00c;right:-24px;_right:-7px;top:0;_top:2px;width:23px;height:11px;text-indent:-9999px;overflow:hidden}
.ecl-left_airticket-flight-basic .ecl-left_airticket-flight-property-airport{width:167px;text-align:center}.ecl-left_airticket-flight-basic .ecl-left_airticket-flight-property-lowest-offer{width:80px;text-align:center}.ecl-left_airticket-flight-basic .ecl-left_airticket-flight-property-lowest-offer h4{color:#ff6c00;vertical-align:top}.ecl-left_airticket-flight-basic .no-discount h4{padding-top:9px}.ecl-left_airticket-flight-basic .no-discount p{display:none}.ecl-left_airticket-flight-extra{zoom:1;padding-left:45px;margin:12px 0 8px 0;color:#888}
.ecl-left_airticket-flight-extra:after{clear:both;content:".";display:block;height:0;visibility:hidden}.ecl-left_airticket-flight-extra span{float:left;padding:0 10px;border-left:1px solid #888}.ecl-left_airticket-flight-extra span.first{border-left:0;padding-left:0}.ecl-left_airticket-flight-expandor{display:none;height:30px;line-height:30px;text-align:center;cursor:pointer;border:1px solid #eee;border-top:0;color:#666}.ecl-left_airticket-flight-expandor b{margin-left:4px;background:url(http://s1.bdstatic.com/r/www/cache/biz/ecom/airticket/icon_sprites.gif) -35px 1px no-repeat;padding:0 4px}
.has-more .ecl-left_airticket-flight-expandor{display:block}.has-more .ecl-left_airticket-flight-pager-box{display:none}.ecl-left_airticket-flight-pager-box{padding:15px 0 0;background:#fff;text-align:center}a.ecl-left_airticket-flight-pager-prev{padding-left:10px;background:url(http://s1.bdstatic.com/r/www/cache/biz/ecom/airticket/20130625a/list.gif) transparent no-repeat 3px 6px;*background-position:2px 4px}a.ecl-left_airticket-flight-pager-next{padding-right:10px;background:url(http://s1.bdstatic.com/r/www/cache/biz/ecom/airticket/20130625a/list.gif) transparent no-repeat 43px -12px;*background-position:43px -13px}
.ecl-left_airticket-flight-timeout-box,.ecl-left_airticket-flight-loading-box{text-align:center;color:#666;padding:50px 0 30px;border:1px solid #f5f5f5;border-top:0;background:url(http://s1.bdstatic.com/r/www/cache/biz/ecom/airticket/loading.gif) transparent no-repeat center 20px}.ecl-left_airticket-flight-empty-box{text-align:center;color:#666;padding:50px 0 30px;border:1px solid #f5f5f5;border-top:0;color:#000;font-weight:bold}.ecl-left_airticket-links{padding:7px 11px 0;line-height:16px;background:#fff}.ecl-left_airticket-links span{color:#a6a6a6;margin-right:16px}
.ecl-left_airticket-links a{padding-right:20px;text-decoration:underline;*font-family:'SimSun'}.ecl-left_airticket-links a img{margin-right:4px;vertical-align:text-bottom}.ecl-left_airticket-links a:hover{text-decoration:underline}.ecl-left_airticket-header-note{height:30px;line-height:30px;padding-left:10px;background:#fafafa;border-bottom:#EEE 1px solid}.ecl-left_airticket-header-step{height:30px;line-height:30px;padding-left:10px}.ecl-left_airticket-header-step .item-text{font-weight:bold}
.ecl-left_airticket-header-step .item-info{margin-left:24px}.ecl-left_airticket-detail{color:#666;font-size:12px}.ecl-left_airticket-detail a{text-decoration:none}.ecl-left_airticket-detail a:hover{text-decoration:underline}.ecl-left_airticket-header-all{height:26px;line-height:26px;padding-top:4px;padding-left:4px;border-bottom:#67a5eb 2px solid}.ecl-left_airticket-header-all a,.ecl-left_airticket-header-all a:hover{height:26px;line-height:26px;float:left;width:auto;padding:0 10px;margin-right:10px;text-align:center;color:#00E}
.ecl-left_airticket-header-all .item-text{background:#67a5eb;font-weight:bold;color:#FFF;text-shadow:1px 0 1px #666;-webkit-text-shadow:1px 0 1px #666;-moz-text-shadow:1px 0 1px #666}.ecl-left_airticket-header-all .item-text:hover{color:#FFF;text-decoration:none}.ecl-left_airticket-header-all .item-info{margin-left:10px;color:#666;font-weight:bold}.ecl-left_airticket-header-note{color:#888}.ecl-left_airticket-list-error{text-align:center;height:200px;line-height:200px;color:#5b9eea}.ecl-left_airticket-list{width:100%;border-top:#EEE 1px solid}
.ecl-left_airticket-list td{border-bottom:#EEE 1px solid;height:59px;vertical-align:middle}.ecl-left_airticket-list .item-last td{border-bottom:0}.ecl-left_airticket-list .column-site{color:#888}.ecl-left_airticket-list .column-icon,.ecl-left_airticket-list .column-price{width:110px}.ecl-left_airticket-list .column-change{width:100px}.ecl-left_airticket-list .column-order{width:57px}.ecl-left_airticket-list .column-site{padding-left:45px}.ecl-left_airticket-list .column-site span.ecl-left-airtick-list-official{padding-right:30px;background:url("http://s1.bdstatic.com/r/www/cache/biz/ecom/airticket/20130625a/detail.gif") right -117px transparent no-repeat;*background-position:right -118px}
.ecl-left_airticket-list .star-number{width:75px;padding-top:2px;float:left;margin-right:4px}.ecl-left_airticket-list .star-number-gray,.ecl-left_airticket-list .star-number-orange{width:64px;background:url("http://s1.bdstatic.com/r/www/cache/biz/ecom/airticket/20130625a/detail.gif") no-repeat -80px -60px;height:12px}.ecl-left_airticket-list .star-number-orange{background-position:-80px -80px}.ecl-left_airticket-list .site-link{color:#666}.ecl-left_airticket-list .site-icon{width:30px;height:40px;background:url("http://s1.bdstatic.com/r/www/cache/biz/ecom/airticket/20130625a/detail.gif") -124px 13px no-repeat;float:left}
.ecl-left_airticket-list .subject-label{display:block;height:28px;line-height:28px}.ecl-left_airticket-list .subject-text{margin-left:2px}.ecl-left_airticket-list .icon-assure,.ecl-left_airticket-list .icon-724{display:block;margin-top:2px;width:24px;height:24px;float:left;background:url("http://s1.bdstatic.com/r/www/cache/biz/ecom/airticket/20130625a/detail.gif") 0 -18px no-repeat}.ecl-left_airticket-list .icon-724{background-position:-24px -18px}.ecl-left_airticket-list .head-seat,.ecl-left_airticket-list .bus-seat{margin-top:2px;width:34px;height:12px;background:url("http://s1.bdstatic.com/r/www/cache/biz/ecom/airticket/20130625a/detail.gif") no-repeat;display:block}
.ecl-left_airticket-list .bus-seat{background-position:0 -100px}.ecl-left_airticket-list .price-text{color:#ff6c00;font:600 13px/13px arial}.ecl-left_airticket-list .afee-info{margin-left:4px}.ecl-left_airticket-list .price-info{color:#888}.ecl-left_airticket-list .order-btn{width:50px;height:24px;line-height:24px;text-align:center;color:#FFF;text-decoration:none;display:inline-block;background:#3da1fd url("http://s1.bdstatic.com/r/www/cache/biz/ecom/airticket/20130625a/detail.gif") 0 -50px no-repeat;*display:inline;*zoom:1}.ecl-left_airticket-list .order-btn:visited{color:#FFF}
.ecl-left_airticket-list .order-btn:hover{color:#FFF;text-decoration:none}.ecl-left_airticket-list .item-info-note{position:absolute;border:1px solid #BBB;background:#FFF;box-shadow:1px 1px 1px #ccc;-webkit-box-shadow:1px 1px 1px #ccc;-moz-box-shadow:1px 1px 1px #ccc;border-radius:1px;width:240px;margin-left:-40px;margin-top:26px;z-index:1}.ecl-left_airticket-list .note-arrow-top,.ecl-left_airticket-list .note-arrow-top-mark{position:absolute;width:0;height:0;font-size:0;border:transparent 8px solid;border-bottom-color:#BBB;_border-style:dashed;_border-bottom-style:solid;left:44px;top:-16px;_margin-top:-18px;z-index:2}
.ecl-left_airticket-list .note-arrow-top-mark{border-bottom-color:#FFF;top:-15px}.ecl-left_airticket-list .note-content{margin:10px}.ecl-left_airticket-list .tgq-change-wrapper,.ecl-left_airticket-list .tgq-change-wrapper-hover{color:#666;border-bottom:#666 1px dotted;cursor:pointer;width:auto;display:inline}.ecl-left_airticket-list .tgq-change-wrapper .item-info-note{display:none}.ecl-left_airticket-list .tgq-change-wrapper-hover .item-info-note{display:block}.ecl-left_airticket-list .tgq-loading{text-align:center;height:30px;line-height:30px}
.ecl-left_airticket-list .tgq-loading em{width:24px;height:24px;margin-right:2px;display:inline-block;*display:inline;*zoom:1;vertical-align:middle;background:url("http://s1.bdstatic.com/r/www/cache/biz/ecom/airticket/loading.gif") no-repeat}
</style>
{%*点击统计*%} 
{%$sessionid=$extData.sessionid%}
{%$subqid=$extData.subqid%}
{%$sid=$extData.sid%}
{%$pssid=$extData.pssid%}

<div class="ecl-left_airticket-main" data-click="{'vs_flight_sessionid':'{%$sessionid|escape:'html'%}','vs_flight_subqid':'{%$subqid|escape:'html'%}','vs_flight_sid':'{%$sid|escape:'html'%}'}">
<h2 class="ecl-left_airticket-title">
    <a target="_blank" href="{%$tplData.mainurl|escape:'html'%}">
        <em>{%$extData.originQuery|escape:'html'%}</em>的结果&nbsp;航协认证&nbsp;全网底价&nbsp;&nbsp;去哪儿网&nbsp;航空公司官网等提供
    </a>
</h2>

<div class="ecl-left_airticket-toparea" data-click="{fm:'beha'}">
    <div class="ecl-left_airticket-query">
        <form onsubmit="return false;">
            <div class="ecl-left_airticket-query-item">
                <h5>城市</h5>
                <div class="ecl-left_airticket-input ecl-left_airticket-fromcity">
                    <label>从</label>
                    <input class="OP_LOG_OTHERS" autocomplete="off" type="text" maxlength="100" value="{%$tplData.fromcity|escape:'html'%}" />
                    <b class="ecl-left_airticket-city-trigger OP_LOG_BTN"></b>
                    <div class="ecl-left_airticket-layer ecl-left_airticket-hide-layer"></div>
                </div>
                <span class="ecl-left_airticket-exchange OP_LOG_BTN" title="切换城市">换</span>
                <div class="ecl-left_airticket-input ecl-left_airticket-tocity">
                    <label>到</label>
                    <input class="OP_LOG_OTHERS" autocomplete="off" type="text" maxlength="100" value="{%$tplData.tocity|escape:'html'%}" />
                    <b class="ecl-left_airticket-city-trigger OP_LOG_BTN"></b>
                    <div class="ecl-left_airticket-layer ecl-left_airticket-hide-layer"></div>
                </div>
            </div>
            <div class="ecl-left_airticket-query-item">
                <h5>日期</h5>
                <div class="ecl-left_airticket-cal">
                    <input class="ecl-left_airticket-cal-trigger OP_LOG_OTHERS" type="text" readonly="readonly" />
                    <b class="ecl-left_airticket-cal-trigger OP_LOG_BTN"></b>
                </div>
            </div>
            <input type="submit" class="ecl-left_airticket-submit OP_LOG_BTN" value="快速查询" />
        </form>
    </div>
    <ul class="ecl-left_airticket-weekprice">
        {%for $i=0 to 5%}
        {%$weekprice=$tplData.weekprice[$i]%}
        <li data-date="{%$weekprice['date']|escape:'html'%}" class="OP_LOG_OTHERS">
            <p>{%$weekprice['date']|escape:'html'|regex_replace:"/^\d{4}-/":""%}&nbsp;{%$weekprice['weekday']|escape:'html'%}</p>
            <em>{%if $weekprice['price']%}¥{%$weekprice['price']|escape:'html'%}{%else%}查看{%/if%}</em>
        </li>
        {%/for%}
        <li class="ecl-left_airticket-price-calendar-tab OP_LOG_OTHERS">价格日历</li>
    </ul>
    <div class="ecl-left_airticket-ft-wrap">
        <div class="ecl-left_airticket-filter">
            <div class="ecl-left_airticket-option" data-filter-key="time">
                <strong>起飞时间:</strong>
                <p><span class="OP_LOG_OTHERS" title="6-12点"><input type="checkbox" value="1" /><label>上午</label></span><span class="OP_LOG_OTHERS" title="12-13点"><input type="checkbox" value="2" /><label>中午</label></span><span class="OP_LOG_OTHERS" title="13-18点"><input type="checkbox" value="3" /><label>下午</label></span><span class="OP_LOG_OTHERS" title="18点以后"><input type="checkbox" value="4" /><label>晚上</label></span></p>
            </div>
        </div>
        <div class="ecl-left_airticket-filter-fill ecl-left_airticket-filter-more ecl-left_airticket-hide">
            <div class="ecl-left_airticket-option" data-filter-key="size">
                <table border="0" cellspacing="0" cellpadding="0">
                    <tr class="label">
                        <td><strong class="short">航班机型:</strong></td>
                        <td>
                            <p><span class="OP_LOG_OTHERS"><input type="checkbox" value="1" /><label>大型机</label></span><span class="OP_LOG_OTHERS"><input type="checkbox" value="2" /><label>中型机</label></span><span class="OP_LOG_OTHERS"><input type="checkbox" value="3" /><label>小型机</label></span></p>
                        </td>
                    </tr>
                </table>
            </div>
        </div>
        <div class="ecl-left_airticket-filter-fill ecl-left_airticket-filter-more ecl-left_airticket-hide">
            {%$maxcount=count($tplData.cond_airport)%}
            <div class="ecl-left_airticket-option{%if $maxcount==0%} ecl-left_airticket-hide{%/if%}" data-filter-key="airport">
                <table border="0" cellspacing="0" cellpadding="0">
                    <tr>
                        <td class="label"><strong>起降机场:</strong></td>
                        <td><p>
                            {%foreach from=$tplData.cond_airport item=airport%}<span class="OP_LOG_OTHERS"><input type="checkbox" value="{%$airport['value']|escape:'html'%}" /><label>{%$airport['name']|escape:'html'%}</label></span>{%/foreach%}
                        </p></td>
                    </tr>
                </table>
            </div>
        </div>
        <div class="ecl-left_airticket-filter-fill ecl-left_airticket-filter-more ecl-left_airticket-hide">
            {%$maxcount=count($tplData.cond_airline)%}
            <div class="ecl-left_airticket-option{%if $maxcount==0%} ecl-left_airticket-hide{%/if%}" data-filter-key="airline">
                <table border="0" cellspacing="0" cellpadding="0">
                    <tr>
                        <td class="label"><strong>航空公司:</strong></td>
                        <td>
                            <p>
                                {%foreach from=$tplData.cond_airline item=airline%}<span class="OP_LOG_OTHERS"><input type="checkbox" value="{%$airline['value']|escape:'html'%}" /><label>{%$airline['name']|escape:'html'%}</label></span>{%/foreach%}
                            </p>
                        </td>
                    </tr>
                </table>
            </div>
        </div>
        <div class="ecl-left_airticket-filter-trigger OP_LOG_BTN">更多筛选<b></b></div>
    </div>
</div>



{%$flightCount = count($tplData.flight)%}
<div class="ecl-left_airticket-flight-list-box {%if $tplData.count>5%}has-more{%/if%}">

    <div class="ecl-left_airticket-flight-header" data-click="{fm:'beha'}">
        <h4 class="ecl-left_airticket-flight-header-info">航班信息</h4>
        <h4 class="ecl-left_airticket-flight-header-time ecl-left_airticket-sortable ecl-left_airticket-normal OP_LOG_OTHERS"><span>起降时间</span><i></i></h4>
        <h4 class="ecl-left_airticket-flight-header-airport">起降机场</h4>
        <h4 class="ecl-left_airticket-flight-header-lowest-offer ecl-left_airticket-sortable ecl-left_airticket-asc OP_LOG_OTHERS" title="按价格从低到高排序"><span>报价(不含税费)</span><i></i></h4>
    </div>

    <ul class="ecl-left_airticket-flight-list">
        {%foreach from=$tplData.flight key=index item=flight%}
        <li class="ecl-left_airticket-flight-direct-collapsed {%if $flightCount<=5 and $index==$flightCount-1 or $flightCount>5 and $index==4%}last{%/if%} {%if $index>=5%}hide{%/if%}" data-code="{%$flight.trip[0].flightCode|escape:'html'%}" data-aac="{%$flight.trip[0].arriveAirportCode|escape:'html'%}" data-dac="{%$flight.trip[0].departAirportCode|escape:'html'%}" data-index="{%$index%}">
            <div class="ecl-left_airticket-flight-info" onmouseover="this.className='ecl-left_airticket-flight-info-over'" onmouseout="this.className='ecl-left_airticket-flight-info'">
                <div class="ecl-left_airticket-flight-basic">
                    <div class="ecl-left_airticket-flight-property-name">
                        <img src="{%$flight.trip[0].logo|escape:'html'%}" />
                        <h4 class="ecl-left_airticket-flight-name-toggler OP_LOG_BTN">{%$flight.trip[0].carrierName|escape:'html'%}{%$flight.trip[0].code|escape:'html'%}</h4>
                        <p>
                            {%$flight.trip[0].planeName|escape:'html'%}
                            {%if !empty($flight.trip[0].sp)%}
                            <em title="该航班是经停航班" class="ecl-left_airticket-flight-stopby">经停</em>
                            {%/if%}
                            {%if !empty($flight.trip[0].actCode) && !empty($flight.trip[0].actCarrierZh) %}
                            <em title="实际乘坐航班：{%$flight.trip[0].actCarrierZh|escape:'html'%}{%$flight.trip[0].actCode|escape:'html'%}" class="ecl-left_airticket-flight-share">共享</em>
                            {%/if%}
                        </p>
                    </div>
                    <div class="ecl-left_airticket-flight-property-time">
                        <h4>{%$flight.trip[0].departTime|escape:'html'%}</h4>
                        <p>{%$flight.trip[0].arriveTime|escape:'html'%}{%if $flight.trip[0].arriveTime|replace:':':'' < $flight.trip[0].departTime|replace:':':''|escape:'html'%}<em></em>{%/if%}</p>
                    </div>
                    <div class="ecl-left_airticket-flight-property-airport">
                        <h4>{%$flight.trip[0].departAirportName|escape:'html'%}{%$flight.trip[0].departTerminal|escape:'html'%}</h4>
                        <p>{%$flight.trip[0].arriveAirportName|escape:'html'%}{%if !empty($flight.trip[0].arriveTerminal)%}{%$flight.trip[0].arriveTerminal|escape:'html'%}{%/if%}</p>
                    </div>
                    <div class="ecl-left_airticket-flight-property-lowest-offer {%if $flight.lowestDiscount>=10%}no-discount{%/if%}">
                        <h4>¥ <b>{%$flight.lowestPrice|escape:'html'%}</b>起</h4>
                        <p>{%$flight.lowestDiscount|escape:'html'%}折</p>
                    </div>
                    <button type="button" class="ecl-left_airticket-flight-toggler OP_LOG_BTN" data-click="{'fm':'beha','flightCode':'{%$flight.trip[0].flightCode|escape:'html'%}'}" onmouseover="T.addClass(this,'over');"   onmouseout="T.removeClass(this, 'over active')">查看报价</button>
                </div>
                <div class="ecl-left_airticket-flight-extra">
                    {%if !empty($flight.trip[0].fdt)%}
                    <span class="first">飞行{%$flight.trip[0].fdt|escape:'html'%}</span>
                    {%/if%}
                    {%if !empty($flight.trip[0].acf) && !empty($flight.trip[0].fot)%}
                    <span {%if !empty($flight.trip[0].fdt)%}class="first"{%/if%}>机建/燃油：¥{%$flight.trip[0].acf|escape:'html'%}&nbsp;/&nbsp;¥{%$flight.trip[0].fot|escape:'html'%}</span>
                    {%/if%}
                    <span {%if empty($flight.trip[0].fdt) && (empty($flight.trip[0].acf) || empty($flight.trip[0].fot))%}class="first"{%/if%}>
                        {%if !empty($flight.trip[0].meal)%}有餐食{%else%}无餐食{%/if%}
                    </span>
                    {%if !empty($flight.trip[0].zj)%}
                    <span>有网上值机</span>
                    {%/if%}
                </div>
            </div>
            <div class="ecl-left_airticket-flight-order-list"></div>
        </li>
        {%/foreach%}
    </ul>
    
    <div class="ecl-left_airticket-flight-expandor OP_LOG_BTN" data-click="{'fm':'beha'}">点击展开更多航班<b>&nbsp;&nbsp;</b></div>
    
    <div class="ecl-left_airticket-flight-pager-box" style="display:none" data-click="{'fm':'beha'}">
        <div class="ecl-left_airticket-flight-pager"></div>
    </div>

    

</div>

<div class="ecl-left_airticket-flight-empty-box" style="display:none">
    没有查询到可售航班，请您修改查询条件后再试
</div>

<div class="ecl-left_airticket-flight-timeout-box" style="display:none">
    您的前一次搜索已经过去了10分钟，<br>正在为您重新搜索以提供更准确报价
</div>

<div class="ecl-left_airticket-flight-loading-box" style="display:none">
    您查询的结果正在实时搜索中...
</div>

{%if count($tplData.agencyLinks)>0%}
<p class="ecl-left_airticket-links">
    <span>机票预订直达:</span>{%foreach $tplData.agencyLinks as $link%}<a target="_blank" href="{%$link['url']|escape:'html'%}"><img width="16" height="16" src="{%$link['logo']|escape:'html'%}" />{%$link['name']|escape:'html'%}</a>{%/foreach%}
</p>
{%/if%}
</div>

<script data-compress="off">
A.setup('AIRTICKET_LEFT', {
    'FROM_CITY': '{%$tplData.fromcity|escape:'html'%}',
    'TO_CITY': '{%$tplData.tocity|escape:'html'%}',
    'URL_QUERY': '/ecomui/flight?controller=SingleLine&action=flightList',
    'URL_AGENCY': '/ecomui/flight?controller=SingleLine&action=vendorList',
    'URL_TGQ': '/ecomui/flight?controller=Tgq&action=getTgq',
    'URL_CITY': '/ecomui/flight?controller=CitySuggest&action=tip',
    'URL_CALENDAR': '/ecomui/flight?controller=SingleLine&action=calendarprice',
    'ORIGIN_QUERY': '{%$extData.originQuery|escape:'html'%}',
    'SESSION_ID': '{%$sessionid|escape:"javascript"%}',
    'STATS_SUBQID': '{%$subqid|escape:"javascript"%}',
    'STATS_SID': '{%$sid|escape:"javascript"%}',
    'STATS_PSSID': '{%$pssid|escape:"javascript"%}'
});
A.setup('AT_LIST_DATA', {
    total: {%$tplData.count|default:0%},
    totalPage: {%$tplData.totalPage|default:0%}
});
</script>
<script type="text/javascript">
A.init( function() {
    var T = A.baidu;
    var card = this;
    var at = {};
    require.config({
        paths : {
             'ecom/ui': 'http://s1.bdstatic.com/r/www/cache/biz/ecom/airticket/20130625a'
         }
    });
    var TPLDATA=card.data.AIRTICKET_LEFT,common=function(){function e(e){return e=common.getClass(e),card.qq(e)}function t(e,t){return e?e.getElementsByTagName(t):[]}function n(e){return e.replace(/-/g,"")}function r(e){return e=(""+e).match(/^(\d+)(\d\d)(\d\d)/),e.shift(),new Date(e[0],e[1]-1,e[2])}function a(e){return r(n(e))}function o(){this.events={}}function i(e,t){var n={};for(var r in e)n["vs_flight_"+r]=e[r];var a=T.json.stringify(n).replace(/"/g,"'");return t?a:'data-click="'+a+'"'}var c={},u="ecl-left_airticket";
c.getClass=function(e){return e=e||"",u+"-"+e};var s=[];return c.addIniter=function(e){s.push(e)},c.init=function(){for(var e=0,t=s.length;t>e;e++){var n=s[e];"function"==typeof n&&n()}},c.queryByClass=e,c.getInput=function(n){return t(e(n),"input")[0]},c.prev=function(e){for(e=e.previousSibling;e;){if(1==e.nodeType)return e;e=e.previousSibling}return e},c.last=function(e){for(var e=e.lastChild;e;){if(1==e.nodeType)return e;e=e.previousSibling}return e},c.queryTags=t,c.request=function(e,t,n){t=t||Function(),n=n||Function(),T.ajax.request(e,{timeout:A.AJAX.TIMEOUT,ontimeout:function(){var e={status:-1,statusInfo:"timeout"};
n(xhr.status,e)},onsuccess:function(e,r){try{var a=T.json.parse(r)}catch(o){var a={status:500,statusInfo:"error"}}if(a.status)return n(a.status,a),void 0;var i=a.data;t(i,a)},onfailure:function(e){var t={status:e.status,statusInfo:e.statusText};n(e.status,t)}})},c.now="undefined"==typeof bdServerTime?new Date:new Date(1e3*bdServerTime),c.afterDays=function(e,t){return new Date(e.getTime()+1e3*60*60*24*t)},c.end=c.afterDays(c.now,211),c.removeStrike=n,c.number2Date=r,c.str2Date=a,c.date2HumanStyle=function(e){return common.formatDate(e,"yyyy-MM-dd")+"("+"周"+"日一二三四五六".charAt(e.getDay())+")"
},c.formatDate=function(e,t){function n(e,n){t=t.replace(e,n)}function r(e,t){var n="",r=0>e,a=Math.abs(e)+"";return t>a.length&&(n=Array(t-a.length+1).join("0")),(r?"-":"")+n+a}if("string"!=typeof t)return""+e;var a=e.getFullYear(),o=e.getMonth()+1,i=e.getDate(),c=e.getHours(),u=e.getMinutes(),s=e.getSeconds();return n(/yyyy/g,r(a,4)),n(/yy/g,r(parseInt((""+a).slice(2),10),2)),n(/MM/g,r(o,2)),n(/M/g,o),n(/dd/g,r(i,2)),n(/d/g,i),n(/HH/g,r(c,2)),n(/H/g,c),n(/hh/g,r(c%12,2)),n(/h/g,c%12),n(/mm/g,r(u,2)),n(/m/g,u),n(/ss/g,r(s,2)),n(/s/g,s),t
},c.showLayer=function(e,t,n){var r=t.offsetHeight,a=T.dom.getPosition(t),o={};o.top=a.top+r,6==T.browser.ie&&(e.style.left="-10000px",o.top-=5);var i=t.offsetWidth;n&&"left"!=n?"right"==n&&(o.left=a.left+i-e.offsetWidth):o.left=a.left,e.style.left=o.left+"px",e.style.top=o.top+"px",T.removeClass(e,c.getClass("hide-layer"))},c.hideLayer=function(e){T.addClass(e,c.getClass("hide-layer")),e.style.left="-10000px"},c.toggleLayer=function(e,t,n){var r="hideLayer";T.dom.hasClass(e,c.getClass("hide-layer"))&&(r="showLayer"),c[r](e,t,n)
},o.prototype={constructor:o,on:function(e,t){this.events[e]instanceof Array||(this.events[e]=[]),this.events[e].push(t)},un:function(e,t){for(var n=this.events[e],r=n instanceof Array&&n.length;r--;)n[r]===t&&n.splice(r,1)},fire:function(e,t){var n=this.events[e],r=this;n instanceof Array&&T.each(n,function(e){"function"==typeof e&&e.call(r,t)})}},c.Observable=o,c.getStatsAttr=i,c}();at.timer=function(){function e(){n=(new Date).getTime()}function t(){var e=(new Date).getTime();return e-n>a?(at.query.fire("query",at.query.get()),at.list.setState("timeout"),!1):!0
}var n,r={},a=6e5;return common.addIniter(function(){n=(new Date).getTime()}),r.update=e,r.judge=t,r}(),at.query=function(){function e(e){var n,r=common.getInput(e);T.event.on(r,"keydown",function(){C&&C.hide()}),T.event.on(r,"focus",function(){var e=this;n||setTimeout(function(){e.select()},1),n=1}),T.event.on(r,"blur",function(){n=0}),T.event.on(T.dom.next(r),"click",function(){common.prev(this).select()}),t(e),r=null}function t(e){function t(t){var r,a=this;return A[e]==t&&(a.hide(),l(e),r=1),("fromcity"==e&&t==v||"tocity"==e&&t==p)&&(a.hide(),l(e),S[e]={value:t,data:{enable:1}},r=1),r?!1:(k[e]++,n(t,function(n){k[e]--,n.length?(a.show(t,n),S[e]=n[0],l(e)):a.hide()
}),void 0)}require(["ecom/ui/suggestion"],function(n){var r=D(e),a=new n({skin:L("sug"),getData:t,onpick:function(t){var n=t.data.item||{};n.data&&(S[e]=n),A[e]=n.value},onhide:function(){s(e)}});a.render(r),r=null})}function n(e,t){t=t||Function();var n=TPLDATA.URL_CITY;n+=(n.indexOf("?")>-1?"&":"?")+"city=#{0}&t=#{1}",n=T.format(n,encodeURIComponent(e),(new Date).getTime());var a=[];common.request(n,function(n){n.length&&T.each(n,function(t){var n=RegExp("("+e+")","i"),o=t.s.split("|"),i=(o[0]+"("+o[1]+")").replace(n,'<span class="'+L("highlight")+'">$1</span>');
a.push({content:i,value:r(t),data:t})}),t(a)},function(){t([])})}function r(e){var t=e.s.split("|")[0],n=/\((\S+)\)/,r=t.match(n);return r?r[1]:t}function a(){require(["ecom/ui/City"],function(e){C=new e({prefix:L("ui-city"),triggers:L("city-trigger"),offset:{y:2,x:-21},onBeforeShow:function(e){var t=e.event,n=T.event.getTarget(t);this.setTarget("INPUT"==n.tagName&&"text"==n.type?n:common.prev(n))},onPick:function(e){var t=this.target,n=e.value,r="fromcity";t==D(r)?v=n:(p=n,r="tocity"),S[r]={value:n,data:{enable:1}},t.blur()
}}),C.render()})}function o(){var e="fromcity",t="tocity",n=D(e),r=D(t);A[e]=r.value,A[t]=n.value;var a;a=S[e],S[e]=S[t],S[t]=a,n.value=A[e],r.value=A[t]}function i(){require(["ecom/ui/Calendar"],function(e){var t=card.q(L("cal-trigger")),n=D("cal"),r=new e({offset:{x:2},dateFormat:"yyyy-MM-dd(WW)",prefix:L("ui-cal"),first:1,lang:{days:"一,二,三,四,五,六,日"},target:n,triggers:t,value:h,range:{begin:common.now,end:I},onShow:function(){this.setValue(this.target.value)},onPick:function(e){h=e.date}});r.render()})}function c(){var e=x("submit");
T.on(e,"mouseover",function(){T.addClass(this,L("submit-hover"))}),T.on(e,"mouseout",function(){T.removeClass(this,L("submit-hover")),T.removeClass(this,L("submit-press"))}),T.on(e,"mousedown",function(e){0==e.button&&T.addClass(this,L("submit-press"))}),T.on(e,"mouseup",function(e){0==e.button&&T.removeClass(this,L("submit-press"))}),e=null}function u(){q&&clearTimeout(q),q=setTimeout(function(){var e=s("fromcity");e=s("tocity")&&e;var t=y();e&&t.tocity==t.fromcity&&(e=0,m("tocity","不能和出发城市相同"),D("tocity").select()),e&&(at.weekPrice.reset(g(h)),b.fire("query",y()))
},200)}function s(e){if(k[e])return!1;var t=D(e),n=t.value;if(!n)return m(e),!1;var r=S[e].value||null;if(r&&n!=r)return m(e),!1;if(r&&n==r){var a=S[e].data.enable;if(!a)return f(e),!1}return"fromcity"==e?v=n:p=n,!0}function f(e){m(e,"对不起，不支持该目的地")}function m(e,t){var n="请输入正确的"+("fromcity"==e?"出发城市":"到达城市");t&&(n=t);var r=d(e);r.innerHTML='<p class="'+L("error")+'">'+n+"</p>",common.showLayer(r,D(e))}function l(e){var t=T.q(L("layer"),common.queryByClass("query-item"));e?(t=d(e),common.hideLayer(t)):T.each(t,function(e){common.hideLayer(e)
})}function d(e){var t=D(e);return T.dom.next(T.dom.next(t))}function y(){var e=g(h),t=function(e){return common.formatDate(e,"yyyy-MM-dd")};return{fromcity:v,tocity:p,fromdate:t(h),dateRange:[t(e.begin),t(e.end)].join(",")}}function g(e){var t=w(e,-3),n=w(e,3);return common.now>t&&(t=common.now,n=w(t,6)),n>I&&(n=I,t=w(n,-6)),{begin:t,end:n}}var v,p,h,C,b=new common.Observable,w=common.afterDays,D=common.getInput;common.addIniter(function(){h=w(common.now,2),v=TPLDATA.FROM_CITY,p=TPLDATA.TO_CITY,S={fromcity:{value:v,data:{enable:1}},tocity:{value:p,data:{enable:1}}},e("fromcity"),e("tocity"),common.queryByClass("exchange").onclick=o,a();
var t=D("cal");t.value=common.date2HumanStyle(h),T.browser.ie&&(t.onselectstart=function(){return!1}),t.onfocus=function(){this.blur()},i(),c();var n=common.queryTags(common.queryByClass("query"),"form")[0];T.on(n,"submit",function(){u()}),T.on(document,"click",function(e){var t=T.event.getTarget(e),n=t.id&&~t.id.indexOf("tangram-suggestion"),r=d("fromcity"),a=d("tocity");n||t.parentNode==r||l("fromcity"),n||t.parentNode==a||l("tocity")})});var q,A={fromcity:v,tocity:p},k={fromcity:0,tocity:0},S={fromcity:{},tocity:{}},L=common.getClass,x=common.queryByClass,I=w(common.now,211);
return b.on("update",function(e){h=e;var t=D("cal");t.value=common.date2HumanStyle(h),b.fire("query",y())}),b.get=y,b.getDateRange=function(){return g(h)},b}(),at.weekPrice=function(){function e(){var e=common.queryByClass("weekprice");n(common.afterDays(common.now,2)),T.event.on(e,"click",function(e){var t=T.event.getTarget(e);if(("EM"==t.tagName||"P"==t.tagName)&&(t=t.parentNode),"LI"==t.tagName){var r=t.getAttribute("data-date");if(r)return r=common.str2Date(r),n(r),at.query.fire("update",r),void 0}}),require(["ecom/ui/Calendar"],function(n){l=new n({dateFormat:"yyyy-MM-dd(WW)",prefix:common.getClass("price-calendar"),date:common.now,first:1,lang:{days:"一,二,三,四,五,六,日"},target:common.getInput("cal"),liveTriggers:e,triggers:"ecl-left_airticket-price-calendar-tab",value:m,range:{begin:common.now,end:common.end},monthes:1,offset:{x:T.browser.ie>6?-93:T.browser.ie?-97:-89,y:!T.browser.ie||T.browser.ie>6?62:63},onBeforeShow:function(){T.addClass(common.queryByClass("price-calendar-tab"),common.getClass("price-calendar-tab-expanded"))
},onHide:function(){T.removeClass(common.queryByClass("price-calendar-tab"),common.getClass("price-calendar-tab-expanded"))},onPick:function(e){at.query.fire("update",e.date)},process:function(e,t,n){var r="ecl-left_airticket-price-calendar-disabled",a=y&&y[n]?"¥"+y[n]:"查看",o=0|n.slice(8);T.setAttr(e,"data-price",a),e.innerHTML=T.array.indexOf(t,r)>-1?o+"<br>--":o+"<b>"+a+"</b>"}}),l.render(),t()})}function t(){var e=TPLDATA.URL_CALENDAR,t=at.query.get();if(!y||y.from!==t.fromcity||y.tocity!==t.tocity){var n=at.flightData.getStatsData(),r={fromcity:t.fromcity,tocity:t.tocity};
T.extend(r,n);for(var a in r)e+=(-1===e.indexOf("?")?"?":"&")+a+"="+encodeURIComponent(r[a]);y={},l&&l.updateStatus(),common.request(e,function(e){y=e,y.fromcity=t.fromcity,y.tocity=t.tocity,l&&l.updateStatus()},function(){})}}function n(e){var t;r(function(n){t=n.getAttribute("data-date"),T.removeClass(n,common.getClass("cur")),t&&common.formatDate(e,"yyyy-MM-dd")==t&&T.addClass(n,common.getClass("cur"))}),m=e}function r(e){T.each(common.queryTags(common.queryByClass("weekprice"),"li"),e||Function())}function a(e){if(e&&e instanceof Array!=!1){var t=[];
common.formatDate(common.end,"yyyy-MM-dd")===e[e.length-1].date&&e.shift();for(var n,r=0;6>r;r++)n=e[r],n.shortdate=n.date.replace(/^\d{4}-/,""),n.price=n.price?"¥"+n.price:"查看",t[r]=T.format(g,n);t[6]=v,common.queryByClass("weekprice").innerHTML=t.join(""),o(e)}}function o(e){for(var t,n=0;t=e[n];n++)y[t.date]="string"==typeof t.price&&-1!==t.price.indexOf("¥")?t.price.slice(1):t.price;l&&l.updateStatus()}function i(e,n){if(e){for(var r=[],o=0;6>o;o++){var i=common.formatDate(common.afterDays(e.begin,o),"yyyy-MM-dd");
r[o]={date:i,shortdate:i.replace(/^\d{4}-/,""),price:n?"查看":" "}}a(r),t()}}function c(e){var t=T.dom.hasClass;if(0==e instanceof Array)return!1;for(var n=0,a=e.length;a>n;n++)r(function(r){if(!t(r,common.getClass("price-calendar-tab"))&&!t(r,common.getClass("price-calendar-tab-expanded"))&&T.getAttr(r,"data-date")==e[n].date){var a=e[n].price?"¥"+e[n].price:"查看";common.queryTags(r,"em")[0].innerHTML=a}});o(e)}function u(){T.removeClass(common.queryByClass("weekprice"),common.getClass("hide"))}function s(){T.addClass(common.queryByClass("weekprice"),common.getClass("hide"))
}function f(){var e={};return r(function(t){var n=t.getAttribute("data-date");if(n&&common.formatDate(m,"yyyy-MM-dd")==n){e.date=n;var r=common.queryTags(t,"em")[0].innerHTML;return r=r.match(/\d+/),r=r?r[0]:"",e.price=r,e}}),e}var m,l,d=new common.Observable,y={};common.addIniter(function(){e()});var g='<li data-date="#{date}" class="OP_LOG_OTHERS"><p>#{shortdate}&nbsp;#{weekday}</p><em>#{price}</em></li>',v='<li class="ecl-left_airticket-price-calendar-tab OP_LOG_OTHERS">价格日历</li>';return d.update=c,d.render=a,d.set=n,d.get=f,d.reset=i,d.show=u,d.hide=s,d
}(),at.filter=function(){function e(){function e(){T.each(o,function(e){T.addClass(e,a)})}function t(){T.each(o,function(e){T.removeClass(e,a)})}var n=common.queryByClass("filter-trigger"),r=d("expand");T.event.on(n,"click",function(){var n=this;T.dom.hasClass(n,r)?(n.innerHTML=y,T.removeClass(n,r),e()):(n.innerHTML=g,T.addClass(n,r),t()),0==at.flightData.getTimes()&&at.query.fire("query",at.flightData.getLastQuery())});var a=d("hide"),o=card.q(d("filter-more"));n=null}function t(e){T.event.on(e,"click",function(e){var t,n=T.event.getTarget(e);
switch(n.tagName){case"LABEL":var r=common.prev(n);r.checked=!r.checked,t=1;break;case"INPUT":t=1}t&&(o(this),l.fire("change",a()))}),e=null}function n(e){T.each(card.q(d("option")),e||Function())}function r(){var e={};return n(function(t){var n=t.getAttribute("data-filter-key");e[n]=o(t)}),e}function a(){var e=r(),t={};for(var n in e)t["cond_"+n]=e[n].join(",");return t}function o(e){var t=[];return T.each(common.queryTags(e,"input"),function(e){"checkbox"==e.type&&e.checked&&t.push(e.value)}),t}function i(e){var t=!1;
return T.each(e.getElementsByTagName("input"),function(e){"checkbox"==e.type&&(t=t||e.checked,e.checked=!1)}),t}function c(e){n(function(t){var n=t.getAttribute("data-filter-key"),r=e[n];r&&u(t,r)})}function u(e,t){var n=common.queryTags(e,"p")[0];n.innerHTML="";var r="addClass";if(t.length){r="removeClass";for(var a,o=[],i=0;a=t[i];)o[i++]=T.format(v,a);n.innerHTML=o.join("")}T[r](e,d("hide"))}function s(){n(function(e){i(e)})}function f(){common.queryByClass("ft-wrap"),T.addClass(common.queryByClass("ft-wrap"),common.getClass("hide"))
}function m(){common.queryByClass("ft-wrap"),T.removeClass(common.queryByClass("ft-wrap"),common.getClass("hide"))}var l=new common.Observable;common.addIniter(function(){e(),n(function(e){t(e)})});var d=common.getClass,y="更多筛选<b></b>",g="收起筛选<b></b>",v='<span class="OP_LOG_OTHERS"><input type="checkbox" value="#{value}" /><label>#{name}</label></span>';return l.reset=s,l.render=c,l.get=r,l.show=m,l.hide=f,l.getBizData=a,l}(),at.flightData=function(){function e(){return i}function t(e,t){n(e),e.sessionID=TPLDATA.SESSION_ID,e.originQuery=TPLDATA.ORIGIN_QUERY,e.pssid=TPLDATA.STATS_PSSID,e.t=(new Date).getTime();
var r=TPLDATA.URL_QUERY;r+=(r.indexOf("?")>-1?"&":"?")+T.url.jsonToQuery(e,function(e){return/[^\x00-\xFF]/.test(e)?encodeURIComponent(e):e}),common.request(r,function(e){i=1,o=T.extend(o,e.stats||{}),o.page=e.page,T.dom.setAttr(common.queryByClass("main"),"data-click",common.getStatsAttr(o,!0)),t("",e)},function(e){t("error",e)})}function n(e){for(var t in c)null!=e[t]&&(c[t]=e[t])}function r(e,t){c=e;var n=T.extend({},e);return T.each(t,function(e){n=T.extend(n,e)}),n}var a={},o={};a.getStatsData=function(e){var t=T.extend({},o);
return e&&"object"==typeof e&&(t=T.extend(t,e)),t};var i=0,c={};return a.getLastQuery=function(){var e=T.extend({},c);return e},common.addIniter(function(){o={sessionID:TPLDATA.SESSION_ID,subqId:TPLDATA.STATS_SUBQID,sid:TPLDATA.STATS_SID,originQuery:TPLDATA.ORIGIN_QUERY},c=T.extend({},at.query.get())}),a.request=t,a.merge=r,a.getTimes=e,a}(),at.query.on("query",function(e){var t=common.str2Date(e.fromdate);at.timer.update(),at.list.setState("loading"),at.list.reset(),at.filter.hide(),at.weekPrice.hide(),at.flightData.request(e,function(e,n){n.weekprice&&7==n.weekprice.length?(at.weekPrice.render(n.weekprice),at.weekPrice.set(t)):at.weekPrice.reset(at.query.getDateRange(),1),at.weekPrice.show(),n.count&&(at.filter.reset(),at.filter.render({airline:n.cond_airline||[],airport:n.cond_airport||[]}),at.filter.show()),e?at.list.setState("empty"):at.list.render(n)
})});var timerFilterChange;at.filter.on("change",function(e){timerFilterChange&&clearTimeout(timerFilterChange);var t=at.flightData.getLastQuery(),n=at.list.getData(),r=at.flightData.merge(t,[e,n]);r.page=0,r.bycondition=1;var a=at.flightData.getTimes();0==a&&(at.list.setState("loading"),r.bycondition=0),timerFilterChange=setTimeout(function(){at.flightData.request(r,function(e,t){e?at.list.setState("empty"):(at.list.render(t),t.weekprice&&at.weekPrice.update(t.weekprice)),0==a&&t.cond_airport&&t.cond_airline&&at.filter.render({airline:t.cond_airline||[],airport:t.cond_airport||[]})
})},300)}),card.ready(function(){common.init()});
    at.list=function(){function t(){T.on(E,"click",function(t){var e=T.event.getTarget(t||window.event);(h(e,"ecl-left_airticket-flight-toggler")||h(e,"ecl-left_airticket-flight-name-toggler"))&&i(e)})}function e(t){return"expanded"==T.getAttr(t,"data-expanded")?!0:!1}function a(t,e){var i=T.dom.getPosition(t).top-T.page.getScrollTop();t.className=t.className.replace(/expanded|collapsed/g,e?"expanded":"collapsed"),T.setAttr(t,"data-expanded",e?"expanded":"collapsed");var r=t.getElementsByTagName("button")[0];r.innerHTML=e?"收起报价":"查看报价",_(r,"expanded"),e?(b&&b!==t&&a(b,0),b=t,setTimeout(function(){window.scroll(0,T.dom.getPosition(t).top-i)
},5)):b=null}function i(t){if(at.timer.judge()){do if("li"==t.nodeName.toLowerCase())break;while((t=t.parentNode)&&1==t.nodeType);if(e(t))return a(t,0),void 0;var i=T.getAttr(t,"data-index");if(I[i])return a(t,1),void 0;var n=C({},A,at.flightData.getLastQuery(),{flightcode:T.getAttr(t,"data-code"),deptAirportkey:T.getAttr(t,"data-dac"),arriAirportkey:T.getAttr(t,"data-aac")});require(["flyticket_agency"],function(e){e.QUERY_URL=TPLDATA.URL_AGENCY+(-1==TPLDATA.URL_AGENCY.indexOf("?")?"?":"&")+T.url.jsonToQuery(at.flightData.getStatsData()),e.QUERY_TGQ_URL=TPLDATA.URL_TGQ+(-1==TPLDATA.URL_TGQ.indexOf("?")?"?":"&")+T.url.jsonToQuery(at.flightData.getStatsData());
var o=T.Q("ecl-left_airticket-flight-order-list",t)[0],c=new e(o,n);I[i]=c,a(t,1),c.render(),c.onOrder=function(){return at.timer.judge()},c.onLoad=function(e){var a=e.realLowestPrice,i=e.realLowestDiscount,n=T.Q("ecl-left_airticket-flight-property-lowest-offer",t)[0],o=n.getElementsByTagName("b")[0],c=n.getElementsByTagName("p")[0];i>=10?T.addClass(n,"no-discount"):T.removeClass(n,"no-discount"),c.innerHTML=i+"折",o.innerHTML!=a&&(o.innerHTML=a,p(a)),r()}})}}function r(t){F&&(k.totalPage>1?o(k.totalPage,0):c(),T.removeClass(D,"has-more"),w=1,T.each(E.getElementsByTagName("li"),function(t){T.removeClass(t,"hide")
}),t&&0==at.flightData.getTimes()&&at.filter.fire("change",at.filter.getBizData()),F.onclick=null,F.parentNode.removeChild(F),F=null,n())}function n(){for(var t=-1,e=E.getElementsByTagName("li"),a=e.length-1;a>=0;a--)!h(e[a],"hide")&&a>t&&(t=a),T.removeClass(e[a],"last");T.addClass(e[t],"last")}function o(t,e){return M?(void 0!==t&&void 0!==e&&(M.total=t-0,M.page=e-0,M.render()),N.style.display="block",void 0):(require(["ecom/ui/Pager"],function(a){M=new a({main:T.Q("ecl-left_airticket-flight-pager")[0],page:1,total:t,prefix:common.getClass("flight-pager"),lang:{prev:"上一页",next:"下一页"}}),M.on("change",function(t){if(at.timer.judge()){var e=C({},v,{page:t.page});
window.scroll(0,T.dom.getPosition(D).top||0),y(e)}}),void 0!==t&&void 0!==e&&(M.total=t-0,M.page=e-0,M.render()),N.style.display="block"}),void 0)}function c(){N.style.display="none"}function s(t){var e,a=[];for(e=0;t.length>e;e++)t[e].index=e,a[e]=1==t[e].directFlag||t[e].unionSpecial?l(t[e]):f(t[e]);E.innerHTML=a.join(""),!w&&t.length>5&&(T.each(E.getElementsByTagName("li"),function(t,e){e>=5&&T.addClass(t,"hide")}),T.addClass(D,"has-more")),T.each(T.Q("ecl-left_airticket-flight-extra"),function(t){t.firstChild&&T.addClass(t.firstChild,"first")
}),n()}function l(t){var e=t.trip[0],a=T.format(at.list.FLIGHT_DIRECT_INFO_BASIC_TEMPLATE,{name:u(e),time:d(e),airport:T.format(at.list.FLIGHT_AIRPORT,e),price:m(t),toggler:T.format(at.list.FLIGHT_TOGGLER,t)}),i=T.format(at.list.FLIGHT_INFO_EXTRA,{fdt:e.fdt?T.format(at.list.FLIGHT_DT,e):"",tax:e.fdt&&e.fdt?T.format(at.list.FLIGHT_TAX,e):"",meal:T.format(at.list.FLIGHT_MEAL,{meal:e.meal?"有":"无"}),zj:e.zj?at.list.FLIGHT_ZJ:""});return T.format(at.list.FLIGHT_TEMPLATE,{basic:a,extra:i,type:"direct",index:t.index,flightCode:t.flightCode,aac:e.arriAirportkey,dac:e.deptAirportkey})
}function f(t){var e=t.trip[0],a=t.trip[1],i=T.format(at.list.FLIGHT_TRANSIT_INFO_BASIC_ITEM_TEMPLATE,{name:u(e),time:T.format(at.list.FLIGHT_TIME,e),airport:T.format(at.list.FLIGHT_AIRPORT,e)}),r=T.format(at.list.FLIGHT_TRANSIT_INFO_BASIC_ITEM_TEMPLATE,{name:u(a),time:T.format(at.list.FLIGHT_TIME,a),airport:T.format(at.list.FLIGHT_AIRPORT,a)}),n=T.format(at.list.FLIGHT_TRANSIT_INFO_BASIC_TEMPLATE,{first:i,second:r,transcity:t.transcity,price:m(t),toggler:at.list.FLIGHT_TOGGLER});return T.format(at.list.FLIGHT_TEMPLATE,{basic:n,extra:"",type:"transit",index:t.index,flightCode:t.flightCode})
}function u(t){return T.format(at.list.FLIGHT_NAME,{logo:t.logo,planeName:t.planeName,carrierName:t.carrierName,code:t.code,sp:t.sp?at.list.FLIGHT_STOPBY:"",share:t.actCarrierZh&&t.actCode?T.format(at.list.FLIGHT_SHARE,t):""})}function d(t){var e=t.arriveTime,a=t.departTime;return T.format(at.list.FLIGHT_TIME,{departTime:a,arriveTime:e,addday:e.replace(":","")<a.replace(":","")?"<em></em>":""})}function m(t){return T.format(at.list.FLIGHT_LOWEST_OFFER,{discount:t.lowestDiscount>=10?"no-discount":"",lowestPrice:t.lowestPrice,lowestDiscount:t.lowestDiscount})
}function g(){for(var t=0;I.length>t;t++)I[t]&&I[t].dispose(),I[t]=null;b=null}function p(t){var e=at.weekPrice.get();if(e.price>t)return at.weekPrice.update([{date:e.date,price:t}]),void 0;var a=0,i=at.filter.getBizData();for(var r in i)i[r]&&(a=1);if(!a&&(1==k.totalPage||"price"==v.orderBy&&("asc"==v.order&&0==v.page||"desc"==v.order&&v.page==k.totalPage-1))){var n=Number.MAX_VALUE;T.each(T.Q("ecl-left_airticket-flight-property-lowest-offer",E),function(t){var e=t.getElementsByTagName("b")[0],a=e.innerHTML-0;
n=a>=n?n:a}),at.weekPrice.update([{date:e.date,price:n}])}}function y(t){1!=G.__isLoading&&(t=C(at.flightData.getLastQuery(),at.filter.getBizData(),t,{byCondition:1}),G.__isLoading=1,at.flightData.request(t,function(t,e){return G.__isLoading=0,t?(R("empty"),void 0):(flightsData=e.flight,G.render(e),e.weekprice&&at.weekPrice.update(e.weekprice),void 0)}))}var v={order:"asc",orderBy:"price",page:0},h=T.dom.hasClass,_=function(t,e){h(t,e)?T.removeClass(t,e):T.addClass(t,e)},C=function(t){for(var e=Array.prototype.slice.call(arguments,1),a=0,i=e.length;i>a;a++)T.extend(t,e[a]);
return t},L=function(t,e){return card.qq(t,e)},k=card.data.AT_LIST_DATA,I=[],A={pssid:card.data.AIRTICKET_LEFT.STATS_PSSID,sessionID:card.data.AIRTICKET_LEFT.SESSION_ID,originQuery:card.data.AIRTICKET_LEFT.ORIGIN_QUERY},b=null,w=0,D=L("ecl-left_airticket-flight-list-box");L("ecl-left_airticket-flight-header");var E=L("ecl-left_airticket-flight-list"),x=L("ecl-left_airticket-flight-empty-box"),S=L("ecl-left_airticket-flight-loading-box"),P=L("ecl-left_airticket-flight-timeout-box"),F=L("ecl-left_airticket-flight-expandor"),H=L("ecl-left_airticket-flight-header-time"),q=L("ecl-left_airticket-flight-header-lowest-offer");
(function(){T.on(H,"click",function(){at.timer.judge()&&(T.removeClass(q,"ecl-left_airticket-asc ecl-left_airticket-desc"),T.addClass(q,"ecl-left_airticket-normal"),T.setAttr(q,"title",""),h(this,"ecl-left_airticket-normal")&&(T.removeClass(this,"ecl-left_airticket-normal"),T.addClass(this,"ecl-left_airticket-desc")),_(this,"ecl-left_airticket-asc"),_(this,"ecl-left_airticket-desc"),h(this,"ecl-left_airticket-asc")?(this.title="按时间从早到晚排序",v.order="asc"):(this.title="按时间从晚到早排序",v.order="desc"),v.page=0,v.orderBy="time",y(v))
}),T.on(q,"click",function(){at.timer.judge()&&(T.removeClass(H,"ecl-left_airticket-asc ecl-left_airticket-desc"),T.addClass(H,"ecl-left_airticket-normal"),T.setAttr(H,"title",""),h(this,"ecl-left_airticket-normal")&&(T.removeClass(this,"ecl-left_airticket-normal"),T.addClass(this,"ecl-left_airticket-desc")),_(this,"ecl-left_airticket-asc"),_(this,"ecl-left_airticket-desc"),h(this,"ecl-left_airticket-asc")?(this.title="按价格从低到高排序",v.order="asc"):(this.title="按价格从高到低排序",v.order="desc"),v.orderBy="price",v.page=0,y(v))
})})(),F&&(F.onclick=function(){r(1)});var M,N=T.Q("ecl-left_airticket-flight-pager-box",D)[0],R=function(){var t={normal:D,loading:S,empty:x,timeout:P};return function(e){for(var a in t)(a==e?T.show:T.hide)(t[a])}}(),G={render:function(t){var e=t.flight,a=t.page,i=t.totalPage,n=t.count;return n&&i&&e.length?(g(),R("normal"),s(e),!i||1>=i?c():o(i,a),v.page=a,k.totalPage=i,r(),void 0):(R("empty"),void 0)},setState:R,getData:function(){return v},reset:function(){v.order="asc",v.orderBy="price",T.removeClass(H,"ecl-left_airticket-asc ecl-left_airticket-desc"),T.addClass(H,"ecl-left_airticket-normal"),T.removeClass(q,"ecl-left_airticket-desc ecl-left_airticket-normal"),T.addClass(q,"ecl-left_airticket-asc")
}};return t(),c(),G}(),at.list.FLIGHT_NAME='<div class="ecl-left_airticket-flight-property-name" style="background: url(#{logo}) no-repeat transparent 19px 23px"><h4 class="ecl-left_airticket-flight-name-toggler">#{carrierName}#{code}</h4><p>#{planeName}#{sp}#{share}</p></div>',at.list.FLIGHT_TIME='<div class="ecl-left_airticket-flight-property-time"><h4>#{departTime}</h4><p>#{arriveTime}#{addday}</div>',at.list.FLIGHT_AIRPORT='<div class="ecl-left_airticket-flight-property-airport"><h4>#{departAirportName}#{departTerminal}</h4><p>#{arriveAirportName}#{arriveTerminal}</p></div>',at.list.FLIGHT_LOWEST_OFFER='<div class="ecl-left_airticket-flight-property-lowest-offer #{discount}"><h4>¥ <b>#{lowestPrice}</b>起</h4><p>#{lowestDiscount}折</p></div>',at.list.FLIGHT_TOGGLER='<button type="button" class="ecl-left_airticket-flight-toggler OP_LOG_BTN"data-click="{fm:\'beha\',flightCode:\'#{flightCode}\'}"onmouseover="T.addClass(this,\'over\');"onmouseout="T.removeClass(this, \'over\')">查看报价</button>',at.list.FLIGHT_DIRECT_INFO_BASIC_TEMPLATE="#{name}#{time}#{airport}#{price}#{toggler}",at.list.FLIGHT_TRANSIT_INFO_BASIC_TEMPLATE='<div class="ecl-left_airticket-flight-transit-box"><div class="ecl-left_airticket-flight-transit-first">#{first}</div><div class="ecl-left_airticket-flight-transit-second">#{second}</div><div class="ecl-left_airticket-flight-transit-sep">#{transcity}(航班均需缴纳税费)</div></div>#{price}#{toggler}',at.list.FLIGHT_TRANSIT_INFO_BASIC_ITEM_TEMPLATE="#{name}#{time}#{airport}",at.list.FLIGHT_INFO_EXTRA="#{fdt}#{tax}#{meal}#{zj}",at.list.FLIGHT_DT="<span>飞行#{fdt}</span>",at.list.FLIGHT_TAX="<span>机建/燃油：¥#{acf}&nbsp;/&nbsp;¥#{fot}</span>",at.list.FLIGHT_MEAL="<span>#{meal}餐食</span>",at.list.FLIGHT_ZJ="<span>有网上值机</span>",at.list.FLIGHT_TEMPLATE='<li class="ecl-left_airticket-flight-#{type}-collapsed"data-index="#{index}"data-aac="#{aac}"data-dac="#{dac}"data-code="#{flightCode}"><div class="ecl-left_airticket-flight-info"onmouseover="this.className=\'ecl-left_airticket-flight-info-over\'"onmouseout="this.className=\'ecl-left_airticket-flight-info\'"><div class="ecl-left_airticket-flight-basic">#{basic}</div><div class="ecl-left_airticket-flight-extra">#{extra}</div></div><div class="ecl-left_airticket-flight-order-list"></div></li>',at.list.FLIGHT_STOPBY='<em title="该航班是经停航班" class="ecl-left_airticket-flight-stopby">经停</em>',at.list.FLIGHT_SHARE='<em title="实际乘坐航班：#{actCarrierZh}#{actCode}" class="ecl-left_airticket-flight-share">共享</em>';

    define("flyticket_agency_template",function(){return{airticket_detail_table_list:function(_template_object){var _template_fun_array=[],fn=function(__data__){var _template_varName="";for(name in __data__)_template_varName+="var "+name+'=__data__["'+name+'"];';eval(_template_varName),_template_fun_array.push(' <table class="ecl-left_airticket-list" cellspacing="0" cellpadding="0"> ');for(var i=0,t;t=agencylist[i];i++)_template_fun_array.push(" <tr"),i==agencylist.length-1&&_template_fun_array.push(' class="item-last"'),_template_fun_array.push('> <td class="column-site"> <span class="site-icon" title="供应商已获得《中国民用航空运输销售代理业务资格认可证书》"></span> <p class="site-link"> <span class="',(t.officialweb?"ecl-left-airtick-list-official":"")===void 0?"":t.officialweb?"ecl-left-airtick-list-official":"",'">',t.name===void 0?"":t.name,'</span> </p> <div class="star-number"> <div class="star-number-gray"> <div class="star-number-orange" style="width:',20*t.star===void 0?"":20*t.star,'%;"></div> </div> </div> <span>来自',t.starnum===void 0?"":t.starnum,'位用户</span> </td> <td class="column-change"> '),t.tgq&&_template_fun_array.push(' <div data-cabin="',t.cabin===void 0?"":t.cabin,'" data-price="',t.price[0]===void 0?"":t.price[0],'" data-policyid="',t.policyID===void 0?"":t.policyID,'" data-vendorid="',t.vendorid===void 0?"":t.vendorid,'" class="tgq-change-wrapper"> <div class="item-info-note"> <div class="note-arrow-top"></div> <div class="note-arrow-top-mark"></div> <div class="note-content"> <div class="note-content-container">',t.tgq.replace(/\|/g,"<br>")===void 0?"":t.tgq.replace(/\|/g,"<br>"),"</div> </div> </div>退改签</div> "),_template_fun_array.push(" "),t.seatype&&(_template_fun_array.push(" <div> "),1==t.seatype?_template_fun_array.push(' <em class="head-seat"></em> '):2==t.seatype&&_template_fun_array.push(' <em class="bus-seat"></em> '),_template_fun_array.push(" </div> ")),_template_fun_array.push("  "),t.tgq||t.seatype||_template_fun_array.push("&nbsp;"),_template_fun_array.push(' </td> <td class="column-price"> <p> <span class="price-text">￥',t.price[0]===void 0?"":t.price[0],"</span> "),t.afee&&_template_fun_array.push(' <span class="afee-info">+',t.afee===void 0?"":t.afee,"保险</span> "),_template_fun_array.push(" </p> "),t.dis&&10>t.dis&&_template_fun_array.push(' <p> <span class="price-info">',t.dis===void 0?"":t.dis,"折</span> </p> "),_template_fun_array.push(' </td> <td class="column-order"> <a target="_blank" href="',t.link+(t.link.indexOf("?")>=0?"&":"?")+"prt="+(t.afee?1:0)===void 0?"":t.link+(t.link.indexOf("?")>=0?"&":"?")+"prt="+(t.afee?1:0),'" data-btn="order" class="order-btn">预订</a> </td> </tr> ');
_template_fun_array.push(" </table> "),_template_varName=null}(_template_object);return fn=null,_template_fun_array.join("")},airticket_detail_share:function(_template_object){var _template_fun_array=[],fn=function(__data__){var _template_varName="";for(name in __data__)_template_varName+="var "+name+'=__data__["'+name+'"];';eval(_template_varName),_template_fun_array.push(' <div class="ecl-left_airticket-detail"> <div class="ecl-left_airticket-list-container"></div> </div> '),_template_varName=null}(_template_object);
return fn=null,_template_fun_array.join("")}}}),define("flyticket_agency",["flyticket_agency_template"],function(t){var e=A.baidu,a=e.dom.getAttr,i={gongxiang:1},r=function(n,o){function c(){baidu.g(n).innerHTML='<div class="ecl-left_airticket-list-error">抱歉，没有获取到结果。</div>'}function s(t,a,i){return e.ajax.request(t,{timeout:A.AJAX.TIMEOUT,onsuccess:function(t,r){try{var n=e.json.parse(r)}catch(o){return i(o),void 0}0==n.status?a(n.data):i("loaderror")},ontimeout:i,onfailure:i})}function l(t,a){var i=t+(t.indexOf("?")>=0?"&":"?")+e.url.jsonToQuery(a,function(t){return/[^\x00-\xFF]/.test(t)?encodeURIComponent(t):t
});return i}function f(t,e,a){return s(l(r.QUERY_URL,t),e,a)}function u(t,e,a){return s(l(r.QUERY_TGQ_URL,t),e,a)}function d(a){var i=t.airticket_detail_table_list;if(a.trip);else{var r=e.q(w.list,n)[0];r||(n.innerHTML=t.airticket_detail_share(a),r=e.q(w.list,n)[0]),r.innerHTML=i(a),m()}}function m(){setTimeout(function(){e.array.each(e.q(w.tgq,n),function(t){t.onmouseover=g})},0)}function T(t){var i=e.q(w.tgqnote,t)[0];if(!i.__loaded){i.__store||(i.__store=i.innerHTML),i.innerHTML='<div class="tgq-loading"><em></em>正在加载...</div>';
var r={};e.array.each(C,function(t){r[t]=o[t]||""});var n={sessionID:r.sessionID,originQuery:r.originQuery,flightNum:r.flightcode,deptAirport:r.deptAirportkey,arrAirport:r.arriAirportkey,deptDate:r.fromdate};n.printPrice=a(t,"data-price"),n.wrapperId=a(t,"data-vendorid"),n.policyId=a(t,"data-policyid"),n.cabin=a(t,"data-cabin"),u(n,function(t){i.innerHTML=t.tgq?t.tgq.replace(/\|/g,"<br>"):i.__store,i.__loaded=1},function(){i.innerHTML=i.__store})}}function p(t){var a=e.event.getTarget(t||window.event);q=setTimeout(function(){v(a)
},E)}function g(t){t=t||window.event;var a=e.event.getTarget(t);if(!e.dom.hasAttr(a,"data-vendorid")){for(;a&&!e.dom.hasAttr(a,"data-vendorid");)a=a.parentNode;return D===a&&(clearTimeout(q),a.onmouseout=p),void 0}a.onmouseout=function(t){var a=e.event.getTarget(t||window.event);e.dom.hasAttr(a,"data-vendorid")&&clearTimeout(x)},x=setTimeout(function(){T(a),D===a&&clearTimeout(q),a.className=w.tgqover,a.onmouseout=p,D=a},E)}function v(t){if(!e.dom.hasAttr(t,"data-vendorid"))for(;t&&!e.dom.hasAttr(t,"data-vendorid");)t=t.parentNode;
t.className=w.tgq}function _(t){var i=e.event.getTarget(t);return"order"==a(i,"data-btn")&&!1===I.onOrder(I)?(e.event.preventDefault(t),void 0):void 0}function y(){return e.event.on(n,"click",_),I}function h(){var t={};e.array.each(b,function(e){t[e]=o[e]||""}),f(t,function(t){d(t),I.onLoad&&I.onLoad(t)},c)}function k(){e.array.each(e.q(w.tgq,n),function(t){t.onmouseover=null,t.onmouseout=null})}function L(){e.event.un(n,"click",_),k(),n.innerHTML=""}var I=this;i.gongxiang;var b=["sessionID","originQuery","fromcity","tocity","fromdate","dateRange","flightcode","pssid"],C=["sessionID","originQuery","fromdate","flightcode","deptAirportkey","arriAirportkey","price","vendorid","policyid","cabin","pssid"],w={tgq:"tgq-change-wrapper",tgqover:"tgq-change-wrapper-hover",tgqnote:"note-content-container",list:"ecl-left_airticket-list-container"},D=null,q=0,x=0,E=80;
return this.onOrder=e.fn.blank,this.onLoad=e.fn.blank,this.dispose=L,this.render=h,y()};return r.QUERY_URL="",r.QUERY_TGQ_URL="",r});
} );
</script>


{%/if%}

{%/block%}