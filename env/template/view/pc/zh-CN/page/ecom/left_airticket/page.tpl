{%extends 'base_div.tpl'%}

{%block name='content'%}
<style type="text/css">
.ecl-left_airticket-main{width:600px;font-size:12px;background:#fdfdfd}.ecl-left_airticket-main strong{font-size:inherit;font-weight:normal}.ecl-left_airticket-main h2,.ecl-left_airticket-main h3,.ecl-left_airticket-main h4,.ecl-left_airticket-main h5{margin:0;padding:0;font-weight:normal;line-height:inherit;font-size:inherit}.ecl-left_airticket-ui-city{width:360px;position:absolute;z-index:1000;border:1px solid #ddd;background-color:#fff;padding:5px;font-size:12px;color:#555}.ecl-left_airticket-ui-city a{text-decoration:none}
.ecl-left_airticket-ui-city .ecl-left_airticket-ui-city-labels,.ecl-left_airticket-ui-city .ecl-left_airticket-ui-city-panels{list-style:none}.ecl-left_airticket-ui-city .ecl-left_airticket-ui-city-close{color:#b4b4b4;font:bold 12px/1.2 'Comic Sans MS';padding:0 3px;position:absolute;right:3px;top:8px}.ecl-left_airticket-ui-city .ecl-left_airticket-ui-city-labels{border-top:1px dashed #ddd;border-bottom:1px solid #ddd;padding-top:8px;margin-top:5px}.ecl-left_airticket-ui-city .ecl-left_airticket-ui-city-labels li{border:1px solid #ddd;background-color:#fff;float:left;padding:3px 5px;margin-right:10px;margin-bottom:-1px;cursor:pointer;color:#0069ca;line-height:16px}
.ecl-left_airticket-ui-city .ecl-left_airticket-ui-city-labels .ecl-left_airticket-ui-city-active{background-color:#e8edf1}.ecl-left_airticket-ui-city .ecl-left_airticket-ui-city-panels li{display:none;float:left;line-height:18px}.ecl-left_airticket-ui-city .ecl-left_airticket-ui-city-panels .ecl-left_airticket-ui-city-active{display:block}.ecl-left_airticket-ui-city .ecl-left_airticket-ui-city-panels a{color:#555;width:70px;display:inline-block;float:left;padding:5px 0;text-align:center;text-decoration:none}
.ecl-left_airticket-ui-cal{position:absolute;border:1px solid #b5b5b5;background:#fff;text-align:center;z-index:10}.ecl-left_airticket-ui-cal h3{margin:0;padding:0;text-align:center;line-height:19px;height:19px;overflow:hidden;font-size:14px;background:url(http://s1.bdstatic.com/r/www/cache/biz/ecom/hotel/img/hotel_cal.gif) 1px 0 repeat-x;color:#41537b;margin-bottom:2px;border:1px solid #c6cede;border-top-color:#e9eff9;border-left-color:#e9eff9}.ecl-left_airticket-ui-cal ul{background:#f1f4f9;color:#000}.ecl-left_airticket-ui-cal ul li{font-weight:bold;padding:4px 0}
.ecl-left_airticket-ui-cal li,.ecl-left_airticket-ui-cal p a{float:left;width:25px;font:12px tahoma,arial,sans-serif}.ecl-left_airticket-ui-cal p a{color:#000;height:18px;font:normal 12px/18px tahoma,arial,sans-serif;margin-top:3px;text-decoration:none;outline:0;overflow:hidden}.ecl-left_airticket-ui-cal p a:hover{color:#fff;background:#eb4f03}.ecl-left_airticket-ui-cal p a.ecl-left_airticket-ui-cal-pre-month,.ecl-left_airticket-ui-cal p a.ecl-left_airticket-ui-cal-next-month{color:#999}.ecl-left_airticket-ui-cal p a.ecl-left_airticket-ui-cal-disabled,.ecl-left_airticket-ui-cal p a.ecl-left_airticket-ui-cal-disabled:hover{color:#ddd;cursor:not-allowed;background:0}
.ecl-left_airticket-ui-cal-month{float:left;margin:auto 2px;width:175px;border-left:1px solid #dae2f5}.ecl-left_airticket-ui-cal-month .ecl-left_airticket-ui-cal-weekend{color:#c60b02}.ecl-left_airticket-ui-cal-month .ecl-left_airticket-ui-cal-today{color:red}.ecl-left_airticket-ui-cal-month .ecl-left_airticket-ui-cal-checked{color:#fff;background:#3977d2}.ecl-left_airticket-ui-cal-pre,.ecl-left_airticket-ui-cal-next{width:5px;height:9px;font-size:0;position:absolute;display:block;overflow:hidden;top:6px;background:url(http://s1.bdstatic.com/r/www/cache/biz/ecom/hotel/img/hotel_cal.gif) 0 -19px}
.ecl-left_airticket-ui-cal-pre{left:6px}.ecl-left_airticket-ui-cal-next{right:6px;background-position:0 -28px}.ecl-left_airticket-clearfix{zoom:1}.ecl-left_airticket-clearfix:after{clear:both;content:".";display:block;height:0;visibility:hidden}.ecl-left_airticket-hide{display:none}.ecl-left_airticket-highlight{color:#f80}.ecl-left_airticket-main .ecl-left_airticket-error{background-color:#c30;color:#fff;padding:2px}.ecl-left_airticket-toparea{background:#fdfdfd;border:1px solid #f5f5f5;border-bottom:0;padding:8px 0 0}
.ecl-left_airticket-query{line-height:25px;height:25px;padding-left:9px}.ecl-left_airticket-query .ecl-left_airticket-query-item{float:left;margin-right:10px}.ecl-left_airticket-query .ecl-left_airticket-query-item h5{float:left;margin-right:10px;line-height:24px}.ecl-left_airticket-query .ecl-left_airticket-query-item b{display:block;width:17px;height:17px;margin-top:2px;float:left;cursor:pointer}.ecl-left_airticket-input,.ecl-left_airticket-cal{float:left;border:1px solid #b5b5b5;background:#FFF;height:21px;line-height:21px}
.ecl-left_airticket-input input,.ecl-left_airticket-cal input{float:left;padding-left:5px;height:21px;line-height:21px;border:0;outline:0;font-size:12px}.ecl-left_airticket-input,.ecl-left_airticket-cal{margin-top:1px}.ecl-left_airticket-input{width:96px;_width:91px}.ecl-left_airticket-input input{width:56px;*width:50px;_width:46px}.ecl-left_airticket-input label{float:left;width:20px;margin-top:1px;line-height:20px;text-align:center;color:#999}.ecl-left_airticket-input .ecl-left_airticket-layer{white-space:nowrap;width:160px}
.ecl-left_airticket-tocity{margin-right:10px}.ecl-left_airticket-cal{width:158px;*width:154px}.ecl-left_airticket-cal input{width:138px;*width:128px;cursor:pointer;-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;-khtml-user-select:none;user-select:none}.ecl-left_airticket-cal b{background:url("http://s1.bdstatic.com/r/www/cache/biz/ecom/hotel/img/hotel_cbtn.gif") no-repeat}.ecl-left_airticket-cal-layer{z-index:10;zoom:1}.ecl-left_airticket-exchange{display:block;float:left;border:0;margin:0 5px;padding:0;background:0;width:36px;height:25px;background:url(http://s1.bdstatic.com/r/www/cache/biz/ecom/airticket/query.png) no-repeat 0 -101px;cursor:pointer;text-indent:-9999px}
.ecl-left_airticket-layer{position:absolute;zoom:1;left:-10000px;margin-top:2px;margin-left:-1px;border:#d0d0d0 solid 1px;background:#fff;z-index:10;color:#666;line-height:20px}.ecl-left_airticket-layer button,.ecl-left_airticket-input b{border:0;background:0;background:url("http://s1.bdstatic.com/r/www/cache/biz/ecom/hotel/img/hotel_btn.png") 0 0 no-repeat;overflow:hidden}.ecl-left_airticket-layer button{float:right;margin:6px 5px auto auto;width:9px;height:9px;background-position:0 -25px;cursor:pointer}.ecl-left_airticket-submit{display:block;border:0;margin:0;padding:0;background:0;float:left;width:82px;height:26px;line-height:26px;background:url(http://s1.bdstatic.com/r/www/cache/biz/ecom/hotel/img/button_sprites.png) no-repeat no-repeat;overflow:hidden;text-align:center;text-decoration:none;color:#333;font-size:12px;cursor:pointer}
.ecl-left_airticket-submit.ecl-left_airticket-submit-hover{background-position:-84px 0}.ecl-left_airticket-submit.ecl-left_airticket-submit-press{background-position:-168px 0}.ecl-left_airticket-weekprice{margin-top:10px;padding-left:10px;height:50px;_height:51px}.ecl-left_airticket-weekprice li{float:left;display:block;border:1px solid #b8b8b8;height:50px;width:82px;margin:-1px -1px -1px 0;background:0;cursor:pointer;text-align:center;position:relative;zoom:1;z-index:1;color:#666}.ecl-left_airticket-weekprice li.ecl-left_airticket-cur{background:#e8f5ff;border-color:#92bbe0;z-index:5}
.ecl-left_airticket-weekprice li.ecl-left_airticket-cur em{font-weight:bold}.ecl-left_airticket-weekprice li em{color:#f80;font-size:13px}.ecl-left_airticket-weekprice li p{margin:7px 0}.ecl-left_airticket-resultinfo,.ecl-left_airticket-filter,.ecl-left_airticket-filter-more{color:#666;padding-left:9px}.ecl-left_airticket-filter{margin-right:0;position:relative}.ecl-left_airticket-resultinfo{margin:10px 0 8px}.ecl-left_airticket-resultinfo i{font-style:normal}.ecl-left_airticket-resultinfo em{color:#f80;margin:0 5px}
.ecl-left_airticket-resultinfo span{margin-right:20px}.ecl-left_airticket-filter,.ecl-left_airticket-filter-more{line-height:22px;height:22px;margin-bottom:4px}.ecl-left_airticket-filter .ecl-left_airticket-option,.ecl-left_airticket-filter-more .ecl-left_airticket-option{float:left;width:310px}.ecl-left_airticket-filter .ecl-left_airticket-option-short,.ecl-left_airticket-filter-more .ecl-left_airticket-option-short{width:275px}.ecl-left_airticket-filter .ecl-left_airticket-option-short strong,.ecl-left_airticket-filter-more .ecl-left_airticket-option-short strong{width:30px}
.ecl-left_airticket-filter strong,.ecl-left_airticket-filter-more strong{color:#000;font-weight:bold;float:left;width:55px;line-height:22px;margin-right:10px}.ecl-left_airticket-filter p,.ecl-left_airticket-filter-more p{float:left;color:#666}.ecl-left_airticket-filter-fill{height:auto;margin-bottom:4px}.ecl-left_airticket-filter-fill .ecl-left_airticket-option{float:none;width:auto;margin:0}.ecl-left_airticket-filter-fill table{line-height:25px;width:100%}.ecl-left_airticket-filter-fill table td.label{width:55px}
.ecl-left_airticket-filter-fill tr,.ecl-left_airticket-filter-fill td{vertical-align:top}.ecl-left_airticket-filter-fill p{float:none;width:524px;display:block}.ecl-left_airticket-option span{display:inline-block;white-space:nowrap;margin-right:16px}.ecl-left_airticket-option span input{vertical-align:top;width:15px;height:15px;margin:3px 1px 0 0;*margin-top:2px;_margin-top:4px;float:left}.ecl-left_airticket-option span label{display:inline-block;vertical-align:top;*vertical-align:middle;font-family:tahoma;cursor:pointer;padding:0 1px 0 2px;*padding:0 2px;_padding-left:0;*margin-top:1px;height:20px;width:autourl(0);line-height:20px;color:#333;white-space:nowrap}
.ecl-left_airticket-filter-trigger{height:23px;line-height:23px;margin-top:7px;cursor:pointer;color:#666;background:#f9f9f9;text-align:center}.ecl-left_airticket-filter-trigger b{background:url(http://s1.bdstatic.com/r/www/cache/biz/ecom/airticket/icon_sprites.gif) -35px 1px no-repeat;padding:0 4px;margin-left:4px}.ecl-left_airticket-filter-trigger.ecl-left_airticket-expand b{background-position:-48px 1px}.ecl-left_airticket-sug-main{position:absolute;zoom:1;left:-10000px;z-index:10;margin-left:-1px;margin-top:4px;width:160px}
.ecl-left_airticket-sug-main ul{padding:2px;border:#d0d0d0 solid 1px;background:#fff;line-height:20px;color:#414141;cursor:pointer;font-size:12px}.ecl-left_airticket-sug-current{background-color:#36c;color:#fff}.ecl-left_airticket-sug li{padding-right:10px;white-space:nowrap}.ecl-left_airticket-sug-append,.ecl-left_airticket-sug-prepend{display:none}.ecl-left_airticket-clearfix{zoom:1}.ecl-left_airticket-clearfix:after{clear:both;content:".";display:block;height:0;visibility:hidden}
.ecl-left_airticket-flight-list-box *{font-size:12px}.ecl-left_airticket-flight-header{zoom:1;height:23px;border:1px solid #e2e2e2;border-bottom:0;background:#fff;position:relative}.ecl-left_airticket-flight-header:after{clear:both;content:".";display:block;height:0;visibility:hidden}.ecl-left_airticket-flight-header h4{float:left;height:12px;line-height:12px;margin:5px 0;padding:0;border:0;display:inline;color:#666;vertical-align:middle;-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}
.ecl-left_airticket-flight-header .ecl-left_airticket-flight-header-info{width:150px;margin-left:48px}.ecl-left_airticket-flight-header .ecl-left_airticket-flight-header-time{width:57px;text-align:center}.ecl-left_airticket-flight-header .ecl-left_airticket-flight-header-airport{width:167px;text-align:center}.ecl-left_airticket-flight-header .ecl-left_airticket-flight-header-lowest-offer{width:129px}.ecl-left_airticket-sortable{cursor:pointer;display:inline;zoom:1}.ecl-left_airticket-sortable span{float:left;margin-right:3px}
.ecl-left_airticket-sortable i{float:left;display:inline;width:6px;height:12px;line-height:12px;background:url(http://s1.bdstatic.com/r/www/cache/biz/ecom/airticket/list.gif) no-repeat transparent -31px -33px;zoom:1}.ecl-left_airticket-asc i{background:url(http://s1.bdstatic.com/r/www/cache/biz/ecom/airticket/list.gif) transparent no-repeat -15px -33px}.ecl-left_airticket-desc i{background:url(http://s1.bdstatic.com/r/www/cache/biz/ecom/airticket/list.gif) transparent no-repeat 0 -33px}.ecl-left_airticket-flight-list{zoom:1;border-left:1px solid #ebebeb;border-right:1px solid #ebebeb;background:#fff;font-size:0}
.ecl-left_airticket-flight-list:after{clear:both;content:".";display:block;height:0;visibility:hidden}.ecl-left_airticket-flight-list li{float:left;width:100%;display:block;margin:0;padding:0;border:0;border-top:1px solid #eee;background:#fff;zoom:1;font-size:12px}.ecl-left_airticket-flight-list li.last{border-bottom:1px solid #eee}.ecl-left_airticket-flight-list li.hide{display:none}.ecl-left_airticket-flight-list button{float:right;display:inline;width:66px;height:24px;line-height:24px;margin:18px 24px 0 0;padding:0;border:0;cursor:pointer;box-sizing:border-box;text-align:center;text-decoration:none;color:#666;background:url(http://s1.bdstatic.com/r/www/cache/biz/ecom/airticket/list.gif) 0 -74px transparent no-repeat;vertical-align:middle}
.ecl-left_airticket-flight-list button.over{background-position:0 -108px}.ecl-left_airticket-flight-list button.active{background-position:0 -142px}.ecl-left_airticket-flight-direct-expanded{overflow:visible;zoom:1}.ecl-left_airticket-flight-direct-expanded .ecl-left_airticket-flight-info{border-bottom:1px solid #e1e7f0;height:80px;zoom:1}.ecl-left_airticket-flight-direct-expanded .ecl-left_airticket-flight-info-over{border-bottom:1px solid #e1e7f0;height:80px;background:#fafcff}.ecl-left_airticket-flight-direct-expanded .ecl-left_airticket-flight-extra{display:block;zoom:1}
.ecl-left_airticket-flight-direct-expanded .ecl-left_airticket-flight-order-list{zoom:1;display:block}.ecl-left_airticket-flight-direct-collapsed{height:60px;overflow:hidden}.ecl-left_airticket-flight-direct-collapsed .ecl-left_airticket-flight-info{border-bottom:0;height:60px}.ecl-left_airticket-flight-direct-collapsed .ecl-left_airticket-flight-basic{height:60px}.ecl-left_airticket-flight-direct-collapsed .ecl-left_airticket-flight-extra{display:none}.ecl-left_airticket-flight-direct-collapsed .ecl-left_airticket-flight-info-over{border-bottom:0;height:60px;background:#fafcff;border-color:#e1e7f0}
.ecl-left_airticket-flight-direct-collapsed .ecl-left_airticket-flight-order-list{zoom:1;display:none}.ecl-left_airticket-flight-info,.ecl-left_airticket-flight-info-over{overflow:hidden}.ecl-left_airticket-flight-basic{zoom:1}.ecl-left_airticket-flight-basic:after{clear:both;content:".";display:block;height:0;visibility:hidden}.ecl-left_airticket-flight-basic .ecl-left_airticket-flight-property-name,.ecl-left_airticket-flight-basic .ecl-left_airticket-flight-property-time,.ecl-left_airticket-flight-basic .ecl-left_airticket-flight-property-airport,.ecl-left_airticket-flight-basic .ecl-left_airticket-flight-property-lowest-offer{float:left;_display:inline;padding:15px 0 0 0;margin:0;height:33px}
.ecl-left_airticket-flight-basic h4{color:#666;line-height:12px}.ecl-left_airticket-flight-basic p{color:#888;line-height:12px;margin-top:6px}.ecl-left_airticket-flight-basic b{font-weight:bold;font-size:14px}.ecl-left_airticket-flight-basic img{position:absolute;top:20px;left:20px;width:16px;height:16px}.ecl-left_airticket-flight-basic .ecl-left_airticket-flight-property-name{width:150px;padding-left:48px;position:relative}.ecl-left_airticket-flight-basic .ecl-left_airticket-flight-property-name em{color:#00c}
.ecl-left_airticket-flight-basic .ecl-left_airticket-flight-property-time{width:32px;padding-left:8px;padding-right:17px}.ecl-left_airticket-flight-basic .ecl-left_airticket-flight-property-time p{position:relative}.ecl-left_airticket-flight-basic .ecl-left_airticket-flight-property-time em{position:absolute;display:block;background:url(http://s1.bdstatic.com/r/www/cache/biz/ecom/airticket/list.gif) no-repeat transparent 0 -53px;color:#00c;right:-24px;_right:-7px;top:0;_top:2px;width:23px;height:11px;text-indent:-9999px;overflow:hidden}
.ecl-left_airticket-flight-basic .ecl-left_airticket-flight-property-airport{width:167px;text-align:center}.ecl-left_airticket-flight-basic .ecl-left_airticket-flight-property-lowest-offer{width:80px;text-align:center}.ecl-left_airticket-flight-basic .ecl-left_airticket-flight-property-lowest-offer h4{color:#ff6c00}.ecl-left_airticket-flight-basic .no-discount h4{padding-top:9px}.ecl-left_airticket-flight-basic .no-discount p{display:none}.ecl-left_airticket-flight-extra{zoom:1;padding-left:45px;margin:12px 0 8px 0;color:#888}
.ecl-left_airticket-flight-extra:after{clear:both;content:".";display:block;height:0;visibility:hidden}.ecl-left_airticket-flight-extra span{float:left;padding:0 10px;border-left:1px solid #888}.ecl-left_airticket-flight-extra span.first{border-left:0;padding-left:0}.ecl-left_airticket-flight-transit-collapsed h2{border-bottom:0}.ecl-left_airticket-flight-transit-collapsed h2.over{background:#fafcff}.ecl-left_airticket-flight-transit-collapsed h2.over .ecl-left_airticket-flight-transit-sep{background-color:#fafcff}
.ecl-left_airticket-flight-transit-collapsed .ecl-left_airticket-flight-extra{display:none}.ecl-left_airticket-flight-transit-collapsed .ecl-left_airticket-flight-order-list{zoom:1;display:none}.ecl-left_airticket-flight-transit-collapsed button{margin-top:45px}.ecl-left_airticket-flight-transit-expanded h2{border-bottom:1px solid #e1e7f0}.ecl-left_airticket-flight-transit-expanded h2.over{background:#fafcff}.ecl-left_airticket-flight-transit-expanded h2.over .ecl-left_airticket-flight-transit-sep{background-color:#fafcff}
.ecl-left_airticket-flight-transit-expanded .ecl-left_airticket-flight-extra{display:none}.ecl-left_airticket-flight-transit-expanded .ecl-left-airticket-flight-order-list{display:block}.ecl-left_airticket-flight-transit-expanded button{margin-top:45px}.ecl-left_airticket-flight-transit-box{float:left;position:relative;width:422px;padding:0;margin:0}.ecl-left_airticket-flight-transit-box img{top:6px}.ecl-left_airticket-flight-transit-box .ecl-left_airticket-flight-property{padding-top:0}.ecl-left_airticket-flight-transit-sep{position:absolute;top:48px;left:0;width:145px;height:30px;line-height:30px;padding-left:64px;background:url(http://s1.bdstatic.com/r/www/cache/biz/ecom/airticket/list.gif) no-repeat 45px 8px #fff;color:#00c}
.ecl-left_airticket-flight-transit-first{zoom:1;padding:15px 0 15px 0;border-bottom:1px solid #f5f5f5}.ecl-left_airticket-flight-transit-first:after{clear:both;content:".";display:block;height:0;visibility:hidden}.ecl-left_airticket-flight-transit-second{zoom:1;padding:15px 0 15px 0}.ecl-left_airticket-flight-transit-second:after{clear:both;content:".";display:block;height:0;visibility:hidden}.ecl-left_airticket-flight-transit-expanded .lowest-offer,.ecl-left_airticket-flight-transit-collapsed .lowest-offer{padding:45px 0 0 0;margin-left:5px}
.ecl-left_airticket-flight-expandor{display:none;height:30px;line-height:30px;text-align:center;cursor:pointer;border:1px solid #eee;border-top:0;color:#666}.ecl-left_airticket-flight-expandor b{margin-left:4px;background:url(http://s1.bdstatic.com/r/www/cache/biz/ecom/airticket/icon_sprites.gif) -35px 1px no-repeat;padding:0 4px}.has-more .ecl-left_airticket-flight-expandor{display:block}.has-more .ecl-left_airticket-flight-pager-box{display:none}.ecl-left_airticket-flight-pager-box{margin:15px 0;background:transparent;text-align:center}
.ecl-left_airticket-flight-pager{overflow:auto;display:inline-block;text-align:center}.ecl-left_airticket-flight-pager a{display:inline-block;margin:3px;text-decoration:none;color:#00c;font-size:12px;border:1px solid #CCC;overflow:hidden;*position:relative;padding:2px 5px;color:#03c;font:normal 12px/16px Arial,Helvetica,sans-serif;text-align:center}.ecl-left_airticket-flight-pager a:hover{background-color:#eff4fa}.ecl-left_airticket-flight-pager a.ecl-left_airticket-flight-pager-ellipsis{border:0 none}.ecl-left_airticket-flight-pager .ecl-left_airticket-flight-pager-current{font-weight:700;border:0 none;color:#666;cursor:default}
.ecl-left_airticket-flight-pager a{vertical-align:middle}.ecl-left_airticket-flight-pager a em{vertical-align:middle;border:5px solid #fff;font-size:0;margin:auto 3px}.ecl-left_airticket-flight-pager a:hover em{border-color:#eff4fa}.ecl-left_airticket-flight-pager a.ecl-left_airticket-flight-pager-current:hover,.ecl-left_airticket-flight-pager a.ecl-left_airticket-flight-pager-ellipsis:hover,.ecl-left_airticket-flight-pager a.ecl-left_airticket-flight-pager-disabled:hover{background:0}.ecl-left_airticket-flight-pager a.ecl-left_airticket-flight-pager-current:hover em,.ecl-left_airticket-flight-pager a.ecl-left_airticket-flight-pager-ellipsis:hover em,.ecl-left_airticket-flight-pager a.ecl-left_airticket-flight-pager-disabled:hover em{border-color:#FFF}
.ecl-left_airticket-flight-pager a em.ecl-left_airticket-flight-pager-icon-l,.ecl-left_airticket-flight-pager a:hover em.ecl-left_airticket-flight-pager-icon-l{border-right-color:#999;border-left:none}.ecl-left_airticket-flight-pager a em.ecl-left_airticket-flight-pager-icon-r,.ecl-left_airticket-flight-pager a:hover em.ecl-left_airticket-flight-pager-icon-r{border-left-color:#999;border-right:0}.ecl-left_airticket-flight-pager a.ecl-left_airticket-flight-pager-disabled{display:none}a.ecl-left_airticket-flight-pager-prev{padding-left:10px;background:url(http://s1.bdstatic.com/r/www/cache/biz/ecom/airticket/list.gif) transparent no-repeat 3px 5px;*background-position:2px 4px}
a.ecl-left_airticket-flight-pager-next{padding-right:10px;background:url(http://s1.bdstatic.com/r/www/cache/biz/ecom/airticket/list.gif) transparent no-repeat 43px -13px;*background-position:43px -13px}.ecl-left_airticket-flight-timeout-box,.ecl-left_airticket-flight-loading-box{text-align:center;color:#666;padding:50px 0 30px;border:1px solid #f5f5f5;border-top:0;background:url(http://s1.bdstatic.com/r/www/cache/biz/ecom/airticket/loading.gif) transparent no-repeat center 20px}.ecl-left_airticket-flight-empty-box{text-align:center;color:#666;padding:50px 0 30px;border:1px solid #f5f5f5;border-top:0;color:#000;font-weight:bold}
.ecl-left_airticket-header-note{height:30px;line-height:30px;padding-left:10px;background:#fafafa;border-bottom:#EEE 1px solid}.ecl-left_airticket-header-step{height:30px;line-height:30px;padding-left:10px}.ecl-left_airticket-header-step .item-text{font-weight:bold}.ecl-left_airticket-header-step .item-info{margin-left:24px}.ecl-left_airticket-detail{color:#666;font-size:12px}.ecl-left_airticket-detail a{text-decoration:none}.ecl-left_airticket-detail a:hover{text-decoration:underline}.ecl-left_airticket-header-all{height:26px;line-height:26px;padding-top:4px;padding-left:4px;border-bottom:#67a5eb 2px solid}
.ecl-left_airticket-header-all a,.ecl-left_airticket-header-all a:hover{height:26px;line-height:26px;float:left;width:auto;padding:0 10px;margin-right:10px;text-align:center;color:#00E}.ecl-left_airticket-header-all .item-text{background:#67a5eb;font-weight:bold;color:#FFF;text-shadow:1px 0 1px #666;-webkit-text-shadow:1px 0 1px #666;-moz-text-shadow:1px 0 1px #666}.ecl-left_airticket-header-all .item-text:hover{color:#FFF;text-decoration:none}.ecl-left_airticket-header-all .item-info{margin-left:10px;color:#666;font-weight:bold}
.ecl-left_airticket-header-note{color:#888}.ecl-left_airticket-list-error{text-align:center;height:200px;line-height:200px;color:#5b9eea}.ecl-left_airticket-list{width:100%;border-top:#EEE 1px solid}.ecl-left_airticket-list td{border-bottom:#EEE 1px solid;height:59px;vertical-align:middle}.ecl-left_airticket-list .item-last td{border-bottom:0}.ecl-left_airticket-list .column-site{color:#888}.ecl-left_airticket-list .column-icon,.ecl-left_airticket-list .column-price{width:110px}.ecl-left_airticket-list .column-change{width:100px}
.ecl-left_airticket-list .column-order{width:88px}.ecl-left_airticket-list .column-site{padding-left:12px}.ecl-left_airticket-list .star-number{width:75px;padding-top:2px;float:left;margin-right:4px}.ecl-left_airticket-list .star-number-gray,.ecl-left_airticket-list .star-number-orange{width:64px;background:url("http://s1.bdstatic.com/r/www/cache/biz/ecom/airticket/agency.gif") no-repeat -80px -60px;height:12px}.ecl-left_airticket-list .star-number-orange{background-position:-80px -80px}.ecl-left_airticket-list .site-link{color:#666}.ecl-left_airticket-list .site-icon{width:30px;height:40px;background:url("http://s1.bdstatic.com/r/www/cache/biz/ecom/airticket/agency.gif") -124px 13px no-repeat;float:left}
.ecl-left_airticket-list .subject-label{display:block;height:28px;line-height:28px}.ecl-left_airticket-list .subject-text{margin-left:2px}.ecl-left_airticket-list .icon-assure,.ecl-left_airticket-list .icon-724{display:block;margin-top:2px;width:24px;height:24px;float:left;background:url("http://s1.bdstatic.com/r/www/cache/biz/ecom/airticket/agency.gif") 0 -18px no-repeat}.ecl-left_airticket-list .icon-724{background-position:-24px -18px}.ecl-left_airticket-list .head-seat,.ecl-left_airticket-list .bus-seat{margin-top:2px;width:34px;height:12px;background:url("http://s1.bdstatic.com/r/www/cache/biz/ecom/airticket/agency.gif") no-repeat;display:block}
.ecl-left_airticket-list .bus-seat{background-position:0 -100px}.ecl-left_airticket-list .price-text{color:#ff6c00;font:600 13px/13px arial}.ecl-left_airticket-list .afee-info{margin-left:4px}.ecl-left_airticket-list .price-info{color:#888}.ecl-left_airticket-list .order-btn{width:67px;height:24px;line-height:24px;text-align:center;color:#FFF;text-decoration:none;display:inline-block;background:#3da1fd url("http://s1.bdstatic.com/r/www/cache/biz/ecom/airticket/agency.gif") 0 -50px no-repeat;*display:inline;*zoom:1}.ecl-left_airticket-list .order-btn:hover{text-decoration:none}
.ecl-left_airticket-list .item-info-note{position:absolute;border:1px solid #BBB;background:#FFF;box-shadow:1px 1px 1px #ccc;-webkit-box-shadow:1px 1px 1px #ccc;-moz-box-shadow:1px 1px 1px #ccc;border-radius:1px;width:240px;margin-left:-40px;margin-top:26px;z-index:1}.ecl-left_airticket-list .note-arrow-top,.ecl-left_airticket-list .note-arrow-top-mark{position:absolute;width:0;height:0;font-size:0;border:transparent 8px solid;border-bottom-color:#BBB;_border-style:dashed;_border-bottom-style:solid;left:44px;top:-16px;_margin-top:-18px;z-index:2}
.ecl-left_airticket-list .note-arrow-top-mark{border-bottom-color:#FFF;top:-15px}.ecl-left_airticket-list .note-content{margin:10px}.ecl-left_airticket-list .tgq-change-wrapper,.ecl-left_airticket-list .tgq-change-wrapper-hover{color:#666;border-bottom:#666 1px dotted;cursor:pointer;width:auto;display:inline}.ecl-left_airticket-list .tgq-change-wrapper .item-info-note{display:none}.ecl-left_airticket-list .tgq-change-wrapper-hover .item-info-note{display:block}.ecl-left_airticket-list .tgq-loading{text-align:center;height:30px;line-height:30px}
.ecl-left_airticket-list .tgq-loading em{width:24px;height:24px;margin-right:2px;display:inline-block;*display:inline;*zoom:1;vertical-align:middle;background:url("http://s1.bdstatic.com/r/www/cache/biz/ecom/airticket/loading.gif") no-repeat}
</style>
{%*点击统计*%} 
{%$sessionid=$extData.sessionid%}
{%$subqid=$extData.subqid%}
{%$sid=$extData.sid%}
{%$pssid=$extData.pssid%}
{%function name=fe_fn_vs_flight_clicklog id=""%}
    data-click="{'vs_flight_sessionid':'{%$sessionid|escape:'html'%}','vs_flight_subqid':'{%$subqid|escape:'html'%}','vs_flight_sid':'{%$sid|escape:'html'%}'{%if $id%},'vs_flight_data':'id:{%$id|escape:'html'%}'{%/if%}}"
{%/function%}
<div class="ecl-left_airticket-main" {%fe_fn_vs_flight_clicklog%}>
<div class="ecl-left_airticket-toparea" data-click="{fm:'behz'}">
    <div class="ecl-left_airticket-query">
        <form onsubmit="return false;">
            <div class="ecl-left_airticket-query-item">
                <h5>城市</h5>
                <div class="ecl-left_airticket-input ecl-left_airticket-fromcity">
                    <label>从</label>
                    <input class="OP_LOG_OTHERS" autocomplete="off" type="text" maxlength="100" value="{%$tplData.fromcity|escape:'html'%}" />
                    <b class="ecl-left_airticket-city-trigger OP_LOG_BTN"></b>
                    <div class="ecl-left_airticket-layer ecl-left_airticket-hide-layer"></div>
                </div>
                <span class="ecl-left_airticket-exchange OP_LOG_BTN" title="切换城市">换</span>
                <div class="ecl-left_airticket-input ecl-left_airticket-tocity">
                    <label>到</label>
                    <input class="OP_LOG_OTHERS" autocomplete="off" type="text" maxlength="100" value="{%$tplData.tocity|escape:'html'%}" />
                    <b class="ecl-left_airticket-city-trigger OP_LOG_BTN"></b>
                    <div class="ecl-left_airticket-layer ecl-left_airticket-hide-layer"></div>
                </div>
            </div>
            <div class="ecl-left_airticket-query-item">
                <h5>日期</h5>
                <div class="ecl-left_airticket-cal">
                    <input class="ecl-left_airticket-cal-trigger OP_LOG_OTHERS" type="text" readonly="readonly" />
                    <b class="ecl-left_airticket-cal-trigger OP_LOG_BTN"></b>
                </div>
            </div>
            <input type="submit" class="ecl-left_airticket-submit OP_LOG_BTN" value="快速查询" />
        </form>
    </div>
    <ul class="ecl-left_airticket-weekprice">
        {%$max=count($tplData.weekprice)%}{%for $loop=0 to 6%}{%if $loop<$max%}
        {%$item=$tplData.weekprice[$loop]%}
        <li data-date="{%$item['date']|escape:'html'%}" class="OP_LOG_OTHERS">
            <p>{%$item['date']|escape:'html'|regex_replace:"/^\d{4}-/":""%}&nbsp;{%$item['weekday']|escape:'html'%}</p>
            <em>{%if $item['price']%}¥{%$item['price']|escape:'html'%}{%else%}查看{%/if%}</em>
        </li>
        {%else%}{%break%}{%/if%}{%/for%}
    </ul>
    <div class="ecl-left_airticket-resultinfo"><span><i>{%$tplData.fromcity|escape:'html'%}</i> → <i>{%$tplData.tocity|escape:'html'%}</i>&nbsp;</span>温馨提示：由于航班和票价变动比较频繁，请以点击预订时的信息为准。</div>
    <div class="ecl-left_airticket-ft-wrap">
        <div class="ecl-left_airticket-filter">
            <div class="ecl-left_airticket-option" data-filter-key="time">
                <strong>起飞时间:</strong>
                <p><span class="OP_LOG_OTHERS" title="6-12点"><input type="checkbox" value="1" /><label>上午</label></span><span class="OP_LOG_OTHERS" title="12-13点"><input type="checkbox" value="2" /><label>中午</label></span><span class="OP_LOG_OTHERS" title="13-18点"><input type="checkbox" value="3" /><label>下午</label></span><span class="OP_LOG_OTHERS" title="18点以后"><input type="checkbox" value="4" /><label>晚上</label></span></p>
            </div>
            <div class="ecl-left_airticket-option ecl-left_airticket-option-short" data-filter-key="size">
                <strong class="short">机型:</strong>
                <p><span class="OP_LOG_OTHERS"><input type="checkbox" value="1" /><label>大型机</label></span><span class="OP_LOG_OTHERS"><input type="checkbox" value="2" /><label>中型机</label></span><span class="OP_LOG_OTHERS"><input type="checkbox" value="3" /><label>小型机</label></span></p>
            </div>
        </div>
        <div class="ecl-left_airticket-filter-fill ecl-left_airticket-filter-more ecl-left_airticket-hide">
            {%$maxcount=count($tplData.cond_airport)%}
            <div class="ecl-left_airticket-option{%if $maxcount==0%} ecl-left_airticket-hide{%/if%}" data-filter-key="airport">
                <table border="0" cellspacing="0" cellpadding="0">
                    <tr>
                        <td class="label"><strong>起降机场:</strong></td>
                        <td><p>
                            {%for $loop=0 to 99%}{%if $loop<$maxcount%}<span class="OP_LOG_OTHERS"><input type="checkbox" value="{%$tplData.cond_airport[$loop]['value']|escape:'html'%}" /><label>{%$tplData.cond_airport[$loop]['name']|escape:'html'%}</label></span>{%else%}{%break%}{%/if%}{%/for%}
                        </p></td>
                    </tr>
                </table>
            </div>
        </div>
        <div class="ecl-left_airticket-filter-fill ecl-left_airticket-filter-more ecl-left_airticket-hide">
            {%$maxcount=count($tplData.cond_airline)%}
            <div class="ecl-left_airticket-option{%if $maxcount==0%} ecl-left_airticket-hide{%/if%}" data-filter-key="airline">
                <table border="0" cellspacing="0" cellpadding="0">
                    <tr>
                        <td class="label"><strong>航空公司:</strong></td>
                        <td>
                            <p>
                                {%for $loop=0 to 99%}{%if $loop<$maxcount%}<span class="OP_LOG_OTHERS"><input type="checkbox" value="{%$tplData.cond_airline[$loop]['value']|escape:'html'%}" /><label>{%$tplData.cond_airline[$loop]['name']|escape:'html'%}</label></span>{%else%}{%break%}{%/if%}{%/for%}
                            </p>
                        </td>
                    </tr>
                </table>
            </div>
        </div>
        <div class="ecl-left_airticket-filter-trigger OP_LOG_BTN">更多筛选条件<b>&nbsp;&nbsp;</b></div>
    </div>
</div>



{%$flightCount = count($tplData.flight)%}
<div class="ecl-left_airticket-flight-list-box {%if $tplData.count>5%}has-more{%/if%}">

    <div class="ecl-left_airticket-flight-header" data-click="{fm:'behz'}">
        <h4 class="ecl-left_airticket-flight-header-info">航班信息</h4>
        <h4 class="ecl-left_airticket-flight-header-time ecl-left_airticket-sortable ecl-left_airticket-normal OP_LOG_OTHERS"><span>起降时间</span><i></i></h4>
        <h4 class="ecl-left_airticket-flight-header-airport">起降机场</h4>
        <h4 class="ecl-left_airticket-flight-header-lowest-offer ecl-left_airticket-sortable ecl-left_airticket-asc OP_LOG_OTHERS" title="按价格从低到高排序"><span>最低报价（不含税费）</span><i></i></h4>
    </div>

    <ul class="ecl-left_airticket-flight-list">
        {%foreach from=$tplData.flight key=index item=flight%}
        {%if $flight.directFlag == 1 || $flight.unionSpecial%}
        <li class="ecl-left_airticket-flight-direct-collapsed {%if $flightCount<=5 and $index==$flightCount-1 or $flightCount>5 and $index==4%}last{%/if%} {%if $index>=5%}hide{%/if%}" data-code="{%$flight.trip[0].flightCode|escape:'html'%}" data-aac="{%$flight.trip[0].arriveAirportCode|escape:'html'%}" data-dac="{%$flight.trip[0].departAirportCode|escape:'html'%}" data-index="{%$index%}">
            <div class="ecl-left_airticket-flight-info" onmouseover="this.className='ecl-left_airticket-flight-info-over'" onmouseout="this.className='ecl-left_airticket-flight-info'">
                <div class="ecl-left_airticket-flight-basic">
                    <div class="ecl-left_airticket-flight-property-name">
                        <img src="{%$flight.trip[0].logo|escape:'html'%}" />
                        <h4>{%$flight.trip[0].carrierName|escape:'html'%}{%$flight.trip[0].code|escape:'html'%}</h4>
                        <p>{%$flight.trip[0].planeName|escape:'html'%}{%if $flight.trip[0].sp|escape:'html'%}<em href="#" title="该航班是经停航班">经停</em>{%/if%}</p>
                    </div>
                    <div class="ecl-left_airticket-flight-property-time">
                        <h4>{%$flight.trip[0].departTime|escape:'html'%}</h4>
                        <p>{%$flight.trip[0].arriveTime|escape:'html'%}{%if $flight.trip[0].arriveTime|replace:':':'' < $flight.trip[0].departTime|replace:':':''|escape:'html'%}<em></em>{%/if%}</p>
                    </div>
                    <div class="ecl-left_airticket-flight-property-airport">
                        <h4>{%$flight.trip[0].departAirportName|escape:'html'%}{%$flight.trip[0].departTerminal|escape:'html'%}</h4>
                        <p>{%$flight.trip[0].arriveAirportName|escape:'html'%}{%$flight.trip[0].arriveTerminal|escape:'html'%}</p>
                    </div>
                    <div class="ecl-left_airticket-flight-property-lowest-offer {%if $flight.lowestDiscount>=10%}no-discount{%/if%}">
                        <h4>¥ <b>{%$flight.lowestPrice|escape:'html'%}</b></h4>
                        <p>{%$flight.lowestDiscount|escape:'html'%}折</p>
                    </div>
                    <button type="button" class="ecl-left_airticket-flight-toggler OP_LOG_BTN" data-click="{'fm':'behz','flightCode':'{%$flight.trip[0].flightCode|escape:'html'%}'}" onmouseover="T.addClass(this,'over');"   onmouseout="T.removeClass(this, 'over active')">查看详情</button>
                </div>
                {%if $flight.trip[0].fdt || $flight.trip[0].acf && $flight.trip[0].fot || $flight.trip[0].meal || $flight.trip[0].zj%}
                <div class="ecl-left_airticket-flight-extra">
                    {%if $flight.trip[0].fdt%}
                    <span class="first">飞行{%$flight.trip[0].fdt|escape:'html'%}</span>
                    {%/if%}
                    {%if $flight.trip[0].acf && $flight.trip[0].fot%}
                    <span>机建/燃油：¥{%$flight.trip[0].acf|escape:'html'%}&nbsp;/&nbsp;¥{%$flight.trip[0].fot|escape:'html'%}</span>
                    {%/if%}
                    {%if $flight.trip[0].meal|escape:'html'%}
                    <span>有餐食</span>{%else%}<span>无餐食</span>
                    {%/if%}
                    {%if $flight.trip[0].zj|escape:'html'%}
                    <span>有网上值机</span>
                    {%/if%}
                </div>
                {%/if%}
            </div>
            <div class="ecl-left_airticket-flight-order-list"></div>
        </li>
        {%else%}
        <li class="ecl-left_airticket-flight-transit-collapsed {%if $index==$flightCount-1%}last{%/if%} {%if $index>=5%}hide{%/if%}"
            data-code="{%$flight.trip[0].flightCode|escape:'html'%}" 
            data-aac="{%$flight.trip[0].arriveAirportCode|escape:'html'%}" 
            data-dac="{%$flight.trip[0].departAirportCode|escape:'html'%}" 
            data-index="{%$index%}">
            <div class="ecl-left_airticket-flight-info"
                onmouseover="T.addClass(this,'over');" onmouseout="T.removeClass(this, 'over')">
                <div class="ecl-left_airticket-flight-basic">
                    <div class="ecl-left_airticket-flight-transit-box">
                        <div class="ecl-left_airticket-flight-transit-first">
                            <div class="ecl-left_airticket-flight-property-name">
                                <img src="{%$flight.trip[0].logo|escape:'html'%}" >
                                <h4>{%$flight.trip[0].carrierName|escape:'html'%}{%$flight.trip[0].code|escape:'html'%}</h4>
                                <p>
                                    {%$flight.trip[0].planeName|escape:'html'%}
                                    {%if $flight.trip[0].sp|escape:'html'%}
                                    <em title="该航班是经停航班">经停</em>
                                    {%/if%}
                                </p>
                            </div>
                            <div class="ecl-left_airticket-flight-property-time">
                                <h4>{%$flight.trip[0].departTime|escape:'html'%}</h4>
                                <p>{%$flight.trip[0].arriveTime|escape:'html'%}</p>
                            </div>
                            <div class="ecl-left_airticket-flight-property-airport">
                                <h4>{%$flight.trip[0].departAirportName|escape:'html'%}{%$flight.trip[0].departTerminal|escape:'html'%}</h4>
                                <p>{%$flight.trip[0].arriveAirportName|escape:'html'%}{%$flight.trip[0].arriveTerminal|escape:'html'%}</p>
                            </div>
                        </div>
                        <div class="ecl-left_airticket-flight-transit-second">
                            <div class="ecl-left_airticket-flight-property-name">
                                <img src="{%$flight.trip[1].logo|escape:'html'%}" >
                                <h4>{%$flight.trip[1].carrierName|escape:'html'%}{%$flight.trip[1].code|escape:'html'%}</h4>
                                <p>
                                    {%$flight.trip[1].planeName|escape:'html'%}
                                    {%if $flight.trip[1].sp|escape:'html'%}
                                    <em title="该航班是经停航班">经停</em>
                                    {%/if%}
                                </p>
                            </div>
                            <div class="ecl-left_airticket-flight-property-time">
                                <h4>{%$flight.trip[1].departTime|escape:'html'%}</h4>
                                <p>{%$flight.trip[1].arriveTime|escape:'html'%}</p>
                            </div>
                            <div class="ecl-left_airticket-flight-property-airport">
                                <h4>{%$flight.trip[1].departAirportName|escape:'html'%}{%$flight.trip[1].departTerminal|escape:'html'%}</h4>
                                <p>{%$flight.trip[1].arriveAirportName|escape:'html'%}{%$flight.trip[1].arriveTerminal|escape:'html'%}</p>
                            </div>
                        </div>
                        <div class="ecl-left_airticket-flight-transit-sep">
                            {%$flight.transcity|escape:'html'%}(航班均需缴纳税费)
                        </div>
                    </div>
                    <div class="ecl-left_airticket-flight-property-lowest-offer">
                        <h4>￥<b>{%$flight.lowestPrice|escape:'html'%}</b></h4>
                        <p>{%$flight.lowestDiscount|escape:'html'%}折</p>
                    </div>
                    <button type="button" class="ecl-left_airticket-flight-toggler OP_LOG_OTHERS"
                        data-click="{'fm':'behz','flightCode':'{%$flight.trip[0].flightCode|escape:'html'%}'}"
                        onmouseover="T.addClass(this,'over');"
                        onmouseout="T.removeClass(this, 'over active')">查看详情</button>
                </div>
            </div>
            <div class="ecl-left_airticket-flight-order-list"></div>
        </li>
        {%/if%}
        {%/foreach%}
    </ul>
    
    <div class="ecl-left_airticket-flight-expandor OP_LOG_BTN" data-click="{'fm':'behz'}">点击展开更多航班<b>&nbsp;&nbsp;</b></div>
    
    <div class="ecl-left_airticket-flight-pager-box" style="display:none" data-click="{'fm':'behz'}">
        <div class="ecl-left_airticket-flight-pager"></div>
    </div>

</div>

<div class="ecl-left_airticket-flight-empty-box" style="display:none">
    没有查询到可售航班，请您修改查询条件后再试
</div>

<div class="ecl-left_airticket-flight-timeout-box" style="display:none">
    您的前一次搜索已经过去了10分钟，<br>正在为您重新搜索以提供更准确报价
</div>

<div class="ecl-left_airticket-flight-loading-box" style="display:none">
    您查询的结果正在实时搜索中...
</div> 
</div>

<script data-compress="off">
A.setup('AIRTICKET_LEFT', {
    'FROM_CITY': '{%$tplData.fromcity|escape:'html'%}',
    'TO_CITY': '{%$tplData.tocity|escape:'html'%}',
    'URL_QUERY': '/ecomui/flight?controller=SingleLine&action=flightList',
    'URL_AGENCY': '/ecomui/flight?controller=SingleLine&action=vendorList',
    'URL_TGQ': '/ecomui/flight?controller=Tgq&action=getTgq',
    'URL_CITY': '/ecomui/flight?controller=CitySuggest&action=tip',
    'ORIGIN_QUERY': '{%$extData.originQuery|escape:'html'%}',
    'SESSION_ID': '{%$sessionid|escape:"javascript"%}',
    'STATS_SUBQID': '{%$subqid|escape:"javascript"%}',
    'STATS_SID': '{%$sid|escape:"javascript"%}',
    'STATS_PSSID': '{%$pssid|escape:"javascript"%}'
});
A.setup('AT_LIST_DATA', {
    total: {%$tplData.count|default:0%},
    totalPage: {%$tplData.totalPage|default:0%}
});
</script>
<script type="text/javascript">
A.init( function() {
    var T = A.baidu;
    var card = this;
    var at = {};
    // // AMD加载地址配置
    // // TODO: 测试时删除
    // require.config({
    //     paths : {
    //         ecom: 'http://dev005.baidu.com:8888/ecomtpl-branch-fix/ecom_2-0-0_BRANCH/src/common/'
    //     }
    // });
    require.config({
        paths : {
            'ecom/ui': 'ecom/ui/20130424'
        }
    });

    var TPLDATA=card.data.AIRTICKET_LEFT,common=function(){function e(e){return e=common.getClass(e),card.qq(e)}function t(e,t){return e?e.getElementsByTagName(t):[]}function n(e){return e.replace(/-/g,"")}function r(e){return e=(""+e).match(/^(\d+)(\d\d)(\d\d)/),e.shift(),new Date(e[0],e[1]-1,e[2])}function a(e){return r(n(e))}function o(){this.events={}}function i(e,t){var n={};for(var r in e)n["vs_flight_"+r]=e[r];var a=T.json.stringify(n).replace(/"/g,"'");return t?a:'data-click="'+a+'"'}var c={},u="ecl-left_airticket";
c.getClass=function(e){return e=e||"",u+"-"+e};var s=[];return c.addIniter=function(e){s.push(e)},c.init=function(){for(var e=0,t=s.length;t>e;e++){var n=s[e];"function"==typeof n&&n()}},c.queryByClass=e,c.getInput=function(n){return t(e(n),"input")[0]},c.prev=function(e){for(e=e.previousSibling;e;){if(1==e.nodeType)return e;e=e.previousSibling}return e},c.last=function(e){for(var e=e.lastChild;e;){if(1==e.nodeType)return e;e=e.previousSibling}return e},c.queryTags=t,c.request=function(e,t,n){t=t||Function(),n=n||Function(),T.ajax.request(e,{timeout:A.AJAX.TIMEOUT,ontimeout:function(){var e={status:-1,statusInfo:"timeout"};
n(xhr.status,e)},onsuccess:function(e,r){try{var a=T.json.parse(r)}catch(o){var a={status:500,statusInfo:"error"}}if(a.status)return n(a.status,a),void 0;var i=a.data;t(i,a)},onfailure:function(e){var t={status:e.status,statusInfo:e.statusText};n(e.status,t)}})},c.now="undefined"==typeof bdServerTime?new Date:new Date(1e3*bdServerTime),c.afterDays=function(e,t){return new Date(e.getTime()+1e3*60*60*24*t)},c.removeStrike=n,c.number2Date=r,c.str2Date=a,c.date2HumanStyle=function(e){return common.formatDate(e,"yyyy-MM-dd")+"("+"周"+"日一二三四五六".charAt(e.getDay())+")"
},c.formatDate=function(e,t){function n(e,n){t=t.replace(e,n)}function r(e,t){var n="",r=0>e,a=Math.abs(e)+"";return t>a.length&&(n=Array(t-a.length+1).join("0")),(r?"-":"")+n+a}if("string"!=typeof t)return""+e;var a=e.getFullYear(),o=e.getMonth()+1,i=e.getDate(),c=e.getHours(),u=e.getMinutes(),s=e.getSeconds();return n(/yyyy/g,r(a,4)),n(/yy/g,r(parseInt((""+a).slice(2),10),2)),n(/MM/g,r(o,2)),n(/M/g,o),n(/dd/g,r(i,2)),n(/d/g,i),n(/HH/g,r(c,2)),n(/H/g,c),n(/hh/g,r(c%12,2)),n(/h/g,c%12),n(/mm/g,r(u,2)),n(/m/g,u),n(/ss/g,r(s,2)),n(/s/g,s),t
},c.showLayer=function(e,t,n){var r=t.offsetHeight,a=T.dom.getPosition(t),o={};o.top=a.top+r,6==T.browser.ie&&(e.style.left="-10000px",o.top-=5);var i=t.offsetWidth;n&&"left"!=n?"right"==n&&(o.left=a.left+i-e.offsetWidth):o.left=a.left,e.style.left=o.left+"px",e.style.top=o.top+"px",T.removeClass(e,c.getClass("hide-layer"))},c.hideLayer=function(e){T.addClass(e,c.getClass("hide-layer")),e.style.left="-10000px"},c.toggleLayer=function(e,t,n){var r="hideLayer";T.dom.hasClass(e,c.getClass("hide-layer"))&&(r="showLayer"),c[r](e,t,n)
},o.prototype={constructor:o,on:function(e,t){this.events[e]instanceof Array||(this.events[e]=[]),this.events[e].push(t)},un:function(e,t){for(var n=this.events[e],r=n instanceof Array&&n.length;r--;)n[r]===t&&n.splice(r,1)},fire:function(e,t){var n=this.events[e],r=this;n instanceof Array&&T.each(n,function(e){"function"==typeof e&&e.call(r,t)})}},c.Observable=o,c.getStatsAttr=i,c}();at.timer=function(){function e(){n=(new Date).getTime()}function t(){var e=(new Date).getTime();return e-n>a?(at.query.fire("query",at.query.get()),at.list.setState("timeout"),!1):!0
}var n,r={},a=6e5;return common.addIniter(function(){n=(new Date).getTime()}),r.update=e,r.judge=t,r}(),at.query=function(){function e(e){var n,r=common.getInput(e);T.event.on(r,"keydown",function(){b&&b.hide()}),T.event.on(r,"focus",function(){var e=this;n||setTimeout(function(){e.select()},1),n=1}),T.event.on(r,"blur",function(){n=0}),T.event.on(T.dom.next(r),"click",function(){common.prev(this).select()}),t(e),r=null}function t(e){function t(t){var r,a=this;return k[e]==t&&(a.hide(),l(e),r=1),("fromcity"==e&&t==v||"tocity"==e&&t==h)&&(a.hide(),l(e),L[e]={value:t,data:{enable:1}},r=1),r?!1:(A[e]++,n(t,function(n){A[e]--,n.length?(a.show(t,n),L[e]=n[0],l(e)):a.hide()
}),void 0)}require(["ecom/ui/suggestion"],function(n){var r=q(e),a=new n({skin:S("sug"),getData:t,onpick:function(t){var n=t.data.item||{};n.data&&(L[e]=n),k[e]=n.value},onhide:function(){s(e)}});a.render(r),r=null})}function n(e,t){t=t||Function();var n=TPLDATA.URL_CITY;n+=(n.indexOf("?")>-1?"&":"?")+"city=#{0}&t=#{1}",n=T.format(n,encodeURIComponent(e),(new Date).getTime());var a=[];common.request(n,function(n){n.length&&T.each(n,function(t){var n=RegExp("("+e+")","i"),o=t.s.split("|"),i=(o[0]+"("+o[1]+")").replace(n,'<span class="'+S("highlight")+'">$1</span>');
a.push({content:i,value:r(t),data:t})}),t(a)},function(){t([])})}function r(e){var t=e.s.split("|")[0],n=/\((\S+)\)/,r=t.match(n);return r?r[1]:t}function a(){require(["ecom/ui/city"],function(e){b=new e({prefix:S("ui-city"),triggers:S("city-trigger"),offset:{y:2,x:-21},onBeforeShow:function(e){var t=e.event,n=T.event.getTarget(t);this.setTarget("INPUT"==n.tagName&&"text"==n.type?n:common.prev(n))},onPick:function(e){var t=this.target,n=e.value,r="fromcity";t==q(r)?v=n:(h=n,r="tocity"),L[r]={value:n,data:{enable:1}},t.blur()
}}),b.render()})}function o(){var e="fromcity",t="tocity",n=q(e),r=q(t);k[e]=r.value,k[t]=n.value;var a;a=L[e],L[e]=L[t],L[t]=a,n.value=k[e],r.value=k[t]}function i(){require(["ecom/ui/calendar"],function(e){var t=card.q(S("cal-trigger")),n=q("cal"),r=new e({offset:{x:2},dateFormat:"yyyy-MM-dd(WW)",prefix:S("ui-cal"),first:1,lang:{days:"一,二,三,四,五,六,日"},target:n,triggers:t,value:p,range:{begin:common.now,end:I},onShow:function(){this.setValue(this.target.value)},onPick:function(e){p=e.date}});r.render()})}function c(){var e=x("submit");
T.on(e,"mouseover",function(){T.addClass(this,S("submit-hover"))}),T.on(e,"mouseout",function(){T.removeClass(this,S("submit-hover")),T.removeClass(this,S("submit-press"))}),T.on(e,"mousedown",function(e){0==e.button&&T.addClass(this,S("submit-press"))}),T.on(e,"mouseup",function(e){0==e.button&&T.removeClass(this,S("submit-press"))}),e=null}function u(){D&&clearTimeout(D),D=setTimeout(function(){var e=s("fromcity");e=s("tocity")&&e;var t=y();e&&t.tocity==t.fromcity&&(e=0,m("tocity","不能和出发城市相同"),q("tocity").select()),e&&(at.weekPrice.reset(g(p)),C.fire("query",y()))
},200)}function s(e){if(A[e])return!1;var t=q(e),n=t.value;if(!n)return m(e),!1;var r=L[e].value||null;if(r&&n!=r)return m(e),!1;if(r&&n==r){var a=L[e].data.enable;if(!a)return f(e),!1}return"fromcity"==e?v=n:h=n,!0}function f(e){m(e,"对不起，不支持该目的地")}function m(e,t){var n="请输入正确的"+("fromcity"==e?"出发城市":"到达城市");t&&(n=t);var r=d(e);r.innerHTML='<p class="'+S("error")+'">'+n+"</p>",common.showLayer(r,q(e))}function l(e){var t=T.q(S("layer"),common.queryByClass("query-item"));e?(t=d(e),common.hideLayer(t)):T.each(t,function(e){common.hideLayer(e)
})}function d(e){var t=q(e);return T.dom.next(T.dom.next(t))}function y(){var e=g(p),t=function(e){return common.formatDate(e,"yyyy-MM-dd")};return{fromcity:v,tocity:h,fromdate:t(p),dateRange:[t(e.begin),t(e.end)].join(",")}}function g(e){var t=w(e,-3),n=w(e,3);return common.now>t&&(t=common.now,n=w(t,6)),n>I&&(n=I,t=w(n,-6)),{begin:t,end:n}}var v,h,p,b,C=new common.Observable,w=common.afterDays,q=common.getInput;common.addIniter(function(){p=w(common.now,2),v=TPLDATA.FROM_CITY,h=TPLDATA.TO_CITY,L={fromcity:{value:v,data:{enable:1}},tocity:{value:h,data:{enable:1}}},e("fromcity"),e("tocity"),common.queryByClass("exchange").onclick=o,a();
var t=q("cal");t.value=common.date2HumanStyle(p),T.browser.ie&&(t.onselectstart=function(){return!1}),t.onfocus=function(){this.blur()},i(),c();var n=common.queryTags(common.queryByClass("query"),"form")[0];T.on(n,"submit",function(){u()}),T.on(document,"click",function(e){var t=T.event.getTarget(e),n=t.id&&~t.id.indexOf("tangram-suggestion"),r=d("fromcity"),a=d("tocity");n||t.parentNode==r||l("fromcity"),n||t.parentNode==a||l("tocity")})});var D,k={fromcity:v,tocity:h},A={fromcity:0,tocity:0},L={fromcity:{},tocity:{}},S=common.getClass,x=common.queryByClass,I=w(common.now,211);
return C.on("update",function(e){p=e;var t=q("cal");t.value=common.date2HumanStyle(p),C.fire("query",y())}),C.get=y,C.getDateRange=function(){return g(p)},C}(),at.weekPrice=function(){function e(){var e=common.queryByClass("weekprice");t(common.afterDays(common.now,2)),T.event.on(e,"click",function(e){var n=T.event.getTarget(e);if(("EM"==n.tagName||"P"==n.tagName)&&(n=n.parentNode),"LI"==n.tagName){var r=common.str2Date(n.getAttribute("data-date"));t(r),at.query.fire("update",r)}})}function t(e){var t;n(function(n){t=n.getAttribute("data-date"),T.removeClass(n,common.getClass("cur")),t&&common.formatDate(e,"yyyy-MM-dd")==t&&T.addClass(n,common.getClass("cur"))
}),s=e}function n(e){T.each(common.queryTags(common.queryByClass("weekprice"),"li"),e||Function())}function r(e){if(e&&0!=e instanceof Array){for(var t,n=[],r=0;t=e[r];r++)t.shortdate=t.date.replace(/^\d{4}-/,""),t.price=t.price?"¥"+t.price:"查看",n[r]=T.format(m,t);common.queryByClass("weekprice").innerHTML=n.join("")}}function a(e,t){if(e){for(var n=[],a=0;7>a;a++){var o=common.formatDate(common.afterDays(e.begin,a),"yyyy-MM-dd");n[a]={date:o,shortdate:o.replace(/^\d{4}-/,""),price:t?"查看":" "}}r(n)}}function o(e){if(0==e instanceof Array)return!1;
for(var t=0,r=e.length;r>t;t++)n(function(n){if(T.getAttr(n,"data-date")==e[t].date){var r=e[t].price?"¥"+e[t].price:"查看";common.queryTags(n,"em")[0].innerHTML=r}})}function i(){T.removeClass(common.queryByClass("weekprice"),common.getClass("hide"))}function c(){T.addClass(common.queryByClass("weekprice"),common.getClass("hide"))}function u(){var e={};return n(function(t){var n=t.getAttribute("data-date");if(n&&common.formatDate(s,"yyyy-MM-dd")==n){e.date=n;var r=common.queryTags(t,"em")[0].innerHTML;return r=r.match(/\d+/),r=r?r[0]:"",e.price=r,e
}}),e}var s,f=new common.Observable;common.addIniter(function(){e()});var m='<li data-date="#{date}" class="OP_LOG_OTHERS"><p>#{shortdate}&nbsp;#{weekday}</p><em>#{price}</em></li>';return f.update=o,f.render=r,f.set=t,f.get=u,f.reset=a,f.show=i,f.hide=c,f}(),at.queryBar=function(){var e={},t=common.queryByClass,n=common.queryTags(t("resultinfo"),"i");return e.set=function(e,t){switch(n[0].innerHTML=t.fromcity,n[1].innerHTML=t.tocity,e){case"loading":stateText="正在搜索中...";break;case"over":default:stateText="搜索到<em>"+(t.count||0)+"</em>个航班信息，搜索结束"
}},e}(),at.filter=function(){function e(){function e(){T.each(o,function(e){T.addClass(e,a)})}function t(){T.each(o,function(e){T.removeClass(e,a)})}var n=common.queryByClass("filter-trigger"),r=d("expand");T.event.on(n,"click",function(){var n=this;T.dom.hasClass(n,r)?(n.innerHTML=y,T.removeClass(n,r),e()):(n.innerHTML=g,T.addClass(n,r),t()),0==at.flightData.getTimes()&&at.query.fire("query",at.flightData.getLastQuery())});var a=d("hide"),o=card.q(d("filter-more"));n=null}function t(e){T.event.on(e,"click",function(e){var t,n=T.event.getTarget(e);
switch(n.tagName){case"LABEL":var r=common.prev(n);r.checked=!r.checked,t=1;break;case"INPUT":t=1}t&&(o(this),l.fire("change",a()))}),e=null}function n(e){T.each(card.q(d("option")),e||Function())}function r(){var e={};return n(function(t){var n=t.getAttribute("data-filter-key");e[n]=o(t)}),e}function a(){var e=r(),t={};for(var n in e)t["cond_"+n]=e[n].join(",");return t}function o(e){var t=[];return T.each(common.queryTags(e,"input"),function(e){"checkbox"==e.type&&e.checked&&t.push(e.value)}),t}function i(e){var t=!1;
return T.each(e.getElementsByTagName("input"),function(e){"checkbox"==e.type&&(t=t||e.checked,e.checked=!1)}),t}function c(e){n(function(t){var n=t.getAttribute("data-filter-key"),r=e[n];r&&u(t,r)})}function u(e,t){var n=common.queryTags(e,"p")[0];n.innerHTML="";var r="addClass";if(t.length){r="removeClass";for(var a,o=[],i=0;a=t[i];)o[i++]=T.format(v,a);n.innerHTML=o.join("")}T[r](e,d("hide"))}function s(){n(function(e){i(e)})}function f(){common.queryByClass("ft-wrap"),T.addClass(common.queryByClass("ft-wrap"),common.getClass("hide"))
}function m(){common.queryByClass("ft-wrap"),T.removeClass(common.queryByClass("ft-wrap"),common.getClass("hide"))}var l=new common.Observable;common.addIniter(function(){e(),n(function(e){t(e)})});var d=common.getClass,y="更多筛选条件<b>&nbsp;&nbsp;</b>",g="收起筛选条件<b>&nbsp;&nbsp;</b>",v='<span class="OP_LOG_OTHERS"><input type="checkbox" value="#{value}" /><label>#{name}</label></span>';return l.reset=s,l.render=c,l.get=r,l.show=m,l.hide=f,l.getBizData=a,l}(),at.flightData=function(){function e(){return i}function t(e,t){n(e),e.sessionID=TPLDATA.SESSION_ID,e.originQuery=TPLDATA.ORIGIN_QUERY,e.pssid=TPLDATA.STATS_PSSID,e.t=(new Date).getTime();
var r=TPLDATA.URL_QUERY;r+=(r.indexOf("?")>-1?"&":"?")+T.url.jsonToQuery(e,function(e){return/[^\x00-\xFF]/.test(e)?encodeURIComponent(e):e}),common.request(r,function(e){i=1,o=T.extend(o,e.stats||{}),o.page=e.page,T.dom.setAttr(common.queryByClass("main"),"data-click",common.getStatsAttr(o,!0)),t("",e)},function(e){t("error",e)})}function n(e){for(var t in c)null!=e[t]&&(c[t]=e[t])}function r(e,t){c=e;var n=T.extend({},e);return T.each(t,function(e){n=T.extend(n,e)}),n}var a={},o={};a.getStatsData=function(e){var t=T.extend({},o);
return e&&"object"==typeof e&&(t=T.extend(t,e)),t};var i=0,c={};return a.getLastQuery=function(){var e=T.extend({},c);return e},common.addIniter(function(){o={sessionid:TPLDATA.SESSION_ID,subqid:TPLDATA.STATS_SUBQID,sid:TPLDATA.STATS_SID},c=T.extend({},at.query.get())}),a.request=t,a.merge=r,a.getTimes=e,a}(),at.query.on("query",function(e){at.queryBar.set("loading",e);var t=common.str2Date(e.fromdate);at.timer.update(),at.list.setState("loading"),at.list.reset(),at.filter.hide(),at.weekPrice.hide(),at.flightData.request(e,function(e,n){n.weekprice&&7==n.weekprice.length?(at.weekPrice.render(n.weekprice),at.weekPrice.set(t)):at.weekPrice.reset(at.query.getDateRange(),1),at.weekPrice.show(),n.count&&(at.filter.reset(),at.filter.render({airline:n.cond_airline||[],airport:n.cond_airport||[]}),at.filter.show()),e?at.list.setState("empty"):at.list.render(n)
})});var timerFilterChange;at.filter.on("change",function(e){timerFilterChange&&clearTimeout(timerFilterChange);var t=at.flightData.getLastQuery(),n=at.list.getData(),r=at.flightData.merge(t,[e,n]);r.page=0,r.bycondition=1;var a=at.flightData.getTimes();0==a&&(at.list.setState("loading"),r.bycondition=0),timerFilterChange=setTimeout(function(){at.flightData.request(r,function(e,t){e?at.list.setState("empty"):(at.list.render(t),t.weekprice&&at.weekPrice.update(t.weekprice)),0==a&&t.cond_airport&&t.cond_airline&&at.filter.render({airline:t.cond_airline||[],airport:t.cond_airport||[]})
})},300)}),card.ready(function(){common.init()});
    at.list=function(){function t(){T.on(E,"mouseup",M),T.on(E,"mousedown",N)}function e(t){return"expanded"==T.getAttr(t,"data-expanded")?!0:!1}function a(t,e){var i=T.dom.getPosition(t).top-T.page.getScrollTop();t.className=t.className.replace(/expanded|collapsed/g,e?"expanded":"collapsed"),T.setAttr(t,"data-expanded",e?"expanded":"collapsed"),t.getElementsByTagName("button")[0].innerHTML=e?"收起详情":"查看详情",e?(w&&w!==t&&a(w,0),w=t,setTimeout(function(){window.scroll(0,T.dom.getPosition(t).top-i)},5)):w=null}function i(t){if(at.timer.judge()){do if("li"==t.nodeName.toLowerCase())break;
while((t=t.parentNode)&&1==t.nodeType);if(e(t))return a(t,0),void 0;var i=T.getAttr(t,"data-index");if(I[i])return a(t,1),void 0;var r=k({},A,at.flightData.getLastQuery(),{flightcode:T.getAttr(t,"data-code"),deptAirportkey:T.getAttr(t,"data-dac"),arriAirportkey:T.getAttr(t,"data-aac")});require(["flyticket_agency"],function(e){e.QUERY_URL=TPLDATA.URL_AGENCY+(-1==TPLDATA.URL_AGENCY.indexOf("?")?"?":"&")+T.url.jsonToQuery(at.flightData.getStatsData()),e.QUERY_TGQ_URL=TPLDATA.URL_TGQ+(-1==TPLDATA.URL_TGQ.indexOf("?")?"?":"&")+T.url.jsonToQuery(at.flightData.getStatsData());
var n=T.Q("ecl-left_airticket-flight-order-list",t)[0],o=new e(n,r);I[i]=o,a(t,1),o.render(),o.onOrder=function(){return at.timer.judge()},o.onLoad=function(e){var a=e.realLowestPrice,i=e.realLowestDiscount,r=T.Q("ecl-left_airticket-flight-property-lowest-offer",t)[0],n=r.getElementsByTagName("b")[0],o=r.getElementsByTagName("p")[0];i>=10?T.addClass(r,"no-discount"):T.removeClass(r,"no-discount"),o.innerHTML=i+"折",n.innerHTML!=a&&(v(a),n.innerHTML=a)}})}}function r(){P&&(P.onclick=null,P.parentNode.removeChild(P),P=null,n())
}function n(){for(var t=-1,e=E.getElementsByTagName("li"),a=e.length-1;a>=0;a--)!y(e[a],"hide")&&a>t&&(t=a),T.removeClass(e[a],"last");T.addClass(e[t],"last")}function o(t,e){return G?(void 0!==t&&void 0!==e&&(G.total=t-0,G.page=e-0,G.render()),R.style.display="block",void 0):(require(["ecom/ui/pager"],function(a){G=new a({main:T.Q("ecl-left_airticket-flight-pager")[0],page:1,total:t,prefix:common.getClass("flight-pager"),lang:{prev:"上一页",next:"下一页"}}),G.on("change",function(t){if(at.timer.judge()){var e=k({},h,{page:t.page});
window.scroll(0,T.dom.getPosition(D).top||0),p(e)}}),void 0!==t&&void 0!==e&&(G.total=t-0,G.page=e-0,G.render()),R.style.display="block"}),void 0)}function c(){R.style.display="none"}function s(t){var e,a=[];for(e=0;t.length>e;e++)t[e].index=e,a[e]=1==t[e].directFlag||t[e].unionSpecial?l(t[e]):f(t[e]);E.innerHTML=a.join(""),!b&&t.length>5&&(T.each(E.getElementsByTagName("li"),function(t,e){e>=5&&T.addClass(t,"hide")}),T.addClass(D,"has-more")),T.each(T.Q("ecl-left_airticket-flight-extra"),function(t){t.firstChild&&T.addClass(t.firstChild,"first")
}),n()}function l(t){var e=t.trip[0],a=T.format(at.list.FLIGHT_DIRECT_INFO_BASIC_TEMPLATE,{name:u(e),time:d(e),airport:T.format(at.list.FLIGHT_AIRPORT,e),price:m(t),toggler:T.format(at.list.FLIGHT_TOGGLER,t)}),i=T.format(at.list.FLIGHT_INFO_EXTRA,{fdt:e.fdt?T.format(at.list.FLIGHT_DT,e):"",tax:e.fdt&&e.fdt?T.format(at.list.FLIGHT_TAX,e):"",meal:T.format(at.list.FLIGHT_MEAL,{meal:e.meal?"有":"无"}),zj:e.zj?at.list.FLIGHT_ZJ:""});return T.format(at.list.FLIGHT_TEMPLATE,{basic:a,extra:i,type:"direct",index:t.index,flightCode:t.flightCode,aac:e.arriAirportkey,dac:e.deptAirportkey})
}function f(t){var e=t.trip[0],a=t.trip[1],i=T.format(at.list.FLIGHT_TRANSIT_INFO_BASIC_ITEM_TEMPLATE,{name:u(e),time:T.format(at.list.FLIGHT_TIME,e),airport:T.format(at.list.FLIGHT_AIRPORT,e)}),r=T.format(at.list.FLIGHT_TRANSIT_INFO_BASIC_ITEM_TEMPLATE,{name:u(a),time:T.format(at.list.FLIGHT_TIME,a),airport:T.format(at.list.FLIGHT_AIRPORT,a)}),n=T.format(at.list.FLIGHT_TRANSIT_INFO_BASIC_TEMPLATE,{first:i,second:r,transcity:t.transcity,price:m(t),toggler:at.list.FLIGHT_TOGGLER});return T.format(at.list.FLIGHT_TEMPLATE,{basic:n,extra:"",type:"transit",index:t.index,flightCode:t.flightCode})
}function u(t){return T.format(at.list.FLIGHT_NAME,{logo:t.logo,carrierName:t.carrierName,code:t.code,planeName:t.planeName,sp:t.sp?'<em href="#" title="该航班是经停航班">经停</em>':""})}function d(t){var e=t.arriveTime,a=t.departTime;return T.format(at.list.FLIGHT_TIME,{departTime:a,arriveTime:e,addday:e.replace(":","")<a.replace(":","")?"<em></em>":""})}function m(t){return T.format(at.list.FLIGHT_LOWEST_OFFER,{discount:t.lowestDiscount>=10?"no-discount":"",lowestPrice:t.lowestPrice,lowestDiscount:t.lowestDiscount})
}function g(){for(var t=0;I.length>t;t++)I[t]&&I[t].dispose(),I[t]=null;w=null}function v(t){var e=at.weekPrice.get();if(e.price>t)return at.weekPrice.update([{date:e.date,price:t}]),void 0;var a=0,i=at.filter.getBizData();for(var r in i)i[r]&&(a=1);if(1==C.totalPage||!a&&"price"==h.orderBy&&("asc"==h.order&&0==h.page||"desc"==h.order&&h.page==C.totalPage-1)){var n=Number.MAX_VALUE;T.each(T.Q("ecl-left_airticket-flight-property-lowest-offer",E),function(t){var e=t.getElementsByTagName("b")[0],a=e.innerHTML-0;
n=a>=n?n:a}),at.weekPrice.update([{date:e.date,price:n}])}}function p(t){1!=O.__isLoading&&(t=k(at.flightData.getLastQuery(),at.filter.getBizData(),t,{byCondition:1}),O.__isLoading=1,at.flightData.request(t,function(t,e){return O.__isLoading=0,t?(B("empty"),void 0):(flightsData=e.flight,O.render(e),e.weekprice&&at.weekPrice.update(e.weekprice),void 0)}))}var h={order:"asc",orderBy:"price",page:0},y=T.dom.hasClass,_=function(t,e){y(t,e)?T.removeClass(t,e):T.addClass(t,e)},k=function(t){for(var e=Array.prototype.slice.call(arguments,1),a=0,i=e.length;i>a;a++)T.extend(t,e[a]);
return t},L=function(t,e){return card.qq(t,e)},C=card.data.AT_LIST_DATA,I=[],A={sessionID:card.data.AIRTICKET_LEFT.SESSION_ID,originQuery:card.data.AIRTICKET_LEFT.ORIGIN_QUERY},w=null,b=0,D=L("ecl-left_airticket-flight-list-box");L("ecl-left_airticket-flight-header");var E=L("ecl-left_airticket-flight-list"),x=L("ecl-left_airticket-flight-empty-box"),F=L("ecl-left_airticket-flight-loading-box"),q=L("ecl-left_airticket-flight-timeout-box"),P=L("ecl-left_airticket-flight-expandor"),S=L("ecl-left_airticket-flight-header-time"),H=L("ecl-left_airticket-flight-header-lowest-offer"),M=function(t){var e=T.event.getTarget(t||window.event);
y(e,"ecl-left_airticket-flight-toggler")&&(T.removeClass(e,"active"),i(e))},N=function(t){var e=T.event.getTarget(t||window.event);y(e,"ecl-left_airticket-flight-toggler")&&T.addClass(e,"active")};(function(){T.on(S,"click",function(){at.timer.judge()&&(T.removeClass(H,"ecl-left_airticket-asc ecl-left_airticket-desc"),T.addClass(H,"ecl-left_airticket-normal"),T.setAttr(H,"title",""),y(this,"ecl-left_airticket-normal")&&(T.removeClass(this,"ecl-left_airticket-normal"),T.addClass(this,"ecl-left_airticket-desc")),_(this,"ecl-left_airticket-asc"),_(this,"ecl-left_airticket-desc"),y(this,"ecl-left_airticket-asc")?(this.title="按时间从早到晚排序",h.order="asc"):(this.title="按时间从晚到早排序",h.order="desc"),h.page=0,h.orderBy="time",p(h))
}),T.on(H,"click",function(){at.timer.judge()&&(T.removeClass(S,"ecl-left_airticket-asc ecl-left_airticket-desc"),T.addClass(S,"ecl-left_airticket-normal"),T.setAttr(S,"title",""),y(this,"ecl-left_airticket-normal")&&(T.removeClass(this,"ecl-left_airticket-normal"),T.addClass(this,"ecl-left_airticket-desc")),_(this,"ecl-left_airticket-asc"),_(this,"ecl-left_airticket-desc"),y(this,"ecl-left_airticket-asc")?(this.title="按价格从低到高排序",h.order="asc"):(this.title="按价格从高到低排序",h.order="desc"),h.orderBy="price",h.page=0,p(h))
})})(),function(){P&&(P.onclick=function(){C.totalPage>1?o(C.totalPage,0):c(),T.removeClass(D,"has-more"),b=1,T.each(E.getElementsByTagName("li"),function(t){T.removeClass(t,"hide")}),0==at.flightData.getTimes()&&at.filter.fire("change",at.filter.getBizData()),r()})}();var G,R=T.Q("ecl-left_airticket-flight-pager-box",D)[0],B=function(){var t={normal:D,loading:F,empty:x,timeout:q};return function(e){for(var a in t)(a==e?T.show:T.hide)(t[a])}}(),O={render:function(t){var e=t.flight,a=t.page,i=t.totalPage,r=t.count;
return r&&i&&e.length?(g(),B("normal"),s(e),!i||1>=i||!b?c():o(i,a),b||(5>=t.count?T.hide:T.show)(P),C.totalPage=i,void 0):(B("empty"),void 0)},setState:B,getData:function(){return h},reset:function(){h.order="asc",h.orderBy="price",T.removeClass(S,"ecl-left_airticket-asc ecl-left_airticket-desc"),T.addClass(S,"ecl-left_airticket-normal"),T.removeClass(H,"ecl-left_airticket-desc ecl-left_airticket-normal"),T.addClass(H,"ecl-left_airticket-asc")}};return t(),c(),O}(),at.list.FLIGHT_NAME='<div class="ecl-left_airticket-flight-property-name"><img src="#{logo}" ><h4>#{carrierName}#{code}</h4><p>#{planeName}#{sp}</p></div>',at.list.FLIGHT_TIME='<div class="ecl-left_airticket-flight-property-time"><h4>#{departTime}</h4><p>#{arriveTime}#{addday}</div>',at.list.FLIGHT_AIRPORT='<div class="ecl-left_airticket-flight-property-airport"><h4>#{departAirportName}#{departTerminal}</h4><p>#{arriveAirportName}#{arriveTerminal}</p></div>',at.list.FLIGHT_LOWEST_OFFER='<div class="ecl-left_airticket-flight-property-lowest-offer #{discount}"><h4>¥ <b>#{lowestPrice}</b></h4><p>#{lowestDiscount}折</p></div>',at.list.FLIGHT_TOGGLER='<button type="button" class="ecl-left_airticket-flight-toggler OP_LOG_BTN"data-click="{fm:\'behz\',flightCode:\'#{flightCode}\'}"onmouseover="T.addClass(this,\'over\');"onmouseout="T.removeClass(this, \'over\')">查看详情</button>',at.list.FLIGHT_DIRECT_INFO_BASIC_TEMPLATE="#{name}#{time}#{airport}#{price}#{toggler}",at.list.FLIGHT_TRANSIT_INFO_BASIC_TEMPLATE='<div class="ecl-left_airticket-flight-transit-box"><div class="ecl-left_airticket-flight-transit-first">#{first}</div><div class="ecl-left_airticket-flight-transit-second">#{second}</div><div class="ecl-left_airticket-flight-transit-sep">#{transcity}(航班均需缴纳税费)</div></div>#{price}#{toggler}',at.list.FLIGHT_TRANSIT_INFO_BASIC_ITEM_TEMPLATE="#{name}#{time}#{airport}",at.list.FLIGHT_INFO_EXTRA="#{fdt}#{tax}#{meal}#{zj}",at.list.FLIGHT_DT="<span>飞行#{fdt}</span>",at.list.FLIGHT_TAX="<span>机建/燃油：¥#{acf}&nbsp;/&nbsp;¥#{fot}</span>",at.list.FLIGHT_MEAL="<span>#{meal}餐食</span>",at.list.FLIGHT_ZJ="<span>有网上值机</span>",at.list.FLIGHT_TEMPLATE='<li class="ecl-left_airticket-flight-#{type}-collapsed"data-index="#{index}"data-aac="#{aac}"data-dac="#{dac}"data-code="#{flightCode}"><div class="ecl-left_airticket-flight-info"onmouseover="this.className=\'ecl-left_airticket-flight-info-over\'"onmouseout="this.className=\'ecl-left_airticket-flight-info\'"><div class="ecl-left_airticket-flight-basic">#{basic}</div><div class="ecl-left_airticket-flight-extra">#{extra}</div></div><div class="ecl-left_airticket-flight-order-list"></div></li>';

    define("flyticket_agency_template",function(){return{airticket_detail_table_list:function(_template_object){var _template_fun_array=[],fn=function(__data__){var _template_varName="";for(name in __data__)_template_varName+="var "+name+'=__data__["'+name+'"];';eval(_template_varName),_template_fun_array.push(' <table class="ecl-left_airticket-list" cellspacing="0" cellpadding="0"> ');for(var i=0,t;t=agencylist[i];i++)_template_fun_array.push(" <tr"),i==agencylist.length-1&&_template_fun_array.push(' class="item-last"'),_template_fun_array.push('> <td class="column-site"> <span class="site-icon" title="供应商已获得《中国民用航空运输销售代理业务资格认可证书》"></span> <p class="site-link">',t.name===void 0?"":t.name,'</p> <div class="star-number"> <div class="star-number-gray"> <div class="star-number-orange" style="width:',20*t.star===void 0?"":20*t.star,'%;"></div> </div> </div> <span>来自',t.starnum===void 0?"":t.starnum,'位用户</span> </td> <td class="column-change"> '),t.tgq&&_template_fun_array.push(' <div data-cabin="',t.cabin===void 0?"":t.cabin,'" data-price="',t.price[0]===void 0?"":t.price[0],'" data-policyid="',t.policyID===void 0?"":t.policyID,'" data-vendorid="',t.vendorid===void 0?"":t.vendorid,'" class="tgq-change-wrapper"> <div class="item-info-note"> <div class="note-arrow-top"></div> <div class="note-arrow-top-mark"></div> <div class="note-content"> <div class="note-content-container">',t.tgq.replace(/\|/g,"<br>")===void 0?"":t.tgq.replace(/\|/g,"<br>"),"</div> </div> </div>退改签</div> "),_template_fun_array.push(" "),t.seatype&&(_template_fun_array.push(" <div> "),1==t.seatype?_template_fun_array.push(' <em class="head-seat"></em> '):2==t.seatype&&_template_fun_array.push(' <em class="bus-seat"></em> '),_template_fun_array.push(" </div> ")),_template_fun_array.push("  "),t.tgq||t.seatype||_template_fun_array.push("&nbsp;"),_template_fun_array.push(' </td> <td class="column-price"> <p> <span class="price-text">￥',t.price[0]===void 0?"":t.price[0],"</span> "),t.afee&&_template_fun_array.push(' <span class="afee-info">+',t.afee===void 0?"":t.afee,"保险</span> "),_template_fun_array.push(" </p> "),t.dis&&10>t.dis&&_template_fun_array.push(' <p> <span class="price-info">',t.dis===void 0?"":t.dis,"折</span> </p> "),_template_fun_array.push(' </td> <td class="column-order"> <a target="_blank" href="',t.link+(t.link.indexOf("?")>=0?"&":"?")+"prt="+(t.afee?1:0)===void 0?"":t.link+(t.link.indexOf("?")>=0?"&":"?")+"prt="+(t.afee?1:0),'" data-btn="order" class="order-btn">预订</a> </td> </tr> ');
_template_fun_array.push(" </table> "),_template_varName=null}(_template_object);return fn=null,_template_fun_array.join("")},airticket_detail_share:function(_template_object){var _template_fun_array=[],fn=function(__data__){var _template_varName="";for(name in __data__)_template_varName+="var "+name+'=__data__["'+name+'"];';eval(_template_varName),_template_fun_array.push(' <div class="ecl-left_airticket-detail"> <div class="ecl-left_airticket-list-container"></div> </div> '),_template_varName=null}(_template_object);
return fn=null,_template_fun_array.join("")}}}),define("flyticket_agency",["flyticket_agency_template"],function(t){var e=A.baidu,a=e.dom.getAttr,i={gongxiang:1},n=function(r,o){function c(){baidu.g(r).innerHTML='<div class="ecl-left_airticket-list-error">抱歉，没有获取到结果。</div>'}function s(t,a,i){return e.ajax.request(t,{timeout:A.AJAX.TIMEOUT,onsuccess:function(t,n){try{var r=e.json.parse(n)}catch(o){return i(o),void 0}0==r.status?a(r.data):i("loaderror")},ontimeout:i,onfailure:i})}function l(t,a){var i=t+(t.indexOf("?")>=0?"&":"?")+e.url.jsonToQuery(a,function(t){return/[^\x00-\xFF]/.test(t)?encodeURIComponent(t):t
});return i}function u(t,e,a){return s(l(n.QUERY_URL,t),e,a)}function f(t,e,a){return s(l(n.QUERY_TGQ_URL,t),e,a)}function d(a){var i=t.airticket_detail_table_list;if(a.trip);else{var n=e.q(w.list,r)[0];n||(r.innerHTML=t.airticket_detail_share(a),n=e.q(w.list,r)[0]),n.innerHTML=i(a),m()}}function m(){setTimeout(function(){e.array.each(e.q(w.tgq,r),function(t){t.onmouseover=p})},0)}function T(t){var i=e.q(w.tgqnote,t)[0];if(!i.__loaded){i.__store||(i.__store=i.innerHTML),i.innerHTML='<div class="tgq-loading"><em></em>正在加载...</div>';
var n={};e.array.each(C,function(t){n[t]=o[t]||""});var r={sessionID:n.sessionID,originQuery:n.originQuery,flightNum:n.flightcode,deptAirport:n.deptAirportkey,arrAirport:n.arriAirportkey,deptDate:n.fromdate};r.printPrice=a(t,"data-price"),r.wrapperId=a(t,"data-vendorid"),r.policyId=a(t,"data-policyid"),r.cabin=a(t,"data-cabin"),f(r,function(t){i.innerHTML=t.tgq?t.tgq.replace(/\|/g,"<br>"):i.__store,i.__loaded=1},function(){i.innerHTML=i.__store})}}function g(t){var a=e.event.getTarget(t||window.event);q=setTimeout(function(){v(a)
},x)}function p(t){t=t||window.event;var a=e.event.getTarget(t);if(!e.dom.hasAttr(a,"data-vendorid")){for(;a&&!e.dom.hasAttr(a,"data-vendorid");)a=a.parentNode;return D===a&&(clearTimeout(q),a.onmouseout=g),void 0}a.onmouseout=function(t){var a=e.event.getTarget(t||window.event);e.dom.hasAttr(a,"data-vendorid")&&clearTimeout(E)},E=setTimeout(function(){T(a),D===a&&clearTimeout(q),a.className=w.tgqover,a.onmouseout=g,D=a},x)}function v(t){if(!e.dom.hasAttr(t,"data-vendorid"))for(;t&&!e.dom.hasAttr(t,"data-vendorid");)t=t.parentNode;
t.className=w.tgq}function _(t){var i=e.event.getTarget(t);return"order"==a(i,"data-btn")&&!1===I.onOrder(I)?(e.event.preventDefault(t),void 0):void 0}function y(){return e.event.on(r,"click",_),I}function h(){var t={};e.array.each(b,function(e){t[e]=o[e]||""}),u(t,function(t){d(t),I.onLoad&&I.onLoad(t)},c)}function k(){e.array.each(e.q(w.tgq,r),function(t){t.onmouseover=null,t.onmouseout=null})}function L(){e.event.un(r,"click",_),k(),r.innerHTML=""}var I=this;i.gongxiang;var b=["sessionID","originQuery","fromcity","tocity","fromdate","dateRange","flightcode"],C=["sessionID","originQuery","fromdate","flightcode","deptAirportkey","arriAirportkey","price","vendorid","policyid","cabin"],w={tgq:"tgq-change-wrapper",tgqover:"tgq-change-wrapper-hover",tgqnote:"note-content-container",list:"ecl-left_airticket-list-container"},D=null,q=0,E=0,x=80;
return this.onOrder=e.fn.blank,this.onLoad=e.fn.blank,this.dispose=L,this.render=h,y()};return n.QUERY_URL="",n.QUERY_TGQ_URL="",n});
} );
</script>
{%/block%}
