{%extends 'c_base.tpl'%} {%block name='data_modifier'%}{%$tplData.url=$tplData.titleUrl%}{%/block%}{%block name='content'%}<style data-merge>{%fe_fn_c_css css='input'%}{%fe_fn_c_css css='btn'%}{%fe_fn_c_css css='img'%}.op-mapcity-gray{color:#999}.op-mapcity-btm{margin-bottom:15px}.op-mapcity-just{text-align:justify}.op-mapcity-showurl{position:absolute;width:100%;left:315px;bottom:0}</style><div class="c-row">{%if !$tplData.mapimg%} <p>{%$tplData.abs|limitlen:164|escape:'html'|highlight:0%}</p> <p> <span class="c-showurl">{%$tplData.showurl|escape:'html'%}</span> </p>{%else if $tplData.schtitle%} <div class="c-span12" style="position:relative"> <a href="{%$tplData.url%}" target="_blank" class="op-mapcity-mapimg"> <img class="c-img c-img12" src="{%$tplData.mapimg%}" /> </a> <p class="op-mapcity-showurl"> <span class="c-showurl">{%$tplData.showurl|escape:'html'%}</span> </p> </div> <div class="c-span12 c-span-last"> <p class="op-mapcity-btm op-mapcity-just">{%$tplData.abs|limitlen:78|escape:'html'|highlight:0%}</p> <p class="c-gap-bottom-small">{%$tplData.schtitle|limitlen:38|escape:'html'%}</p> <form  class="op-mapcity-form" name="opmap" target="_blank" method="post" action=""> <p> <span class="c-gap-icon-right"> <input class="c-input c-input12  op-mapcity-gray op-mapcity-input" value="{%$tplData.schabs|limitlen:78|escape:'html'%}" > </span> </p> <p class="c-gap-top op-mapcity-btm"> <a href="#" target="_blank"  onclick="return false;" class="c-btn c-btn-primary op-mapcity-submit">{%$tplData.submit%}</a> </p> </form> </div>{%else%} <div class="c-span6"> <a href="{%$tplData.url%}" target="_blank"> <img class="c-img c-img6" src="{%$tplData.mapimg%}" /> </a> </div> <div class="c-span18 c-span-last"> <p>{%$tplData.abs|limitlen:240|escape:'html'|highlight:0%}</p> <p><span class="c-showurl">{%$tplData.showurl|escape:'html'%}</span></p> </div>{%/if%}</div><script type="text/javascript" >
A.setup({
    citycode : '{%$tplData.areacode%}',
	mapurl : '{%$tplData.mapurl%}',
	titleUrl : '{%$tplData.titleUrl%}',
	labelplace : '{%$tplData.labelplace%}'
});
</script><script data-merge>A.setup(function(){var _this = this;var $ipt=_this.find('.op-mapcity-input');if($ipt.length>0){var ss=$ipt.val();var fm=_this.find('.op-mapcity-form')[0];var citycode = _this.data.citycode; var mapurl= _this.data.mapurl;var labelplace= _this.data.labelplace;$ipt.on('blur', function() {if(!$ipt.val()){$ipt.val(ss);$ipt.css('color','#999');}});$ipt.on('focus', function() {if($ipt.val()==ss){$ipt.val('');}$ipt.css('color','#000');});_this.find('.op-mapcity-submit').on('c{%*i*%}lick', function() {var word = $ipt.val();if(word=="" || word==ss) {fm.action = _this.data.titleUrl;fm.submit();}else{word = "&wd="+word+"&c="+citycode; word = encodeURIComponent(word); fm.action = mapurl+word;fm.submit();} });function preventEvt(e){if ( e && e.preventDefault ){e.preventDefault();}else{window.event.returnValue = false;}} $(fm).on('submit',(function(){return function(e){var word = $ipt.val(); if(word=="") {$ipt.focus();preventEvt(e);return false;}else{word = "&wd="+word+"&c="+city{%*i*%}code; word = encodeURIComponent(word); fm.action = mapurl+word; return true;} };})() );}});</script>{%/block%}{%block name="foot"%}{%/block%}