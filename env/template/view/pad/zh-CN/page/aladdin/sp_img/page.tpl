{%extends 'c_base.tpl'%} {%block name='title'%}{%/block%}{%block name="data_modifier"%}{%$extData.feData.fm='alop'%}{%/block%}{%block name='content'%}{%$escaped_imgtotalwidth=610%}<style data-merge>#ala_img_report a{color:#77c}#ala_img_pics{position:relative}#ala_img_pics input{position:absolute;display:none;bottom:3px;right:3px;border:1px solid #CCC;background:#fafafa;width:36px;height:23px;padding:0 4px;text-align:center;cursor:pointer;opacity:.8;white-space:nowrap}#ala_img_bigpic{display:inline-block;position:relative;float:left;overflow:hidden;vertical-align:middle;outline:0;_margin-top:1px}#ala_img_desc a{color:#666}</style>{%$textOrImage = $tplData.StdStl%}{%if count($tplData.ImageAladdinResult) == 0%}{%$textOrImage = 1%}{%/if%}{%function name=sp_img_image_rs%}{%$slinklength = 0%}{%foreach $tplData.ImageRsQuerys as $escaped_imgRsWord %}{%*计算子链总长度*%}{%$slinklength = $slinklength + $escaped_imgRsWord|limitlen:20|string_display_len%}{%if $escaped_imgRsWord@iteration > 4 || $slinklength > 56%}{%*如果子链的展现长度之和大于56字节时，则只展现N-1个子链接,最多只展现4个子链*%}{%break%}{%/if%}<a target="_blank" href="http://image.baidu.com/i?tn=baiduimage&ct=201326592&cl=2&lm=-1&st=-1&fm=rs{%$escaped_imgRsWord@iteration|escape%}&fr=ala1&sf=1&fmq=1350297510862_R&pv=&ic=0&nc=1&z=&se=1&showtab=0&fb=0&width=&height=&face=0&istype=2&ie=utf-8&word={%urlencode($escaped_imgRsWord)%}" style="margin-right:15px">{%$escaped_imgRsWord|limitlen:20|highlight:4%}</a>{%/foreach%}{%/function%}{%if $textOrImage == 1%}{%if $test%}文字版{%/if%} <h3 class="t"><a target="_blank" href="{%$tplData.TextAladdinSearchUrl%}" ><em>{%$tplData.Query|escape%}</em>_百度图片</a></h3> {%$tplData.TextAladdinTitle|highlight:4%}... {%$imageRsQuerylength = count($tplData.ImageRsQuerys)%} {%if $imageRsQuerylength>0%} <br>相关推荐：{%sp_img_image_rs%} {%/if%} <br/><span class="c-showurl">{%$tplData.TextAladdinShowUrl%} {%$tplData.TextAladdinDate%}</span>{%else if $textOrImage == 2%}{%if $extData.feData.id == 1%}{%if $test%}第一位<br>{%/if%} {%$showType="big"%}{%else%}{%if $test%}不在第一位<br>{%/if%} {%$showType="small"%}{%/if%}{%if count($tplData.ImageAladdinResult)<11%} {%$showType="small"%}{%/if%}{%if $showType=="big"%}{%$escaped_bigImage = $tplData.ImageAladdinResult[0]%}{%$scale = $escaped_bigImage.Width / $escaped_bigImage.Height%}{%$escaped_bigImageLimit = 220%}{%if $scale > 1%} {%$escaped_bigImage.bigWidth = $escaped_bigImageLimit%} {%$escaped_bigImage.bigHeight = floor($escaped_bigImageLimit*$escaped_bigImage.Height/$escaped_bigImage.Width)%}{%else%} {%$escaped_bigImage.bigHeight = $escaped_bigImageLimit%} {%$escaped_bigImage.bigWidth = floor($escaped_bigImageLimit*$escaped_bigImage.Width/$escaped_bigImage.Height)%}{%/if%}{%if $escaped_bigImage.bigHeight < 167%}{%if $test%}高度不足165<br>{%/if%} {%$showType="small"%}{%/if%}{%/if%}{%if $showType=="big"%}{%$showcomplex=1%}{%else%}{%$escaped_bigImage.bigWidth=0%}{%/if%}{%$escaped_imgmargin=0%} <h3 class="t"> <a href="{%$tplData.ImageAladdinSearchUrl%}" target="_blank" data-click="{'fm':'alop'}"><em>{%$tplData.Query|escape%}</em>_百度图片</a>&nbsp;-&nbsp;<span class="OP_LOG_LINK" id="ala_img_report"><a href="#" onclick="return BD.IMG.actions.showReport()">举报图片</a></span></h3> <div id="ala_img_results" class="op_img_content c-gap-top-small c-gap--small" > <div id="ala_img_pics"> {%if $showcomplex%} {%$leftescaped_bigImage = $tplData.ImageAladdinResult[0]%} <a id="ala_img_bigpic" data-click="{'fm':'alop'}" style="margin-right:{%$escaped_imgmargin%}px;width:{%$escaped_bigImage.bigWidth%}px;" target="_blank" href="{%$leftescaped_bigImage.AladdinImageUrl%}"><img id="ala_img_bigimg" style="height:{%$escaped_bigImage.bigHeight%}px;width:{%$escaped_bigImage.bigWidth%}px;" onerror="BD.IMG.err(this)" src="{%if $leftescaped_bigImage.MiddleThumbnailImageUrl%}{%$leftescaped_bigImage.MiddleThumbnailImageUrl%}{%else%}{%$leftescaped_bigImage.LargeThumbnailImageUrl%}{%/if%}" /><input type="button" class="OP_LOG_BTN" value="举报" onclick="BD.IMG.actions.reportPic('{%$leftescaped_bigImage.ImageFromUrl|escape:"javascript"|escape:"html"%}','{%$leftescaped_bigImage.ImageObjUrl|escape:"javascript"|escape:"html"%}','{%$leftescaped_bigImage.ImageID|escape:"javascript"|escape:"html"%}','{%$tplData.Query|escape:"javascript"|escape:"html"%}',this);return false;"/></a> <div id="ala_img_ptline" style="float:left;width:{%$escaped_imgtotalwidth-$escaped_bigImage.bigWidth-$escaped_imgmargin%}px;"></div> <div id="ala_img_pbline" style="float:left;width:{%$escaped_imgtotalwidth-$escaped_bigImage.bigWidth-$escaped_imgmargin%}px;margin-top:{%$escaped_imgmargin%}px;"></div> {%/if%} </div> {%$imageRsQuerylength = count($tplData.ImageRsQuerys)%} {%if $imageRsQuerylength>0%} <div class="c-gap-top-small c-gap-bottom-small">相关推荐：{%sp_img_image_rs%}</div> {%/if%} </div> <span id="ala_img_desc" class="c-showurl">image.baidu.com&nbsp;-&nbsp;<a target="_blank" href="{%$tplData.ImageAladdinSearchUrl%}">查看全部{%$tplData.DisplayTotalCountStr%}张图片</a></span> <script>A.setup(function(){if(typeof(BD)!="undefined"){BD.IMG={}}else{BD={};BD.IMG={}};BD.IMG.fmdata="alop";BD.IMG.query="{%$tplData.Query|escape:"html"%}";BD.IMG.boxwidth={%$escaped_imgtotalwidth-$escaped_bigImage.bigWidth-$escaped_imgmargin%};BD.IMG.boxheight={%if $showcomplex%}105{%else%}95{%/if%};BD.IMG.bleed=5;BD.IMG.margin={%$escaped_imgmargin%};{%if $showcomplex%}BD.IMG.complex=1;{%/if%}BD.IMG.pics = [{%section loop=$tplData.ImageAladdinResult name=i%}{%$imageItem=$tplData.ImageAladdinResult[i]%}{%if $smarty.section.i.index!= 0%},{%/if%}[{%$imageItem.Width|escape:'javascript'%},{%$imageItem.Height|escape:'javascript'%},"{%if $imageItem.MiddleThumbnailImageUrl%}{%$imageItem.MiddleThumbnailImageUrl%}{%else%}{%$imageItem.LargeThumbnailImageUrl%}{%/if%}","{%$imageItem.AladdinImageUrl|escape:'javascript'%}","{%$imageItem.ImageFromUrl|escape:'javascript'%}","{%$imageItem.ImageObjUrl|escape:'javascript'%}","{%$imageItem.ImageID|escape:'javascript'%}","{%$imageItem.HoverURL|escape:'javascript'%}"]{%/section%}];BD.IMG.err = function(obj){obj.style.display ="none";obj.parentNode.style.display ="none";};BD.IMG.disabledInput = [];BD.IMG.actions = {ini : function(){var titleHtml = "<a href='#' onclick='return BD.IMG.actions.showReport();'>举报图片</a>";document.getElementById("ala_img_report").innerHTML = titleHtml;BD.IMG.hideReportDiv();return false;},showReport : function(){var titleHtml = "请举报图片&nbsp;-&nbsp;<a href='#' onclick='return BD.IMG.actions.ini();'>取消</a>&nbsp;";document.getElementById("ala_img_r{%*i*%}eport").innerHTML = titleHtml;BD.IMG.showReportDiv();return false;},reportPic : function (f,u,di,q,_this){_this.value="已报";_this.disabled = true;BD.IMG.disabledInput.push(di);var matches = document.cookie.match(/BAIDUID=([^;]+)/);var cookie = "";if(matches !=null){cookie = "&uid="+matches[1];}var img = new Image();img.src = "http://imgstat.baidu.com/4.gif?p=18&fr=ala2&hostfr=imgstat&u="+u+"&f="+f+"&di="+di+"&q="+q+cookie+"&"+new Date()*Math.random();this.hideReport();},hideReport : function(){va{%*i*%}r picNum = (document.getElementById("ala_img_pics").getElementsByTagName("a").length-1)/2;var continueHtml = "感谢您的举报&nbsp;-&nbsp;<a href='#'  onclick='return BD.IMG.actions.showReport();'>继续举报</a>";var endHtml = "感谢您的举报";var reportLength = BD.IMG.disabledInput.length;if(reportLength<picNum&&reportLength>0){document.getElementById("ala_img_report").innerHTML = continueHtml;}else if(reportLength ==0){this.ini();}else{document.getElementById("ala_img_report").innerHTML = endHtml;}BD.IMG.hideReportD{%*i*%}iv();return false;}};BD.IMG.showReportDiv = function(){var reportdivs = document.getElementById("ala_img_pics").getElementsByTagName("input");for(var i=0;i<reportdivs.length;i++){var rd = reportdivs[i];if(rd!=null){rd.style.display = "block"};};BD.IMG.reporting = 1;};BD.IMG.hideReportDiv = function(){var reportdivs = document.getElementById("ala_img_pics").getElementsByTagName("input");for(var i=0;i<reportdivs.length;i++){var rd = reportdivs[i];if(rd!=null){rd.style.display = "none"};};BD.IMG.re{%*i*%}porting = 0;};BD.IMG.justify = function(pics,images,boxwidth,boxheight,bleed,margin){var scaleimg = function(){var totalwidth = 0;for(var i=0;i<pics.length;i++){var scale = boxheight/pics[i][1];pics[i][0] = Math.round(pics[i][0] * scale);pics[i][1] = Math.round(pics[i][1] * scale);totalwidth += pics[i][0] + ((i==pics.length - 1) ? 0 : margin);};if(boxwidth > totalwidth){var lack = boxwidth - totalwidth;var last = pics.length - 1;var scale = (pics[last][0]+lack)/pics[last][0];pics[last][0] = pics{%*i*%}[last][0]+lack;pics[last][1] = Math.round(pics[last][1]*scale);};};var calculate = function(){var totalwidth = 0;var totalshowwidth = 0;for(var i=0;i<pics.length;i++){totalwidth += pics[i][0] + margin;if(totalwidth >= boxwidth){totalwidth = totalwidth - margin;var cut = Math.ceil((totalwidth - boxwidth) / (i + 1));var paddingleft = Math.round(cut/2);var paddingtop = 0;if(paddingleft <= bleed){for(var index=0;index<(i+1);index++){var showwidth = pics[index][0] - cut;totalshowwidth += showwidth;if{%*i*%}(index!=i){totalshowwidth += margin};var showheight = boxheight;paddingtop = Math.round((pics[index][1] - boxheight)/2);var marginleft = margin;if(index==0){marginleft = 0};var imgobj = {};imgobj.rw = pics[index][0];imgobj.rh = pics[index][1];imgobj.sw = showwidth;imgobj.sh = showheight;imgobj.pl = paddingleft;imgobj.src = pics[index][2];imgobj.href = pics[index][3];imgobj.fromurl = pics[index][4];imgobj.objurl = pics[index][5];imgobj.imgid = pics[index][6];imgobj.query = pics[index][7];imgobj.h{%*i*%}src = pics[index][8];imgobj.ml = marginleft;images.push(imgobj);}var widthfixnum = boxwidth - totalshowwidth;if(widthfixnum > i + 1){widthfixnum = i + 1};if(paddingleft > 0){for(var f=0;f<widthfixnum;f++){images[f].sw++;images[f].pl--;}}return 0;}else{return paddingleft - bleed;}break;}}};scaleimg();return calculate();};BD.IMG.appendpic = function(box,img){box.innerHTML = box.innerHTML + "<a data-click='{\'fm\':\'"+BD.IMG.fmdata+"\'}' style='display:inline-block;position:relative;overflow:hidden{%*i*%};vertical-align:middle;outline:none;margin-left:"+img.ml+"px;width:"+img.sw+"px;height:"+img.sh+"px;' target='_blank' href='"+img.href+"'><img style='height:"+img.rh+"px;width:"+img.rw+"px;margin-left:-"+img.pl+"px;' onerror='BD.IMG.err(this)' src='"+img.src+"' /><input type='button' class='OP_LOG_BTN' value='举报' onclick=\"BD.IMG.actions.reportPic('"+img.fromurl+"','"+img.objurl+"','"+img.imgid+"','"+BD.IMG.query+"',this);return false;\" data-hsrc='"+img.hsrc+"'/></a>";};if(BD.IMG.complex){BD.IM{%*i*%}G.picts=[];BD.IMG.picbs=[];BD.IMG.imagets = [];BD.IMG.imagebs = [];BD.IMG.boxtheight = BD.IMG.boxheight;BD.IMG.boxbheight = BD.IMG.boxheight;for(var b=1;b<BD.IMG.pics.length;b++){if(b%2){BD.IMG.picbs.push(BD.IMG.pics[b]);}else{BD.IMG.picts.push(BD.IMG.pics[b]);}};while(BD.IMG.justify(BD.IMG.picts,BD.IMG.imagets,BD.IMG.boxwidth,BD.IMG.boxtheight,BD.IMG.bleed,BD.IMG.margin)){BD.IMG.boxtheight--;if(BD.IMG.boxtheight<=0){break};};for(var m=0;m<BD.IMG.imagets.length;m++){BD.IMG.appendpic(document.get{%*i*%}ElementById("ala_img_ptline"),BD.IMG.imagets[m]);};while(BD.IMG.justify(BD.IMG.picbs,BD.IMG.imagebs,BD.IMG.boxwidth,BD.IMG.boxbheight,BD.IMG.bleed,BD.IMG.margin)){BD.IMG.boxbheight--;if(BD.IMG.boxbheight<=0){break};};for(var m=0;m<BD.IMG.imagebs.length;m++){BD.IMG.appendpic(document.getElementById("ala_img_pbline"),BD.IMG.imagebs[m]);};document.getElementById("ala_img_bigpic").style.height = (BD.IMG.boxtheight+BD.IMG.boxbheight+BD.IMG.margin)+"px";if(document.getElementById("ala_img_bigimg").off{%*i*%}setHeight < (BD.IMG.boxtheight+BD.IMG.boxbheight+BD.IMG.margin)){document.getElementById("ala_img_bigimg").style.height = (BD.IMG.boxtheight+BD.IMG.boxbheight+BD.IMG.margin)+"px";};document.getElementById("ala_img_pics").style.height = (BD.IMG.boxtheight+BD.IMG.boxbheight+BD.IMG.margin)+"px";document.getElementById("ala_img_ptline").style.height = BD.IMG.boxtheight+"px";document.getElementById("ala_img_pbline").style.height = BD.IMG.boxbheight+"px";}else{BD.IMG.images = [];while(BD.IMG.justify(B{%*i*%}D.IMG.pics,BD.IMG.images,BD.IMG.boxwidth,BD.IMG.boxheight,BD.IMG.bleed,BD.IMG.margin)){BD.IMG.boxheight--;if(BD.IMG.boxheight<=0){break};};for(var m=0;m<BD.IMG.images.length;m++){BD.IMG.appendpic(document.getElementById("ala_img_pics"),BD.IMG.images[m]);};};});</script>{%else%}{%$res.offsetInfo.title|escape%}{%/if%}{%/block%}{%block name='foot'%}{%/block%}