{%extends 'c_base.tpl'%} {%block name='title'%}{%/block%}{%block name='foot'%}{%/block%}{%block name='content'%}<style type="text/css" >{%fe_fn_c_css css='btn'%}.op_weather4_twoicon_wt td.op_weather4_twoicon_tr{padding-right:12px}.op_weather4_twoicon_wt td.op_weather4_twoicon_tl{padding-left:12px;border-left:1px solid #e2e9fc}.op_weather4_twoicon_wlink{font-size:.9em;color:#666;padding:12px 0 5px;line-height:20px}.op_weather4_twoicon_wlink a{color:#77c;margin:0 5px}.op_weather4_twoicon_close,.op_weather4_twoicon_open{display:inline-block;font-weight:bold;color:#261cdc;text-decoration:underline;cursor:pointer;margin:2px 0;*margin:0}.op_weather4_twoicon_c{%*i*%}lose b,.op_weather4_twoicon_open b{background:url(http://www.baidu.com/aladdin/img/newvideotvplay/newvideo_new.png) 0 -24px;height:13px;width:14px;overflow:hidden;float:left;margin:3px 3px 0 0}.op_weather4_twoicon_close{display:none}.op_weather4_twoicon_close b{background-position:-18px -24px}.op_weather4_twoicon_u{color:#999;font-weight:normal;display:none;letter-spacing:-4px}.op_weather4_twoicon_u i{color:#999;font-weight:normal;font-style:normal;letter-spacing:0}.op_weather4_twoicon_search{pa{%*i*%}dding-top:5px;display:none;white-space:nowrap}.op_weather4_twoicon_search strong{color:#000}.op_weather4_twoicon_u a,.op_weather4_twoicon_search a{margin-right:10px;white-space:nowrap;color:#261cdc;letter-spacing:0}.op_weather4_twoicon_container_div{width:607px;color:#fff;border:#ececec 1px solid;border-left:none;border-top:0;font-family:'微软雅黑';position:relative;-webkit-user-select:none;-webkit-touch-callout:none;-webktt-tap-highlight-color:rgba(0,0,0,0);-webkit-user-drag:none}.op_weather4_twoic{%*i*%}on_container_div a:visited{color:#fff!important}{%if $tplData.warning%}.op_weather4_twoicon_warning{width:100%;height:36px;color:#fff;display:block;overflow:hidden;font-size:1.1em;cursor:pointer;text-decoration:none;position:absolute;z-index:3;background:rgba(0,0,0,0.2)}.op_weather4_twoicon_warnicon{width:36px;height:36px;display:inline-block;{%if $tplData.warning%}{%$txt = $tplData.warning[0]['warningtxt']%}{%if strpos($txt,'蓝色预警')!== false%}background-color:#36f;{%elseif strpos($txt,'红色预警')!== false%}background-color:#ed2c2c;{%elseif strpos($txt,'黄色预警')!== false%}background-color:#fd0;{%elseif strpos($txt,'橙色预警')!== false%}background-color:#fe9900;{%/if%}{%/if%}}.op_weather4_twoicon_warnicon span{width:24px;height:24px;margin:6px 0 0 6px;display:inline-block}.op_weather4_twoicon_warntext{position:absolute;margin:8px 0 0 11px}{%/if%}{%if $tplData.prompting%}.op_weather4_twoicon_prompting{width:100%;height:36px;font-size:1.1em;line-height:36px;overflow:hidden;color:#fff;background:rgba(0,0,0,0.4)}.op_weather4_twoicon_prompting span{margin-left:14px}{%/if%}.op_weather4_twoicon{width:100%;height:260px;position:relative;{%if $tplData.warning%}padding-top:36px;{%/if%}-webkit-user-select:none;-webkit-touch-callout:none;-webktt-tap-highlight-color:rgba(0,0,0,0);-webkit-user-drag:none}.op_weather4_twoicon_bg{width:100%;{%if $tplData.warning%}height:301px;{%else%}height:265px;{%/if%}position:absolute;z-index:1;{%if $tplData.warning%}top:0;{%/if%}}.op_weather4_twoicon_day,.op_weather4_twoicon_today{position:absolute;width:105px;height:250px;text-decoration:none;color:#fff;border:0;z-index:20;overflow:hidden}.op_weather4_twoicon p{text-align:center;font-size:1em;text-shadow:1px 1px 1px #555;line-height:1em;color:#fff}.op_weather4_twoicon_date{margin-top:43px}.op_weather4_twoicon_icon{width:50px;height:50px;background:no-repeat;margin:25px 0 0 28px}.op_weather4_twoicon_temp{margin-top:39px}.op_weather4_twoicon_weath{margin-top:12px}.op_wea{%*i*%}ther4_twoicon_wind{margin-top:13px}.op_weather4_twoicon_split{position:absolute;left:0;top:45px;width:1px;height:195px;background:#fff;opacity:.15}.op_weather4_twoicon_hover{position:absolute;width:106px;height:250px}.op_weather4_twoicon_hover2{background-image:-webkit-linear-gradient(top,rgba(255,255,255,.015),rgba(255,255,255,.15))}.op_weather4_twoicon_today{width:187px}.op_weather4_twoicon_today .op_weather4_twoicon_date{text-align:left;margin:14px 0 0 14px}.op_weather4_twoicon_today .op_weat{%*i*%}her4_twoicon_icon{width:70px;height:70px;margin-left:60px;{%if isset($tplData.pm25)%}margin-top:17px;{%else%}margin-top:30px;{%/if%}}.op_weather4_twoicon_today .op_weather4_twoicon_temp{padding-left:14px;font-size:2.1em;font-family:Arial;{%if isset($tplData.pm25)%}margin-top:5px;{%else%}margin-top:19px;{%/if%}}.op_weather4_twoicon_today .op_weather4_twoicon_temp sup{font-size:.5em}.op_weather4_twoicon_today .op_weather4_twoicon_weath{font-size:1.2em;margin-top:9px}.op_weather4_twoicon_today .op_weather4_twoicon_wind{margin-top:14px}{%if isset($tplData.pm25)%}.op_weather4_twoicon_pm25{font-size:1.1em;margin-top:14px}.op_weather4_twoicon_pm25 b{margin-left:5px}.op_weather4_twoicon_pm25 em{display:inline-block;margin-left:5px;width:90px;line-height:17px;text-align:center;font-size:.9em;font-style:normal;color:#fff;text-decoration:none}{%/if%}.op_weather4_twoicon_firstsnow{position:absolute;right:10px;top:50px;z-index:10000000}.op_weather4_twoicon_snowtop{overflow:hidden;position:absolute;z-index:20;width:621px;height:136px;top:-10px;left:-6px;background:url(http://www.baidu.com/aladdin-pad/img/weather4_twoicon/snowtop_pad.png) no-repeat}.op_weather4_twoicon_firstsnow_btnwrap{position:absolute}</style>{%$FE_GBVAR.wrapper_prefix%}{%fe_fn_c_title_prefix%}{%if $tplData.nopage%}{%$tplData.title%}{%else%}{%fe_fn_c_title title="{%$tplData.title%}" url="{%$tplData.url%}"%}{%/if%} <b class="op_weather4_twoicon_u"><i>- 最近访问：</i></b>{%fe_fn_c_title_suffix%}<div class="op_weather4_twoicon_container_div"> {%if $tplData.firstsnow%} <div class="op_weather4_twoicon_snowtop"></div> {%/if%} {%if $tplData.warning%} <a class="op_weather4_twoicon_warning" href="{%$tplData.warning[0].warningurl%}" target="_blank" class="OP_LOG_OTHERS"> <span class="op_weather4_twoicon_warnicon"><span style="background-image:url({%$tplData.warning[0].imgsrc%})"></span></span> <span class="op_weather4_twoicon_warntext">{%$tplData.warning[0].warningtxt|limitlen:70|escape:'html'%}</span> </a> {%/if%} {%if $tplData.prompting%} <div class="op_weather4_twoicon_prompting" class="OP_LOG_OTHERS"> <span>{%$tplData.prompting|limitlen:74|escape:'html'%}</span> </div> {%/if%}  {%$tplData['temp0'] = str_replace('℃', '<sup>℃</sup>', $tplData['temp0'])%}  {%$t = date('G') + date('i') / 100%} {%if 6.00 <= $t && $t <= 12.00%} {%$hours = 'morning'%} {%elseif 12.00 <= $t && $t <= 16.00%} {%$hours = 'noon'%} {%elseif 16.00 <= $t && $t <= 18.30%} {%$hours = 'evening'%} {%else%} {%$hours = 'night'%} {%/if%} <div class="op_weather4_twoicon"> {%for $i = 0 to 4%} {%$weathName = $tplData["weather$i"]%} {%$iconURL = $tplData["pic`$i`1"]%} {%$linkURL = $tplData.link1[0].linkurl%}  {%$arr = explode('转', $weathName)%} {%if $i > 0 || strpos($tplData.temp0,'~') !== false%} {%$weath = $arr[0]%} {%else%} {%$weath = end($arr)%} {%/if%}  {%$arr = explode('到', $weath)%} {%$weath = end($arr)%}  {%$eff = array()%} {%if $weath == '晴'%} {%$bg = 'daytime'%}{%$eff['halo']=1%} {%elseif $weath == '阴'%} {%$bg = 'cloudy'%} {%elseif $weath == '雾'%} {%$bg = 'cloudy'%} {%elseif $weath == '多云'%} {%$bg = 'daytime'%}{%$eff['halo']=1%} {%elseif $weath == '霾'%} {%$bg = 'cloudy'%} {%elseif $weath == '小雨'%} {%$bg = 'cloudy'%}{%$eff['rain']=60%} {%elseif $weath == '中雨'%} {%$bg = 'cloudy'%}{%$eff['rain']=80%} {%elseif $weath == '大雨'%} {%$bg = 'cloudy'%}{%$eff['rain']=100%} {%elseif $weath == '暴雨'%} {%$bg = 'cloudy'%}{%$eff['rain']=120%} {%elseif $weath == '大暴雨'%} {%$bg = 'cloudy'%}{%$eff['rain']=140%} {%elseif $weath == '特大暴雨'%} {%$bg = 'cloudy'%}{%$eff['rain']=160%} {%elseif $weath == '冻雨'%} {%$bg = 'cloudy'%}{%$eff['rain']=80%} {%elseif $weath == '雨夹雪'%} {%$bg = 'cloudy'%}{%$eff['rain']=60%} {%elseif $weath == '阵雨'%} {%$bg = 'cloudy'%}{%$eff['rain']=120%} {%elseif $weath == '雷阵雨'%} {%$bg = 'dark'%}{%$eff['rain']=120%}{%$eff['thunder']=1%} {%elseif $weath == '雷阵雨伴有冰雹'%} {%$bg = 'dark'%}{%$eff['rain']=100%}{%$eff['thunder']=1%} {%elseif $weath == '阵雪'%} {%$bg = 'daytime'%}{%$eff['snow']=40%} {%elseif $weath == '小雪'%} {%$bg = 'daytime'%}{%$eff['snow']=70%} {%elseif $weath == '中雪'%} {%$bg = 'daytime'%}{%$eff['snow']=90%} {%elseif $weath == '大雪'%} {%$bg = 'daytime'%}{%$eff['snow']=120%} {%elseif $weath == '暴雪'%} {%$bg = 'daytime'%}{%$eff['snow']=140%} {%elseif $weath == '浮尘'%} {%$bg = 'cloudy'%} {%elseif $weath == '扬沙'%} {%$bg = 'sand'%} {%elseif $weath == '强沙尘暴'%} {%$bg = 'sand'%} {%elseif $weath == '沙尘暴'%} {%$bg = 'sand'%} {%elseif $weath == '特大沙尘'%} {%$bg = 'sand'%} {%/if%}  {%if $i == 0%} {%if $weath == '晴'%} {%if $hours == 'morning'%} {%$eff=''%} {%elseif $hours == 'evening'%} {%$bg = 'evening'%}{%$eff=''%} {%elseif $hours == 'night'%} {%$icon = 2%}{%$bg = 'night'%}{%$eff=array()%}{%$eff['star']=1%} {%/if%} {%elseif $weath == '多云'%} {%if $hours == 'morning'%} {%$eff=''%} {%elseif $hours == 'evening'%} {%$bg = 'evening'%}{%$eff=''%} {%elseif $hours == 'night'%} {%$icon = 6%}{%$bg = 'night'%}{%$eff=''%} {%/if%} {%/if%} {%/if%}  {%foreach $eff as $k => $v%} {%if $k%} {%$effs[$k] = true%} {%/if%} {%/foreach%} {%if !isset($bgs[$bg])%} {%$bgs[$bg] = $i%} {%/if%} {%if $i == 0%}  {%*{%if $tplData.warning || $tplData.prompting%}
                {%"\x3Cstyle>"%}
                {%if $bg == 'daytime'%}
                    .op_weather4_twoicon_warning,.op_weather4_twoicon_prompting {background:#0C5496}
                {%elseif $bg == 'cloudy'%}
                    .op_weather4_twoicon_warning,.op_weather4_twoicon_prompting {background:#3B4752}
                {%elseif $bg == 'sand'%}
                    .op_weather4_twoicon_warning,.op_weather4_twoicon_prompting {background:#746A67}
                {%elseif $bg == 'evening'%}
                    .op_weather4_twoicon_warning,.op_weather4_twoicon_prompting {background:#323B6A}
                {%elseif $bg == 'night'%}
                    .op_weather4_twoicon_warning,.op_weather4_twoicon_prompting {background:#112543}
                {%elseif $bg == 'dark'%}
                    .op_weather4_twoicon_warning,.op_weather4_twoicon_prompting {background:#535457}
                {%/if%}
                </style>
            {%/if%}*%}  {%$weathURL = str_replace('#7d', '', $linkURL)%} <a class="op_weather4_twoicon_today OP_LOG_LINK" target="_blank" href='{%($weathURL)%}' data-click='{"url":"{%$weathURL%}"}' weath-bg='{%($bg)%}' weath-eff='{%json_encode($eff)%}'> {%else%}  {%$weathLen = mb_strlen($weathName)%} <a class="op_weather4_twoicon_day OP_LOG_LINK" style="left:{%187+105*($i-1)%}px" {%if $linkURL%}target="_blank"{%/if%} href='{%if $linkURL%}{%$linkURL%}{%else%}javascript:void(0);{%/if%}' data-click='{"url":"{%$linkURL%}"}' {%if $weathLen > 6%}title="{%($weathName)%}"{%/if%} weath-bg='{%($bg)%}' weath-eff='{%json_encode($eff)%}'>  <div class="op_weather4_twoicon_hover"></div> <div class="op_weather4_twoicon_split"></div> {%/if%} <p class="op_weather4_twoicon_date">{%$tplData["time$i"]%}</p> <div class="op_weather4_twoicon_icon" style="background:url({%str_replace('icon', 'icon2', $iconURL)%})"></div> <p class="op_weather4_twoicon_temp">{%$tplData["temp$i"]%}</p> <p class="op_weather4_twoicon_weath"> {%if $i > 0 && $weathLen > 6%} {%mb_substr($weathName,0,5)%}... {%else%} {%($weathName)%} {%/if%} </p> <p class="op_weather4_twoicon_wind">{%$tplData["wind$i"]%}</p> {%if $i == 0 && isset($tplData.pm25) %} {%$v = $tplData.pm25%} <p class="op_weather4_twoicon_pm25">空气质量: {%if 0 <= $v && $v <= 50%} <em style="background:#4cc74c"><b>{%($v)%}</b>&nbsp;优</em> {%elseif 50 <= $v && $v <= 100%} <em style="background:#afdb00"><b>{%($v)%}</b>&nbsp;良</em> {%elseif 100 <= $v && $v <= 150%} <em style="background:#ff9900"><b>{%($v)%}</b>&nbsp;轻度污染</em> {%elseif 150 <= $v && $v <= 200%} <em style="background:#f55345"><b>{%($v)%}</b>&nbsp;中度污染</em> {%elseif 200 <= $v && $v <= 300%} <em style="background:#cd4971"><b>{%($v)%}</b>&nbsp;重度污染</em> {%elseif 300 <= $v%} <em style="background:#922e5d"><b>{%($v)%}</b>&nbsp;严重污染</em> {%/if%} </p> {%/if%} </a> {%/for%}  {%foreach $bgs as $bg => $v%} {%if $bg == 'daytime'%} {%$gradient = array('#0d68bc', '#72ade0')%} {%elseif $bg == 'evening'%} {%$gradient = array('#394984', '#CC666E 60%', '#EEB66D')%} {%elseif $bg == 'night'%} {%$gradient = array('#183259', '#3482ba')%} {%elseif $bg == 'cloudy'%} {%$gradient = array('#485663', '#a1b8ca')%} {%elseif $bg == 'dark'%} {%$gradient = array('#788092', '#35373b')%} {%elseif $bg == 'sand'%} {%$gradient = array('#8f8381', '#c7b695')%} {%/if%}  {%$colors = implode(',', $gradient)%} <div bg-name="{%($bg)%}" class="op_weather4_twoicon_bg" style="{%if $v > 0%}display:none;{%/if%}background-image:-webkit-linear-gradient(top,{%($colors)%})"> </div> {%/foreach%} </div>   {%if $tplData.folder%} <style type="text/css">.op_weather4_twoicon{height:297px}.op_weather4_twoicon_bg{{%if $tplData.warning%}height:333px;{%else%}height:297px;{%/if%}}.op_weather4_xiala{width:100%;position:absolute;z-index:20;{%if $tplData.warning%}top:302px;{%else%}top:266px;{%/if%}font-family:'微软雅黑','黑体',Arial}.op_weather4_xltab ul li{width:78px;list-style:none;float:left;background:rgba(255,255,255,0.2);text-align:center;line-height:26px;margin-right:1px;font-size:.9em;cursor:pointer;display:block;outline:0}.op_weather4_xltab ul li.op_weather4_xlactive{height:27px;background:rgba(255,255,255,0.1)}.op_weather4_xiala .op_weather4_xltab ul li{-webkit-user-select:none;-webkit-touch-callout:none;-webkit-tap-highlight-color:rgba(0,0,0,0);-webkit-user-drag:none}.op_weather4_xlc{%*i*%}on{background:rgba(255,255,255,0.1);height:114px}.op_weather4_xlleft{float:left;height:86px;width:35px;font-size:.8em;color:#fff;position:absolute;left:0;-webkit-transform:scale(0.8);-moz-transform:scale(0.8);-o-transform:scale(0.8)}.op_weather4_xlleft ul li{padding-top:4px;list-style:none;text-align:right}.op_weather4_xltimeul{clear:both;font-size:.8em;padding-left:38px}.op_weather4_xltimeul ul li{float:left;list-style:none;width:46px;text-align:center;color:#fff}.op_weather4_xltimeulscal{-webk{%*i*%}it-transform:scale(0.8);-moz-transform:scale(0.8);-o-transform:scale(0.8)}.op_weather4_yuandian{background:url('http://www.baidu.com/aladdin/img/new_weath/ico.png') no-repeat}.op_weather4_xllefts{font-size:.8em;-webkit-transform:scale(0.8);-moz-transform:scale(0.8);-o-transform:scale(0.8);position:absolute;top:-14px;left:-11px;color:#fff;width:40px;text-align:center}.op_weather4_xlqyyc{float:left;width:46px;height:106px;position:absolute;top:0;cursor:pointer;z-index:9}.op_weather4_xltip{position{%*i*%}:absolute;top:0;left:0;z-index:10;font-size:.8em}.op_weather4_xlico{position:absolute;width:10px;height:10px;border-color:transparent transparent white transparent;border-style:solid;border-width:0 5px 5px 5px;width:0;height:0;top:1px;z-index:2}.op_weather4_xlcont{background:#fff;margin-top:5px;color:#555;padding:10px;box-shadow:0 2px 4px rgba(0,0,0,0.1)}.op_weather4_jsl{width:20px;height:114px;float:left}.op_weather4_jsm{height:84px;float:left;margin-top:15px;font-size:.8em}.op_weather4_jsm ul {%*i*%}li{width:55px;float:left;background:url('http://www.baidu.com/aladdin/img/new_weath/icobg.png') no-repeat right 0}.op_weather4_jsm span{display:block;text-align:center}.op_weather4_jsr{width:20px;height:114px;float:left}.op_weather4_jsm ul li .op_weather4_jsico{height:24px;padding:13px 0 13px 14px}.op_weather4_jsiconborw0,.op_weather4_jsiconborw1,.op_weather4_jsiconborw2,.op_weather4_jsiconborw3,.op_weather4_jsiconborw4,.op_weather4_jsiconborw5,.op_weather4_jsiconborw6,.op_weather4_jsiconborw7,.{%*i*%}op_weather4_jsiconborw8,.op_weather4_jsiconborw9,.op_weather4_jsiconborw10{width:18px;height:23px;background:url('http://www.baidu.com/aladdin/img/new_weath/icowater.png') no-repeat}.op_weather4_jsiconborw0{background-position:0 0}.op_weather4_jsiconborw1{background-position:0 -33px}.op_weather4_jsiconborw2{background-position:0 -66px}.op_weather4_jsiconborw3{background-position:0 -99px}.op_weather4_jsiconborw4{background-position:0 -132px}.op_weather4_jsiconborw5{background-position:0 -165px}.o{%*i*%}p_weather4_jsiconborw6{background-position:0 -198px}.op_weather4_jsiconborw7{background-position:0 -231px}.op_weather4_jsiconborw8{background-position:0 -264px}.op_weather4_jsiconborw9{background-position:0 -297px}.op_weather4_jsiconborw10{background-position:0 -330px}.op_weather4_xlzs{width:278px;float:left;margin-left:17px;border-bottom:1px solid #ddd;border-bottom:1px solid rgba(255,255,255,0.2);line-height:32px;height:32px;cursor:pointer}.op_weather4_xlzstit{font-size:1.2em}.op_weather4_xlzs{%*i*%}titdes{font-size:.9em}.op_weather4_xlbornone{border-bottom:0}.op_weather4_xltop{padding-top:8px;clear:both}.op_weather4_xltiptitle{font-size:1em;font-weight:bold;line-height:24px}.op_weather4_xltipcontent{line-height:20px}.op_weather4_xlopen{width:100%;height:29px;background:rgba(0,0,0,0.1);cursor:pointer;text-align:center;z-index:6;padding-top:3px}.op_weather4_xiala .op_weather4_xlopen{-webkit-user-select:none;-webkit-touch-callout:none;-webkit-tap-highlight-color:rgba(0,0,0,0);-webkit-user-dra{%*i*%}g:none}.op_weather4_tipbtn{display:inline-block;padding:2px 0;cursor:pointer}.op_weather4_tipbtn span{display:inline-block}.op_weather4_icobottom{background:url('http://www.baidu.com/aladdin/img/new_weath/ico.png') 0 -188px no-repeat;width:27px;height:11px;display:inline-block}.op_weather4_xlclose{height:32px;cursor:pointer;text-align:center;z-index:6}.op_weather4_xlclose .op_weather4_icobottom{background:url('http://www.baidu.com/aladdin/img/new_weath/ico.png') 0 -212px no-repeat}.op_weather4_x{%*i*%}iala .op_weather4_xlclose{-webkit-user-select:none;-webkit-touch-callout:none;-webkit-tap-highlight-color:rgba(0,0,0,0);-webkit-user-drag:none}.op_weather4_xlCanvascon1,.op_weather4_xlCanvascon2{position:relative;margin-left:36px}.op_weather4_xlfilter{cursor:pointer;display:block}.op_weather4_jslNovalue{background:0;padding-top:4px}</style> <!--[if IE]> <style>.op_weather4_xlcont{border:1px solid #eaeaea}</style> <![endif]--> <div class="op_weather4_xiala"> <div class="op_weather4_xltabcontent" {%*i*%}style="display:none;"> <div class="op_weather4_xltab c-clearfix"> <ul> <li class="op_weather4_xlactive OP_LOG_BTN" data-click="{fm:'beha'}"><span class="op_weather4_xlfilter">分时温度</span></li> <li class=" OP_LOG_BTN" data-click="{fm:'beha'}"><span class="op_weather4_xlfilter">风力风向</span></li> <li class=" OP_LOG_BTN" data-click="{fm:'beha'}"><span class="op_weather4_xlfilter">降水量</span></li> {%if $tplData.xgzs%}<li class=" OP_LOG_BTN" data-click="{fm:'beha'}"><span class="op_weather4_xlfilter">相关指数</span></li>{%/if%} </ul> </div> <div class="op_weather4_xlcon" style=""> <div class="c-row"> <div class="op_weather4_xlleft"> <ul class="op_weather4_xlleftfswd"> </ul> </div> <div style="float:left;"> <div class="op_weather4_xlCanvascon1"> <canvas class="op_weather4_xlCanvas1" width="552" height="86"></canvas> </div> </div> </div> <div class="op_weather4_xltimeul"> <ul> {%$xmin = $tplData.fswdaxes[0].xmin%} {%for $item=0 to 11%} {%$times = $xmin+$item%} {%if $times==24 %} {%$times = '00'%} {%else if $times>24 %} {%$times = $times-24%} {%/if%} <li class="op_weather4_xltimeulscal">{%$times|escape%}:00</li> {%/for%} </ul> </div> </div> <div class="op_weather4_xlcon" style=""> <div class="c-row"> <div class="op_weather4_xlleft"> <ul class="op_weather4_xlleftflfx"> </ul> </div> <div style="float:left;"> <div class="op_weather4_xlCanvascon2"><canvas class="op_weather4_xlCanvas2" width="552" height="86"></canvas></div> </div> </div> <div class="op_weather4_xltimeul"> <ul> {%$xmin = $tplData.flfxaxes[0].xmin%} {%for $item=0 to 11%} {%$times = $xmin+$item%} {%if $times==24 %} {%$times = '00'%} {%else if $times>24 %} {%$times = $times-24%} {%/if%} <li>{%$times|escape%}时</li> {%/for%} </ul> </div> </div> <div class="op_weather4_xlcon" style="display:none;"> <div class="op_weather4_jsl"></div> <div class="op_weather4_jsm"> <ul class="op_weather4_jslul"> </ul> </div> <div class="op_weather4_jsr"></div> </div> <div class="op_weather4_xlcon" style="display:none;"> <ul class="op_weather4_xltop c-clearfix"> </ul> </div> </div> <div class="op_weather4_xlopen OP_LOG_BTN" data-click="{fm:'beha'}"> <div class="op_weather4_xlfilter"> <span class="op_weather4_tipbtn"><span>查看今天详细数据</spa{%*i*%}n> <i class=" op_weather4_icobottom"></i> </span> </div> </div> <div class="op_weather4_xlclose OP_LOG_BTN" data-click="{fm:'beha'}" style="display:none;"> <div class="op_weather4_xlfilter"> <span class="op_weather4_tipbtn"> <i class=" op_weather4_icobottom"></i> </span> </div> </div> </div>  {%/if%}</div><div class="op_weather4_twoicon_wlink">{%$tplData.support|limitlen:34|escape:'html'%} {%if $tplData.link1[0]['linkcontent']|escape:'html'%}<a target="_blank" href="{%$tplData.link1[0]['linkurl']%}"><span class="op_weather4_twoicon_aa">{%$tplData.link1[0]['linkcontent']|limitlen:36|escape:'html'%}</span></a>{%/if%}<div class="op_weather4_twoicon_search"><strong>其他用户还搜索了：</strong></div> <div> {%fe_fn_c_showurl showurl="{%$tplData.showurl%}" date="{%$tplData.date%}" showlamp="{%$tplData.showlamp%}"%} </div></div>{%if $tplData.firstsnow%}<div class="op_weather4_twoicon_firstsnow_btnwrap"><a class="c-btn c-btn-primary c-btn-large op_weather4_twoicon_firstsnow_btn" href="javascript:;">关闭动画</a></div>{%/if%}<script >
    A.setup('weather4_twoicondata',{
        'url':'{%$tplData.url|escape:'html'%}',
        'oq':'{%$extData.OriginQuery%}',
        'fetchkey':'{%$extData.fetchkey%}',
        'resourceid':'{%$extData.resourceid%}',
        'swfurl':'{%$tplData.swf[0]['url']|escape:'html'%}',
        'swfon':'{%if $tplData.swf[0]['on']%}{%$tplData.swf[0]['on']|escape:'html'%}{%/if%}',
        'swfoff':'{%if $tplData.swf[0]['off']%}{%$tplData.swf[0]['off']|escape:'html'%}{%/if%}',
        'swfcondition':'{%$tplData.swf[0]['condition']|escape:'html'%}',
        'firstsnow':'{%$tplData.firstsnow%}',
        'warn':'{%if $tplData.warning%}1{%/if%}',
        'folder':'{%$tplData.folder|escape%}',
        'originQuery': '{%str_replace($extData.resourceid|cat:'_','',$extData.fetchkey)|escape:"javascript"%}',
        'srcid':'{%$extData.resourceid%}',
        'fswdaxes':'{%$extData.fswdaxes%}'
    });
</script><script>A.setup(function() {var _this = this;var weather4_twoicondata = _this.data.weather4_twoicondata;var $UA = navigator.userAgent;var $IE = $UA.match(/MSIE (\d+)/);$IE = $IE && +$IE[1];if ($IE) {var dummy = document.createElement('iframe');document.body.appendChild(dummy);$UA = dummy.contentWindow.navigator.userAgent;$IE = +$UA.match(/MSIE (\d+)/)[1];document.body.removeChild(dummy);dummy = null;var $IE6 = ($IE == 6);var $IE78 = ($IE == 7 || $IE == 8);}function URL(path) {return 'ht{%*i*%}tp://www.baidu.com/aladdin/img/new_weath/' + path;}var efUsed = {},efFact = {};var layerLight;{%foreach $effs as $eff => $v%}{%if $eff == 'rain'%}efFact.rain = function(exports) {var W = 2;var H = 16;var sprites = [];var curNum = 0;var LAYER_PERCENT = [0,1,1,1,2,2,2,2,2,2,2,2];var LAYER_ALPHA = [[0.25, +0.30],[0.20, +0.10],[0.15, +0.15]];var LAYER_SPEED = [9, 7, 5];var GRAVITY = 0.1;function setOpacity(spt, val) {spt.setYOffset(H * ~~((1 - val) * 10));}function reset(spt) {var rnd = Math.random() * LAYER_PERCENT.length;var type = LAYER_PERCENT[rnd >> 0];spt.setXOffset(W * type);spt.setVelocity(0, LAYER_SPEED[type]);spt.setX(Math.random() {%*i*%}* CANVAS_W);if (spt.fromtop_) {spt.setY(-10);}else {spt.fromtop_ = true;spt.setY( Math.random() * CANVAS_H ); }var alpha_range = LAYER_ALPHA[type];var opacity = alpha_range[0] + Math.random() * alpha_range[1];setOpacity(spt, opacity);}exports.render = function() {var num = exports.arg;for(var i = num; i < curNum; i++) {sprites[i].setY(999);sprites[i].fromtop_ = false;}for(var i = sprites.length; i < num; i++) {var spt = scene.Sprite(URL('rain.png'), exports.layer);spt.size(2, 16);reset(spt);spri{%*i*%}tes[i] = spt;}for(var i = 0; i < curNum; i++) {var spt = sprites[i];spt.yv += GRAVITY;spt.applyYVelocity();spt.update();if (spt.y > CANVAS_H) {reset(spt);}}curNum = num;};exports.RES = ['rain.png'];};{%elseif $eff == 'snow'%}efFact.snow = function(exports) {var W = 14;var H = 12;var ROTATE = 0.03; var TURN_TIMES = 1.5; var K = 2 * Math.PI / (CANVAS_H / TURN_TIMES);var sprites = [];var curNum = 0;var LAYER_PERCENT = [0,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2];var LAYER_ALPHA = [[0.1, +0.60],[0.2, +0.40],[0.3, +0.15]];var LAYER_SPEED = [1.2, 0.8, 0.6];function setOpacity(spt, val) {spt.setYOffset(H * ~~((1 - val) * 10));}function reset(spt) {var rnd = Math.random() * LAYER_PERCENT.length;var type = LAYER_PERCENT[~~rnd];spt.setX{%*i*%}Offset(W * type);spt.type_ = type;spt.x_ = Math.random() * CANVAS_W;spt.setX(spt.x_);if (spt.fromTop_) {spt.setY(-10);}else {spt.fromTop_ = true;spt.setY(Math.random() * CANVAS_H);}spt.v_ = LAYER_SPEED[type];spt.offset_ = 6 - 2 * type;spt.v_ *= (0.95 + Math.random() / 10);spt.offset_ *= (0.875 + Math.random() / 4);var alpha_range = LAYER_ALPHA[type];var opacity = alpha_range[0] + Math.random() * alpha_range[1];setOpacity(spt, opacity);spt.op_ = opacity;}exports.render = function() {var num = exp{%*i*%}orts.arg;for(var i = num; i < curNum; i++) {sprites[i].setY(999);sprites[i].fromTop_ = false;}for(var i = sprites.length; i < num; i++) {var spt = scene.Sprite(URL('snow.png'), exports.layer);spt.size(W, H);reset(spt);sprites[i] = spt;}for(var i = 0; i < curNum; i++) {var spt = sprites[i];var x = spt.x_ + spt.offset_ * Math.sin(spt.y * K);var y = spt.y + spt.v_;spt.position(x, y);if (spt.type_ == 0) {spt.rotate(ROTATE);}if (y > 200) {setOpacity(spt, spt.op_ *= 0.95);}spt.update();if (y > CANVAS_{%*i*%}H) {reset(spt);}}curNum = num;};exports.RES = ['snow.png'];};{%elseif $eff == 'thunder'%}efFact.thunder = function(exports) {var DELAY_MIN = 3000 / 60;var DELAY_RND = 10000 / 60;var NUM = 2;var sprites; var spt; var tickWait; var tick = 0; function init() {sprites = [];for(var i = 0; i < NUM; i++) {sprites[i] =scene.Sprite(URL('thunder/' + i + '.png'), exports.layer);;}reset();tickWait /= 5;}function reset() {var id = Math.random() * NUM;spt = sprites[~~id];spt.position(Math.random() * (CANVAS_W - spt.w), 0);tickWait = ~~(DELAY_MIN + Math.random() * DELAY_RND);tick = 0;}exports.rend{%*i*%}er = function() {if ($IE78) return;if (!sprites) {init();}if (--tickWait > 0 || exports.alpha < 1) {return;}var opaticy;tick++;if (tick < 11) {spt.setH(25 * tick);opaticy = tick * 0.04;}else if (tick < 13) {opaticy = 0;}else if (tick < 28) {opaticy = 1 - (tick - 13) * 0.0714;layerLight.setOpacity(opaticy / 8);}else {layerLight.setOpacity(0);spt.setY(-999).update();reset();return;}spt.setOpacity(opaticy).update();};exports.RES = ['thunder/0.png', 'thunder/1.png'];};{%elseif $eff == 'star'%}efFact.star = function(exports) {var W = 5;var H = 5;var MAX_Y = 100;var MAX_NUM = 110;var LAYER_PERCENT = [0,0,0,0,1,1,1,1,1,2];var LAYER_ALPHA = [[0.9, +0.1],[0.9, +0.1],[0.8, +0.2]];var sprites = [];var inited;function setOpacity(spt, val) {spt.setYOffset(H * ~~((1 - val) * 5));}function reset(spt) {var x = ~~(Math.random() * CANVAS_W);var y = 0;if (spt.y < MAX_Y) {y = ~~(Math.random() * MAX_Y);}spt.position(x, y);var rnd = Math.random() * LAYER_PERCENT.length;var type = LAYER_PERCENT[~~rnd];{%*i*%}spt.setXOffset(W * type);var alpha_range = LAYER_ALPHA[type];var opacity = alpha_range[0] + Math.random() * alpha_range[1];setOpacity(spt, opacity);spt.op_ = opacity;spt.opmax_ = opacity; spt.opmin_ = opacity * 0.2; spt.opA_ = -0.025; spt.cd_ = spt.cdmax_ = 90 + ~~(120 * Math.random());}function init() {for(var i = 0; i < MAX_NUM; i++) {var spt = scene.Sprite(URL('star.png'), exports.layer);spt.size(W, H);reset(spt);sprites[i] = spt;}}exports.render = function() {if (!inited) {init();inited = tr{%*i*%}ue;}for(var i = 0; i < MAX_NUM; i++) {var spt = sprites[i];if (--spt.cd_ < 0) {spt.op_ += spt.opA_;if (spt.op_ < spt.opmin_) { spt.opA_ *= -1;spt.move(0, 1);}else if (spt.op_ >= spt.opmax_) { spt.opA_ *= -1;spt.cd_ = spt.cdmax_;}setOpacity(spt, spt.op_);}if (spt.y > MAX_Y) {reset(spt);}spt.update();}};exports.RES = ['star.png'];};{%elseif $eff == 'halo'%}efFact.halo = function(exports) {var SUN_X = 320;var LIGHT_DEF = 1;var LIGHT_MAX = 1;var LIGHT_MIN = 0.8;var RING_NUM = 7;var RING_D = 216;var MARGIN_TOP = 100;var rings = [];var light;var inited;var op = LIGHT_DEF;var A = 0.0005;function init() {light = scene.Sprite(URL('halo/light.png'), exports.layer);light.position(SUN_X - light.w / 2, 0);for(var i = 0; i < RING_NUM; i++) {var spt = scene.Sprite(URL('halo/ring.png'), exports.layer);var y = Math.random() * 250;var x = SUN_X - 150 - y * 0.3;sp{%*i*%}t.position(x, y);spt.size(RING_D, RING_D);spt.setXOffset(RING_D * i);rings[i] = spt;}}exports.render = function() {if (!inited) {init();inited = true;}op += A;if (op >= LIGHT_MAX || op <= LIGHT_MIN) {A = -A;}if (!$IE78) {light.setOpacity(op);}light.update();for(var i = 0; i < RING_NUM; i++) {rings[i].update();}};exports.RES = ['halo/light.png', 'halo/ring.png'];};{%/if%}{%/foreach%}var defEff, curEff;function checkCanvas() {return 'getContext' in document.createElement('canvas');}function loadEff(e) {var res = e.RES;for(var i = res.length - 1; i >= 0; i--) {res[i] = URL(res[i]);}scene.loadImages(res, function() {e.loaded = true;});}function renderEff() {if ($IE6) return;for(var k in efUsed) {var e = efUsed[k];if (!e.loaded) continue;var last = e.alpha;e.alpha += ALPHA_DELTA;if (e.alpha > 0) {e.render();if (!$IE78) {if (e.alpha < 1.0) {e.layer.setOpacity(e.alpha);}}}else {i{%*i*%}f (last > 0) {e.layer.setVisible(false);}}}}function setEff(effArgs) {if ($IE6) return;for(var k in curEff) {if ($IE78)efUsed[k].layer.setVisible(false);efUsed[k].alpha = 1.0;}for(var k in effArgs) {var e = efUsed[k];if (!e.loaded && !e.loading) {e.loading = true;loadEff(e);}e.arg = effArgs[k];e.alpha = 9e9;e.layer.setVisible(true);if (!$IE78)e.layer.setOpacity(1.0);}curEff = effArgs;}function initEff() {if ($IE6) return;var opt;if (checkCanvas()) {opt = {useCanvas:true, autoClear:true};}for(var{%*i*%} k in efFact) {var exports = {};efFact[k](exports);exports.layer = scene.Layer('eff-' + k, opt);exports.layer.setZIndex(1);exports.layer.setVisible(false);efUsed[k] = exports;}layerLight = scene.Layer('light');layerLight.setOpacity(0);layerLight.setColor('#fff');}var CANVAS_W = 607,CANVAS_H = 260;ALPHA_DELTA = -0.03;var scene;var layers_bg = {};var fading;var opacity;var defBg, curBg;var divOldBg;var setAlpha =function (el, v) {el.style.opacity = v};function setBg(bg) {if (bg == curBg) {return;}{%*i*%}var divBg = layers_bg[bg];if (opacity > 0) {setAlpha(divOldBg, 0);divOldBg.style.display = 'none';opacity = 1 - opacity;}else {opacity = 1;}divOldBg = layers_bg[curBg];divOldBg.style.zIndex = 2;setAlpha(divOldBg, 1.0);divBg.style.zIndex = 1;divBg.style.display = 'block';setAlpha(divBg, 1.0);curBg = bg;fading = true; }function renderBg() {opacity += ALPHA_DELTA;if (opacity < 0) {divOldBg.style.display = 'none';fading = false;}else {setAlpha(divOldBg, opacity);}}var tid = -1;function handleOver() {%*i*%}{if (tid != -1) {clearTimeout(tid);tid = -1;}var bg = this.getAttribute('weath-bg');setBg(bg);setEff(this.eff);$(this.getElementsByTagName('div')[0]).addClass('op_weather4_twoicon_hover2');}function handleOut() {tid = setTimeout(function() {setBg(defBg);setEff(defEff);}, 20);$(this.getElementsByTagName('div')[0]).removeClass('op_weather4_twoicon_hover2');}function render() {if (fading) {renderBg();}renderEff();}function initAni() {scene = A.ui.sjs.Scene({w: CANVAS_W, h: CANVAS_H, parent: _this.f{%*i*%}ind('.op_weather4_twoicon')[0]});scene.dom.style.zIndex = 10;initEff();setEff(defEff);var ticker = scene.Ticker(1000 / 60, render);ticker.run();}function init() {var arr = _this.find('.op_weather4_twoicon_today').get().concat(_this.find('.op_weather4_twoicon_day').get());for(var i = arr.length - 1; i >= 0; i--) {var column = arr[i];var eff = column.getAttribute('weath-eff');if (eff) {eff = eval('(' + eff + ')');column.eff = eff;if (i == 0) {defEff = eff;}}if (i == 0) {curBg = defBg = column.getA{%*i*%}ttribute('weath-bg');}if ($IE) {column.onmouseenter = handleOver;column.onmouseleave = handleOut;}else {column.onmouseover = handleOver;column.onmouseout = handleOut;}}arr = _this.find('.op_weather4_twoicon_bg');for(i = arr.length - 1; i >= 0; i--) {var name = arr.eq(i).attr('bg-name');layers_bg[name] = arr.get(i);}A.use('sjs', initAni);}setTimeout(init, 1);var snows = []; var snowInterval; var hideInterval = null; var moveInterval = null; if (weather4_twoicondata.firstsnow) {function initFn() {{%*i*%}var snowlevel = weather4_twoicondata.firstsnow;var snowNum = 20 - 5 * (3 - snowlevel); var snow = function(index){var screenWidth = document.documentElement.clientWidth || document.body.clientWidth, screenHeight = document.documentElement.clientHeight || document.body.clientHeight, scale = Math.random() * 1 - 0.3, size = Math.ceil(16 * (1 + scale) ), snowX = Math.random() * (screenWidth-100), snowY = 0, speedX = 0, angleX = 0, speedY = 3 + Math.random() * 3, amplitude = Math.random() * 3, opacit{%*i*%}y = 1, img = null, _this = this;if ( Math.random() - 0.5 > 0) { speedX = (0.01 + Math.random()/100);} else {speedX = -(0.01 + Math.random()/100);} var draw = function (){ img = document.createElement('img');var bgNum = Math.ceil(Math.random()*100 ) % 100;if (bgNum > 95) {bgNum = 4;} else if (bgNum <=95 && bgNum >65) {bgNum = 3;} else if (bgNum <=65 && bgNum >35) {bgNum = 2;} else if (bgNum <=35 && bgNum >0) {bgNum = 1;} else {bgNum = 1;}var cssStyle = {'position':'absolute','zIndex':'10000000','{%*i*%}opacity':opacity,'width':(size + 'px'),'height':(size + 'px')};img.src = 'http://www.baidu.com/aladdin/img/weather4_twoicon/snowflake' + bgNum + '.png';for( var i in cssStyle) {img.style[i] = cssStyle[i]; }img.style.left = snowX + 'px';img.style.top = snowY + 'px';document.body.appendChild(img);};var move = function (){ angleX += speedX;snowX = snowX + amplitude * Math.sin(angleX);snowY += speedY;var screenWNow = document.documentElement.clientWidth || document.body.clientWidth,screenHNow = docu{%*i*%}ment.documentElement.clientHeight || document.body.clientHeight;if ( 50 < snowX && snowX < (screenWNow - 50) && 0 < snowY && snowY < (screenHNow - 100) ) {img.style.left = snowX + 'px';img.style.top = snowY + 'px';} else { img.style.left = snowX + 'px';img.style.top = snowY + 'px';if ( !hideInterval) {hideInterval = setInterval(function(){ if (opacity >= 0) {opacity -= 0.2;img.style.opacity = opacity;} else {destory(); snows[index] = new snow(index); }}, 50);}}};var destory = this.destory = func{%*i*%}tion(){ clearInterval(hideInterval);clearInterval(moveInterval);if (img.parentNode) {img.parentNode.removeChild(img); }_this = null;};var init = function() { draw();moveInterval = setInterval(function(){move();}, 50)};init();};function initSnow(){ var initSnowNum = 4 + 2 * snowlevel;for (var i = 0; i < 10; i ++) {snows[i] = new snow(i);}snowInterval = setInterval( function() {var snowCount = snows.length;if ( snowCount < snowNum) {snows[snowCount] = new snow(snowCount);} else {clearInterval(snow{%*i*%}Interval);}}, 300);}function initBtn() { var firstSnowBtn = _this.find('.op_weather4_twoicon_firstsnow_btn')[0], firstSnowWrap = _this.find('.op_weather4_twoicon_firstsnow_btnwrap')[0]; if (firstSnowBtn) {var pos = $(_this.container).position(); firstSnowWrap.style.top = pos.top + 25 + 'px';firstSnowWrap.style.left = pos.left + 615 + 'px';$(firstSnowWrap).show();$(firstSnowBtn).on("click",function(){clearInterval(snowInterval);for (var i=0; i< snows.length; i ++) {if (snows[i]) {snows[i].destory{%*i*%}();}}$(firstSnowWrap).show();_this.find('.op_weather4_twoicon_snowtop').hide();});}}initSnow();initBtn();}initFn();} var query = weather4_twoicondata.oq;if(query.indexOf("天气") < 0)return;A.use('localstorage',function(){var storage = A.ui.localstorage({fileName : 'bd_weather_city',expiresDay : 30});storage.init();var curCity = weather4_twoicondata.fetchkey.split(weather4_twoicondata.resourceid+'_')[1]; curCity = (curCity.indexOf('天气') < 0 ) ? curCity + '天气' : curCity; var localStorElem = _this.fi{%*i*%}nd('.op_weather4_twoicon_u')[0]; weatherHis(1); function wencodeHTML(source) {return String(source).replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g, "&quot;").replace(/'/g, "&#39;");};function weatherHis(cityNum){var cityStorage = storage.get('op_weather4_twoicon_city');var storageMax = cityNum;var cityList = (!cityStorage) ? new Array() : unescape(cityStorage).split(';'); for(var i=0, j=0; i<cityList.length; i++) {if( cityList[i] == curCity || j == 99) { cityList.sp{%*i*%}lice(i,1);} else {j++;}}if(cityList && cityList.length > 0) {for(var j = 0; j < storageMax; j++) {var cityA = document.createElement('a');var url = "http://www.baidu.com/s?wd=" + encodeURIComponent(cityList[j]) + "&ie=utf-8";var cityName=document.createTextNode( wencodeHTML(cityList[j]) );cityA.appendChild(document.createTextNode( wencodeHTML(cityList[j]) ));cityA.href = url;cityA.target = '_blank';cityA.className = 'OP_LOG_LINK';localStorElem.appendChild( cityA );}localStorElem.style.display = {%*i*%}'inline';c({'fm': 'inlo', rsv_wct : 1});}var setStorige = cityList.length > 0 ? curCity + ';' + cityList.join(';') : curCity;storage.set('op_weather4_twoicon_city', escape(setStorige));}});});this.dispose = function(){if(snows.length>1){for (var i = 0; i < snows.length; i ++) {snows[i].destory();}}clearTimeout(tid);clearInterval(snowInterval);clearInterval(hideInterval);clearInterval(moveInterval);scene&&scene.dispose&&scene.dispose();};</script><script>A.setup(function() {var _this = this;var w{%*i*%}eather4_twoicondata = _this.data.weather4_twoicondata;var XLIE6 = !!window.ActiveXObject && !window.XMLHttpRequest;var browserIE = /msie (\d+\.\d+)/i.test(navigator.userAgent) ? (document.documentMode || + RegExp['\x241']) : undefined;var originQuery = weather4_twoicondata.originQuery,srcid = weather4_twoicondata.srcid,fswd = null,flfx=null,xgzs=null,fswdaxes=null,flfxaxes = null,jsl=null,warH = weather4_twoicondata.warn?36:0,xlHClose = 32,xlHOpen = 174,H = 265;if(weather4_twoicondata.folder && {%*i*%}!XLIE6){function wdfl(canvas,appendo,fswd,flfx,fl){var op_weather4_xlCanvas = canvas,ctx = op_weather4_xlCanvas.getContext('2d');for(var i=0;i<fswd.length;i++){if(!fswd[i].novalue){var startXY = {'x':0,'y':fswd[i].y};break;}}var dataXY=[];dataXY = !fl?fswd:flfx;if(!fl){dataXY[12] = {'id':12,'x':562,'y':dataXY[dataXY.length-1]['y'],'yw':0};dataXY[13] = {'id':13,'x':562,'y':-2,'yw':0};dataXY[14] = {'id':14,'x':0,'y':-2,'yw':0};}function line(x,y,i){if(i==11 && dataXY[11].novalue){ctx.lineTo(552,y){%*i*%};}else{ctx.lineTo(x,y);}}function createCanvas(appendo,w,h,l,t,i,flfn){var op_weather4_xlqyyc = document.createElement('div');op_weather4_xlqyyc.className="op_weather4_xlqyyc";op_weather4_xlqyyc.style.left = i*46+'px';appendo.appendChild(op_weather4_xlqyyc);var yc = document.createElement('div');yc.className = 'op_weather4_yuandian';yc.style.position="absolute";yc.style.width=w+'px';yc.style.height=h+'px';yc.style.left=l-w/2+'px';yc.style.top=t-h/2+'px';if(!fl){yc.style.backgroundPosition='0 3px{%*i*%}';}else{var posiXY = flfn==8?'2px 3px':'0 -'+(flfn*20+27)+'px';yc.style.backgroundPosition=posiXY;}op_weather4_xlqyyc.appendChild(yc);return op_weather4_xlqyyc;}function creatfont(appendo,w,h,l,t,c){var ft = document.createElement('div');ft.className = 'op_weather4_xllefts';ft.style.position="absolute";if(fl){ft.style.width='42px';}ft.style.left=l-w/2-13+'px';ft.style.top=t-h/2-13+'px';var unit = fl?'':'°C';ft.innerHTML = c+unit;appendo.appendChild(ft);return ft;}function ceartArc(appendo,w,h,l,{%*i*%}t,c,i,flfx,flfl,flfs,flfn){var canvas = createCanvas(appendo,w,h,l,t,i,flfn);creatfont(canvas,w,h,l,t,c);if(fl){xltip(canvas,100,108,l-50,'<p>风向：'+flfx+'</p><p>风力：'+flfl+'</p><p>风速：'+flfs+'</p>');}else{}}function editArc(o,w,h,l,t,xy){o.style.width=w+'px';o.style.height=h+'px';o.style.left=l-w/2+'px';o.style.top=t-h/2+'px';o.style.backgroundPosition=xy;}function moveArea(mouseX){for(var i=0;i<12;i++){if(mouseX>=(i*46) && mouseX<(i*46+46)){return i;}}}function clearCanvas(w,h){ctx.clearRect(0,0,w{%*i*%},h);}function ctxDraw(appendo){ctx.strokeStyle='rgba(255,255,255,0.2)';ctx.save();ctx.beginPath();if(!fl){ctx.moveTo(startXY.x,86-startXY.y-0.5);}else{if(dataXY[0].novalue){for(var i=0;i<dataXY.length;i++){if(!dataXY[i].novalue){ctx.moveTo(0,86-dataXY[i].y-0.5);break;}}}else{ctx.moveTo(20,86-dataXY[0].y-0.5);}}ctx.strokeStyle='#FFFFFF';ctx.lineWidth = 1;for(var i=0;i<dataXY.length;i++){if(i<12){if(!dataXY[i].novalue){var x = (dataXY[i].id-1)*46+23,y = 86-dataXY[i].y-0.5,lasty = y;}else{var y = l{%*i*%}asty;}}else{var x = (dataXY[i].x),y = 86-(dataXY[i].y);}line(x,y,i);if(i<12 && !fl && !dataXY[i].novalue){ceartArc(appendo,14,14,20,86-dataXY[i].y,dataXY[i].yw,i);}if(i<12 && fl && !dataXY[i].novalue){ceartArc(appendo,14,14,20,86-dataXY[i].y,dataXY[i].s,i,dataXY[i].f,dataXY[i].fl,dataXY[i].s,dataXY[i].fn);}}ctx.stroke();if(!fl){ctx.fillStyle="rgba(255,255,255,0.1)";ctx.fill();ctx.closePath();}ctx.restore();for(var i=0;i<5;i++){ctx.beginPath();var y = 17*(i+1)+0.5;ctx.moveTo(0,y);ctx.lineTo(552,y{%*i*%});ctx.stroke();}}ctxDraw(appendo);}function xltip(appendo,w,t,l,html,xgzs){var tip = document.createElement('div');tip.className = 'op_weather4_xltip';tip.style.width = w+'px';tip.style.top = t+'px';tip.style.left = l+'px';tip.style.zIndex = '1000';tip.style.display = 'none';appendo.appendChild(tip);var tipico = document.createElement('span');tipico.className = 'op_weather4_xlico';var leftD = xgzs?35:75;tipico.style.left = l+leftD+'px';tip.appendChild(tipico);var tipcon = document.createElement({%*i*%}'div');tipcon.className = 'op_weather4_xlcont';tipcon.innerHTML = html;tip.appendChild(tipcon);return tip;}function setString(str,len){if(str.length*2 <= len){return str;}var strlen = 0; var newstr = "";for(var i = 0;i < str.length; i++){if(str.charCodeAt(i) > 128){ strlen = strlen + 2;if(strlen > len){return newstr.substring(0,newstr.length-1) + "...";}}else{strlen = strlen + 1;if(strlen > len){return newstr.substring(0,newstr.length-2) + "...";}}newstr = newstr + str.charAt(i);}return newstr;}{%*i*%};var zhishuActive = null;function xgzhsli(o,i){var xlbornone = i>3?' op_weather4_xlbornone':'';var li = document.createElement('li'),div = document.createElement('div'),$xlxgzhtop = _this.find('.op_weather4_xltop').eq(0);li.className = 'op_weather4_xlzs'+xlbornone;li.style.position = 'relative';li.style.zIndex = 6-i;$xlxgzhtop.append(li);div.className = 'op_weather4_xlzstit';div.innerHTML = o.title+'：'+o.zs;li.appendChild(div);var xgzhtip = xltip(li,335,27,0,'<div class="op_weather4_xltiptitle">{%*i*%}'+o.tipt+'：'+o.zs+'</div><div class="op_weather4_xltipcontent">'+o.des+'</div>',1);$(li).on('click',function(){if(zhishuActive){zhishuActive.hide();}zhishuActive = $(this).find('.op_weather4_xltip');xgzhtip.style.display = 'block';});return li;}function xgzhs(data) {var ul = '';$.each(data,function (i,o){ul += xgzhsli(o,i);});return ul;}function xyValue(fswdaxes){var ymax = fswdaxes.ymax,ydif = (ymax - fswdaxes.ymin)/4,strLi = '';for(var i=0;i<5;i++){var livalue = ymax-(i*ydif);strLi += '<li>'+l{%*i*%}ivalue+'</li>';}return strLi;}function jslUl(jsl){var strLi='';for(var i=0;i<10;i++){var time = jsl[i].t.replace(':00','时'),percentage = Math.ceil(jsl[i].p)<11?Math.ceil(jsl[i].p):10,novalueJsl = jsl[i].novalue?' op_weather4_jslNovalue':'',noJsl = jsl[i].novalue?'--':'';strLi += '<li>'+'<span>'+time+'</span>'+'<div class="op_weather4_jsico">'+'<span class="op_weather4_jsiconborw'+percentage+novalueJsl+'">'+noJsl+'</span>'+'</div>'+'<span class="op_weather4_jsml">'+jsl[i].p+'mm</span>'+'</li>';}r{%*i*%}eturn strLi;}var tab = _this.find('.op_weather4_xltab li'),xlopen = _this.find('.op_weather4_xlopen').eq(0),xlclose = _this.find('.op_weather4_xlclose').eq(0),xltabcontent = _this.find('.op_weather4_xltabcontent').eq(0),xltwoiconBg = _this.find('.op_weather4_twoicon_bg'),xltwoicon = _this.find('.op_weather4_twoicon').eq(0),tabActive = tab.eq(0),content = _this.find('.op_weather4_xlcon'),xlbgie = _this.find('.op_weather4_twoicon_bgie'),jslulDom = _this.find('.op_weather4_jslul').eq(0),tabContent {%*i*%}= content[0],tab2 = 0,tabAjax = 0;if(browserIE && xlbgie.length>0){xlbgie.each(function(i,o){ o.style.height = 132 + warH + 'px';})}if(xlclose.length>0){xlclose.on('click',function() {xltwoiconBg.each(function(i,o){o.style.height = H + xlHClose + warH+ 'px';});if(browserIE && xlbgie.length>0){xlbgie.each(function(i,o){ o.style.height = 132 + warH + 'px';})}xltabcontent.css('display','none');xltwoicon.css('height',H + xlHClose);xlopen.css('display','block');xlclose.css('display','none');});}if(xl{%*i*%}open.length>0){xlopen.on('click',function() {if(!tabAjax){_this.find('.op_weather4_xlleftfswd').html('');_this.find('.op_weather4_xlleftflfx').html('');jslulDom.html('');_this.ajax(originQuery, srcid, {co:'fswd|flfx|xgzs|folder|fswdaxes|flfxaxes|jsl',success:function(data){if(data[0]){var data = data[0];fswd = data.fswd;flfx = data.flfx;xgzs = data.xgzs;fswdaxes = data.fswdaxes[0];flfxaxes = data.flfxaxes[0];jsl = data.jsl;tabAjax = 1;if(browserIE){A.use('canvas', function(){if(!document.createE{%*i*%}lement('canvas').getContext){A.ui.canvas.init([_this.find('.op_weather4_xlCanvas1').get(0),_this.find('.op_weather4_xlCanvas2').get(0)]);}wdfl(_this.find('.op_weather4_xlCanvas1').get(0),_this.find('.op_weather4_xlCanvascon1').get(0),fswd,flfx);wdfl(_this.find('.op_weather4_xlCanvas2').get(0),_this.find('.op_weather4_xlCanvascon2').get(0),fswd,flfx,1);content[1].style.display='none';});}else{wdfl(_this.find('.op_weather4_xlCanvas1').get(0),_this.find('.op_weather4_xlCanvascon1').get(0),fswd,flfx{%*i*%});wdfl(_this.find('.op_weather4_xlCanvas2').get(0),_this.find('.op_weather4_xlCanvascon2').get(0),fswd,flfx,1);content[1].style.display='none';}_this.find('.op_weather4_xlleftfswd').html(xyValue(fswdaxes));_this.find('.op_weather4_xlleftflfx').html(xyValue(flfxaxes));jslulDom.html(jslUl(jsl));tab.bind('click',function(){var i=tab.index($(this));if(i==3){var xlxgzhtop = _this.find('.op_weather4_xltop').eq(0);xlxgzhtop.html('');xgzhs(xgzs);}tabActive.removeClass('op_weather4_xlactive');tabActive ={%*i*%} $(this);tabActive.addClass('op_weather4_xlactive');tabContent.style.display = 'none';tabContent = content[i];tabContent.style.display = 'block';});}},error: function(){}});}xltwoiconBg.each(function(i,o){o.style.height = H + xlHOpen + warH + 'px';});if(browserIE && xlbgie.length>0){xlbgie.each(function(i,o){ o.style.height = H + xlHClose + warH - 8 + 'px';})}xltabcontent.css('display','block');xltwoicon.css('height',H + xlHOpen);xlopen.css('display','none');xlclose.css('display','block');});}}e{%*i*%}lse if(weather4_twoicondata.folder && XLIE6){_this.find('.op_weather4_xiala').css('display', 'none');_this.find('.op_weather4_twoicon').css('height',H );_this.find('.op_weather4_twoicon_bg').each(function (i,o) {o.style.height = H + warH + 'px';});}});</script>{%/block%}