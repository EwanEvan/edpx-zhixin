{%extends 'c_base.tpl'%} {%block name="data_modifier"%} {%$extData.feData.urData="{pid:'video',type:'tvplay'}"%} {%$escaped_alias=""%} {%if $tplData.allalias && (strpos($extData.OriginQuery, $tplData.originalname) === false)%} {%foreach $tplData.allalias as $item%} {%if strpos($extData.OriginQuery, $item) !== false%} {%$escaped_alias = $item%}{%break%} {%/if%} {%/foreach%} {%/if%} {%$escaped_info = []%} {%if $tplData.releaseTime%}{%$escaped_info[] = $tplData.releaseTime%}{%/if%} {%if $tplData.area%}{%if is_array($tplData.area)%}{%$escaped_info[] = implode(' ',$tplData.area)%}{%else%}{%$escaped_info[] = $tplData.area%}{%/if%}{%/if%} {%if $tplData.lang%}{%$escaped_info[] = $tplData.lang%}{%/if%} {%$escaped_sbtn=0%} {%if  $tplData.playTime[0] && $tplData.playTime[0].houer && isset($tplData.live_url)&& $tplData.live_url[0] %} {%$nowTime=$smarty.now|date_format:'%H'*60+$smarty.now|date_format:'%M'%} {%$stTime=$tplData.playTime[0].houer*60+$tplData.playTime[0].minute%} {%$edTime=$tplData.playTime[0].houer*60+$tplData.playTime[0].minute+$tplData.playTime[0].lengh%} {%if $nowTime>=$stTime && $nowTime<=$edTime%} {%$escaped_sbtn=2%} {%/if%} {%/if%} {%$escaped_row = intval(!!($tplData.epCount || $tplData.latestEp))+intval(!!$escaped_info)+intval(!!$tplData.author)+intval(!!$tplData.tvStation[0].content)+intval(!!$tplData.netUpdate[0].content)%} {%$escaped_lmt=7-$escaped_row-$escaped_sbtn%} {%if $escaped_lmt<=0%} {%$tplData.author=''%} {%$escaped_lmt=1%} {%elseif $escaped_lmt>=4%} {%$escaped_lmt=3%} {%/if%} {%$escaped_lmt=($escaped_lmt-1)*50+40%}{%/block%}{%block name='content'%}<style data-merge>{%fe_fn_c_css css='img'%}{%fe_fn_c_css css='numberset'%}{%fe_fn_c_css css='tabs'%}{%fe_fn_c_css css='dropdown2'%}{%fe_fn_c_css css='btn'%}.op-zx-tv-video-first{width:100%;text-overflow:ellipsis;overflow:hidden;white-space:nowrap}.op-zx-tv-video-split{color:#d8d8d8}.op-zx-tv-video-summary,.op-zx-tv-video-season{padding-left:3em;text-indent:-3em}.op-zx-tv-video-seasonEp{margin-right:24px;white-space:nowrap}.op-zx-tv-video-icon{width:16px;height:16px;margin-top:2px;background-repeat:no-repeat;float:left;background-position:center center;display:inline}.op-zx-tv-video-rgap2{margin-right:2px}.op-zx-tv-video-tgap4{margin-top:4px}.op-zx-{%*i*%}tv-video-rlt{position:relative}.op-zx-tv-video-new a{position:relative}.op-zx-tv-video-new i{position:absolute;right:-10px;top:-5px}.op-zx-tv-video-drlt .op-zx-tv-video-new{z-index:10}.op-zx-tv-video-loading{width:100%;height:94px;overflow:hidden;background:url("http://www.baidu.com/aladdin/img/videoidea/loading_L.gif") no-repeat center center}.op-zx-tv-video-more{color:#00c;position:relative;cursor:pointer;text-decoration:underline;clear:both}.op-zx-tv-video-more .op-zx-tv-video-more-up{display{%*i*%}:block;width:100%;display:none;clear:both}.op-zx-tv-video-more .op-zx-tv-video-more-down{display:block;width:100%;clear:both}.op-zx-tv-video-juhe-conts{padding:0}.op-zx-tv-video-juhe-conts .op-zx-tv-video-juhe-cont{display:none}.op-zx-tv-video-juhe-conts .op-zx-tv-video-juhe-curcont{display:block;color:#666}.op-zx-tv-video-juhe-menu{height:auto;clear:both;border-bottom:1px solid #eee;color:#666;padding:5px 0 10px 0}.op-zx-tv-video-juhe-menu .op-zx-tv-video-juhe-link{color:#00c;text-decoration:un{%*i*%}derline;cursor:pointer;zoom:1;width:16.6%;float:left;display:inline}.op-zx-tv-video-juhe-menu .op-zx-tv-video-juhe-cur-link{color:#333;text-decoration:none;cursor:text}.op-zx-tv-video-moreseason{position:absolute;height:32px;line-height:32px;top:2px;right:130px}.op-zx-tv-video-moreseason a{text-decoration:none}.op-zx-tv-video-hidden{display:none!important}.op-zx-tv-video-error{text-align:center}.op-zx-tv-video-error span{text-decoration:underline;color:#00c;cursor:pointer}.op-zx-video-onesite{po{%*i*%}sition:absolute;top:8px;right:18px;z-index:100;white-space:nowrap}.op-zx-tv-video-econ .op-zx-tv-video-more,.op-zx-tv-video-econ .op-zx-tv-video-juhe-menu{display:none}.op-zx-video-sitecon{width:104px;position:absolute;top:6px;right:5px;z-index:100}.op-zx-tv-video-rtop{position:relative}.op-zx-tv-video-net{position:absolute;right:0;top:0;color:#666}.op-zx-video-sites .c-dropdown2{line-height:1.54}.op-zx-video-sites .c-dropdown2,.op-zx-video-sites .c-dropdown2 .c-dropdown2-btn,.op-zx-video-sites {%*i*%}.c-dropdown2 .c-dropdown2-btn-group,.op-zx-video-sites .c-dropdown2 .c-dropdown2-btn-icon,.op-zx-video-sites .c-dropdown2-btn-icon-border{height:20px;line-height:1.54}.op-zx-video-sites .c-dropdown2-btn-icon,.op-zx-video-sites .c-dropdown2-btn-icon-border{width:20px}.op-zx-video-sites .c-dropdown2-option{text-indent:10px}.op-zx-video-sites .c-dropdown2-option a{display:block;color:#333;text-decoration:none;width:100%;height:20px}.op-zx-tv-video-rlt .c-tabs-nav-li{line-height:1.85;padding-left:12{%*i*%}px;padding-right:12px}.op-zx-tv-video-rlt .c-tabs-nav .c-tabs-nav-sep{height:20px}.op-zx-tv-video-rlt .c-dropdown2 .c-dropdown2-btn-icon{padding-left:5px}</style><style>.op-zx-tv-video-poster img{height:{%fe_fn_c_get_img_height col=6 rate=13.3/10%}px}</style>{%if !isset($tplData.vlinktext)%} {%$tplData.vlinktext='集'%}{%/if%}{%if !isset($tplData.tabSite)%} {%$tplData.tabSite=[0]%}{%/if%}<div class="c-abstract"> <div class="c-row"> <div class="c-span6"> <a target="_blank" href="{%$tplData.url%}" class="op-zx-tv-video-poster"> <img class="c-img c-img6" alt="图片" src="{%$tplData.poster%}"> </a> </div> <div class="c-span18 c-span-last op-zx-tv-video-rtop"> {%if  isset($tplData.net_play_time) && $tplData.net_play_time[0] && $escaped_row>=1%} <div class="op-zx-tv-video-net"> <p>{%$tplData.net_play_time[0].txt|limitlen:36|escape:html%}</p> <p>{%$tplData.net_play_time[0].timetxt|limitlen:36|escape:html%}</p> </div> {%/if%} {%if $tplData.epCount || $tplData.latestEp%} <p class="c-clearfix op-zx-tv-video-tvplay"> {%if $tplData.tabSite[0]['season']%} <span class="c-text c-text-public c-gap-icon-right-small">更新至</span><span>{%$tplData.tab[0].title%} {%if $tplData.finished != 1%} {%$tplData.latestEp%}集 {%/if%} </span> {%else%} {%if $tplData.finished == 1%} <span class="c-text c-text-public c-gap-icon-right-small">已完结</span><span>共{%$tplData.epCount%}集</span> {%else%} <span class="c-text c-text-public c-gap-icon-right-small">更新至</span><span>{%$tplData.latestEp%}集{%if $tplData.epCount%}/共{%$tplData.epCount%}集{%/if%}</span> {%/if%} {%/if%} </p> {%/if%} {%if $escaped_info%} <p class="op-zx-tv-video-first c-gray"> {%foreach $escaped_info as $item%}{%if $item@index != 0%}<span class="c-gap-left-small c-gap-right-small op-zx-tv-video-split">|</span>{%/if%}{%$item%}{%/foreach%} </p> {%/if%} {%if $tplData.author%} <p> <span class="c-gray">作者：</span>{%if $tplData.author[0].link%}<a target="_blank" href="{%$tplData.author[0].link%}">{%$tplData.author[0].name%}</a>{%else%}{%$tplData.author[0].name%}{%/if%} </p> {%/if%} <p> <span class="c-gray">类型：</span>{%foreach  array_slice($tplData.type, 0, 3) as $item%}{%if $item.link%}<a target="_blank" href="{%$item.link%}">{%$item.name%}</a>{%else%}{%$item.name%}{%/if%}{%if !$item@last%}<span class="c-gap-left-small c-gap-right-small op-zx-tv-video-split">|</span>{%/if%}{%/foreach%} </p> {%if $tplData.tvStation[0].content%} <p> <span class="c-gray">{%$tplData.tvStation[0].name|limitlen:12|escape:html%}：</span>{%$tplData.tvStation[0].content|limitlen:52|escape:html%} </p> {%/if%} {%if $tplData.netUpdate[0].content%} <p> <span class="c-gray">{%$tplData.netUpdate[0].name|limitlen:12|escape:html%}：</span>{%$tplData.netUpdate[0].content|limitlen:52|escape:html%} </p> {%/if%} {%if $tplData.summary%} <p class="op-zx-tv-video-summary"> {%$aliasLen = 0%} <span class="c-gray">简介：</span><span>{%if $escaped_alias%}{%$aliasLen =$tplData.alias|string_display_len+8%}（别名：<em>{%$escaped_alias%}</em>）{%/if%}{%$tplData.summary[0].content|limitlen:($escaped_lmt-$aliasLen)%}{%if $tplData.summary[0].link && $tplData.summary[0].content|trim != $tplData.summary[0].content|limitlen:($escaped_lmt-$aliasLen)%}<a target="_blank" href="{%$tplData.summary[0].link%}" style="padding-left:5px;">更多&gt;&gt;</a>{%/if%}</span> </p> {%/if%} {%if $escaped_sbtn==2%} <p class="c-gap-top"> <a class="c-btn c-btn-primary c-btn-large" target="_blank" href="{%$tplData.live_url[0].link%}"><i class="c-icon c-icon-play-white" style="margin-top:8px;margin-right:1px;"></i>{%$tplData.live_url[0].name|limitlen:12|escape:html%}</a> </p> {%/if%} </div> </div>  {%foreach $tplData.tab as $itemSite%} {%foreach $tplData.tabSite as $site%} {%if $itemSite.key == $site.season%} {%$tplData.temp.{%$itemSite.key%}[] = $site%} {%elseif !$site.season%} {%$tplData.temp.{%$itemSite.key%}[] = $itemSite%} {%/if%} {%/foreach%} {%/foreach%} <div class="{%if $tplData.tabSite[0]['season']%}op-zx-tv-video-rlt{%else%}op-zx-tv-video-drlt{%/if%}">  {%if $tplData.tabSite[0]['season']%} {%foreach array_slice($tplData.tab,0,1) as $itemSite%} <div class="op-zx-video-sites"> <div class="c-dropdown2 op-zx-video-sitecon  {%if $tplData.temp.{%$itemSite.key%}|@count<=1%}op-zx-tv-video-hidden{%/if%}"  data-value='{"cnt":"{%$tplData.temp.{%$itemSite.key%}[0]['cnt']%}","key":"{%$tplData.temp.{%$itemSite.key%}[0]['key']%}","season":"{%$tplData.temp.{%$itemSite.key%}[0]['season']%}"}'> <div class="c-dropdown2-btn-group"> <div class="c-dropdown2-btn"><b class="c-gap-right-small op-zx-tv-video-icon" style="background-image:url({%$tplData.temp.{%$itemSite.key%}[0].icon%})"></b>{%$tplData.temp.{%$itemSite.key%}[0]['title']%}</div> <div class="c-dropdown2-btn-icon"> <div class="c-dropdown2-btn-icon-border"> <i class="c-icon c-icon-triangle-down"></i> </div> </div> </div> <div class="c-dropdown2-menu"> <div class="c-dropdown2-menu-inner"> <ul class="c-dropdown2-menubox"> {%foreach $tplData.temp.{%$itemSite.key%} as $item%} <li class="c-dropdown2-option" data-text="&lt;b  class='c-gap-right-small op-zx-tv-video-icon' style='background-image:url({%$item.icon%})'&gt;&lt;/b&gt;{%$item['title']%}" data-value='{"cnt":"{%$item['cnt']%}","key":"{%$item['key']%}","season":"{%$item['season']%}"}'  {%if $item@first%}data-selected="selected"{%/if%}><b class='op-zx-tv-video-icon op-zx-tv-video-tgap4' style='background-image:url({%$item.icon%})'></b>{%$item['title']%}</li> {%/foreach%} </ul> </div> </div> </div> <div class="op-zx-video-onesite {%if $tplData.temp.{%$itemSite.key%}|@count>1%}op-zx-tv-video-hidden{%/if%}" data-value='{"cnt":"{%$tplData.temp.{%$itemSite.key%}[0]['cnt']%}","key":"{%$tplData.temp.{%$itemSite.key%}[0]['key']%}","season":"{%$tplData.temp.{%$itemSite.key%}[0]['season']%}"}'> <b class="c-gap-right-small op-zx-tv-video-icon" style="background-image:url({%$tplData.temp.{%$itemSite.key%}[0].icon%})"></b>{%$tplData.temp.{%$itemSite.key%}[0]['title']%} </div> </div> {%/foreach%} {%/if%} {%if $tplData.tabSite[0]['season']%} {%if $tplData.tab|@count>=6%} <span class="op-zx-tv-video-moreseason "> <a href="{%$tplData.url%}" target="_blank">更多季部&gt;&gt;</a> </span> {%$tplData.tabCnt=4%} {%else%} {%$tplData.tabCnt=5%} {%/if%} {%else%} {%$tplData.tabCnt=4%} {%/if%} <div class="c-tabs c-gap-top" > {%if $tplData.tab != '' && $tplData.tab|count>0 && $tplData.vlink != '' && $tplData.vlink|count>0%} <ul class="c-tabs-nav{%if count($tplData.tab) == 1%} c-tabs-nav-one{%/if%}" data-click="{'fm':'beha'}"> {%foreach array_slice($tplData.tab,0 , $tplData.tabCnt) as $item%} <li class="c-tabs-nav-li  {%if $item@index eq 0%}c-tabs-nav-selected{%/if%}" data-key="{%$item.key|escape:'html'%}" data-flag="{%if $item@index eq 0 && $eitem@index eq 0%}1{%else%}0{%/if%}"> {%if $item.icon%} <b class="op-zx-tv-video-icon op-zx-tv-video-rgap2" style="background-image:url({%$item.icon%})"></b> {%/if%} {%$item.title|escape:'html'%}</li> {%if !$item@last%} <li class="c-tabs-nav-sep"></li> {%/if%} {%/foreach%} </ul> {%/if%} {%foreach array_slice($tplData.tab,0 , $tplData.tabCnt) as $eitem%} <div class="c-tabs-content op-zx-tv-video-ulbox" {%if $eitem.key%}data-season="{%$eitem.key|escape%}"{%/if%}   {%if $eitem@index!=0%}style="display:none;"{%/if%}> {%foreach $tplData.temp.{%$eitem.key%} as $itemtab%} <div class="op-zx-tv-video-dtl {%if !$itemtab@first%}op-zx-tv-video-hidden{%/if%}" data-flag="{%if $itemtab@index eq 0 && $eitem@index eq 0%}1{%else%}0{%/if%}" data-value='{"cnt":"{%$itemtab['cnt']%}","key":"{%$itemtab['key']%}","title":"{%$itemtab['title']%}","season":"{%$itemtab['season']%}"}' > {%$juheCnt=($itemtab.cnt+96-1)/96 %} {%$juheCnt=$juheCnt|string_format:"%d"%} <div class="c-gap-bottom-small op-zx-tv-video-juhe-conts"> {%for $tempDataJuheCnt=1 to $juheCnt %} <div class="c-clearfix op-zx-tv-video-juhe-cont {%if $tempDataJuheCnt==1%}op-zx-tv-video-juhe-curcont{%/if%}"> {%if $tempDataJuheCnt == 1 && $itemtab@first && $eitem@first%} <ul class="c-numberset"> {%foreach $tplData.vlink as $itemvlink%} {%if $itemvlink@index > 15 || $itemvlink.key != $itemtab.key|| $itemvlink.season != $itemtab.season%} {%break%} {%/if%} <li class="c-gap-top {%if $itemvlink@index%8==7%}c-numberset-last{%/if%} {%if $itemvlink.latest == 'true' %}op-zx-tv-video-new{%/if%}"> <a  {%if $itemvlink.linkurl %}href="{%$itemvlink.linkurl|escape:'html'%}" target="_blank" {%else%} href="javascript:;" style="color:#666;"  {%/if%}>{%$itemvlink.linkcontent|escape:'html'%}{%$tplData.vlinktext%} {%if $itemvlink.latest == 'true' %} <i class="c-text c-text-danger">新</i> {%/if%} </a> </li> {%/foreach%} </ul> {%/if%} </div> {%/for%} </div> <div class="c-gap-top c-clearfix op-zx-tv-video-juhe-menu op-zx-tv-video-hidden" data-click="{'fm':'beha'}"> </div> {%if $itemtab.cnt > 16%} <div class="c-gap-top op-zx-tv-video-more" data-click="{'fm':'beha'}"> <a class="op-zx-tv-video-more-down OP_LOG_OTHERS" data-flag="0" data-cnt="{%$itemtab.cnt%}"> <i class="c-icon c-icon-unfold c-gap-icon-right-small"></i> <span>显示全部《{%$itemtab.moretip|highlight:0%}》视频</span> </a> <a class="op-zx-tv-video-more-up OP_LOG_OTHERS"> <i class="c-icon c-icon-fold c-gap-icon-right-small"></i> <span>收起 </span> </a> </div> {%/if%} </div> {%/foreach%} </div> {%/foreach%} </div>  </div> </div><div class="op-zx-tv-video-loading op-zx-tv-video-hidden">&nbsp;</div><script >
   A.setup({
       "key":"{%$tplData.key|escape:'html'|escape:'javascript'%}",
	   "vtxt":"{%$tplData.vlinktext|escape:'html'|escape:'javascript'%}",
	   "sid":"{%$extData.resourceid%}",
	   "finish":"{%$tplData.finished%}",
	   "vlinktext":"{%$tplData.vlinktext|escape:'html'|escape:'javascript'%}",
	   "temp":{%json_encode($tplData.temp)%}
   });
</script><script data-merge>A.setup(function(){var _this = this;var finish = _this.data.finish,tabTemp = _this.data.temp,sid = _this.data.sid,vlinktext = _this.data.vlinktext;var ajaxFinished = false;var timer=null,dd;var videoSearching = false,$dropDoms = _this.find('.op-zx-video-sitecon'),$conts = $(_this.find('.c-tabs-content')),$vload = _this.find('.op-zx-tv-video-loading'),$oneSite=_this.find('.op-zx-video-onesite');function initDrop($dropDom,index){if($dropDom.hasClass('c-dropdown2')){A.us{%*i*%}e('dropdown21', function(){ dd = A.ui.dropdown21($dropDom.get(0),{onchange:function(){var $newtabcont=$conts.filter(':visible'),nowIndex=dd.getIndex(),nowDd=dd.get(nowIndex),$dtldom=$newtabcont.find('.op-zx-tv-video-dtl').eq(nowIndex),$cntdom=$dtldom.find('.op-zx-tv-video-juhe-cont'),nowValue=$.parseJSON(nowDd.value);$newtabcont.find('.op-zx-tv-video-dtl').filter(':visible').addClass('op-zx-tv-video-hidden');$dtldom.removeClass('op-zx-tv-video-hidden');getVideoData(nowValue, 0, 16, $dtldom, $cnt{%*i*%}dom,$newtabcont);$dtldom.find('.op-zx-tv-video-juhe-link').eq(0).click();var $upBtn=$dtldom.find('.op-zx-tv-video-more-up').eq(0),$curWrap=$dtldom.find('.op-zx-tv-video-juhe-curcont'),$menu=$dtldom.find('.op-zx-tv-video-juhe-menu'),$downBtn=$dtldom.find('.op-zx-tv-video-more-down');if($curWrap.length>0) {$curWrap.find('ul').eq(0).show().siblings('ul').hide();}$downBtn.css('display','block');$upBtn.css('display','none');if($menu.length>0){$menu.addClass('op-zx-tv-video-hidden');};} });});}};funct{%*i*%}ion insertDrop(){var $newCont=$conts.filter(':visible');var index=0;if($dropDoms.length>0){var season=$.parseJSON($newCont.find('.op-zx-tv-video-dtl').eq(0).attr('data-value')).season;var tabSite=tabTemp[season];var key=$.parseJSON(dd.getValue()).key;dd.removeAll();var presel=0;for(var i=0;i<tabSite.length;i++){if(key==tabSite[i].key){presel=1;}else{presel=0;}dd.add({value: '{"cnt":"'+tabSite[i].cnt+'","key":"'+tabSite[i].key+'","season":"'+tabSite[i].season+'"}',selected: presel, text: '<b  cla{%*i*%}ss="c-gap-right-small op-zx-tv-video-icon" style="background-image:url('+tabSite[i].icon+')"></b>'+tabSite[i].title});}if(tabSite.length>1){$oneSite.addClass('op-zx-tv-video-hidden');$dropDoms.removeClass('op-zx-tv-video-hidden');}else{$oneSite.html('<b class="c-gap-right-small op-zx-tv-video-icon" style="background-image:url('+tabSite[0].icon+')"></b>'+tabSite[0].title);$oneSite.attr('data-value','{"cnt":"'+tabSite[0].cnt+'","key":"'+tabSite[0].key+'","season":"'+tabSite[0].season+'"}');$oneSit{%*i*%}e.removeClass('op-zx-tv-video-hidden');$dropDoms.addClass('op-zx-tv-video-hidden');}index=dd.getIndex();}var $newtabcont=$newCont.find('.op-zx-tv-video-dtl').eq(index),nowValue=$.parseJSON($newtabcont.attr('data-value')), $cntdom=$newtabcont.find('.op-zx-tv-video-juhe-cont').eq(0);$newtabcont.removeClass('op-zx-tv-video-hidden').siblings('.op-zx-tv-video-dtl').addClass('op-zx-tv-video-hidden');getVideoData(nowValue, 0, 16, $newtabcont, $cntdom,$newCont);$newtabcont.find('.op-zx-tv-video-juhe-lin{%*i*%}k').eq(0).click();$newtabcont.find('.op-zx-tv-video-more-up').eq(0).click();}function initMenu(dataCnt){var str='';var juheCnt=parseInt((dataCnt+96-1)/96);if(finish==1){for(var tempDataJuheCnt=1;tempDataJuheCnt<=juheCnt;tempDataJuheCnt++){if(tempDataJuheCnt==1){str+="<div class='op-zx-tv-video-juhe-link op-zx-tv-video-juhe-cur-link OP_LOG_OTHERS' data-flag='1'>"+((tempDataJuheCnt-1)*96+1)+"~"+(tempDataJuheCnt*96)+vlinktext+"</div>";}else{if(tempDataJuheCnt==juheCnt){if((tempDataJuheCnt-1)*96+1=={%*i*%}juheCnt){str+="<div class='op-zx-tv-video-juhe-link OP_LOG_OTHERS' data-flag='0'>"+dataCnt+vlinktext+"</div>";}else{str+="<div class='op-zx-tv-video-juhe-link OP_LOG_OTHERS' data-flag='0'>"+((tempDataJuheCnt-1)*96+1)+"~"+dataCnt+vlinktext+"</div>";}}else{str+="<div class='op-zx-tv-video-juhe-link OP_LOG_OTHERS' data-flag='0'>"+((tempDataJuheCnt-1)*96+1)+"~"+(tempDataJuheCnt*96)+vlinktext+"</div>";}}}}else{for(var tempDataJuheCnt=1;tempDataJuheCnt<=juheCnt;tempDataJuheCnt++){if(tempDataJuheCnt==1{%*i*%}){str+="<div class='op-zx-tv-video-juhe-link op-zx-tv-video-juhe-cur-link OP_LOG_OTHERS' data-flag='1'>"+(dataCnt-96+1)+"~"+dataCnt+vlinktext+"</div>";}else{if(tempDataJuheCnt!=juheCnt){str+="<div class='op-zx-tv-video-juhe-link OP_LOG_OTHERS' data-flag='0'>"+(dataCnt-96*(tempDataJuheCnt-1))+"~"+(dataCnt-96*(tempDataJuheCnt)+1)+vlinktext+"</div>";}else{if(dataCnt-(juheCnt-1)*96==1){str+="<div class='op-zx-tv-video-juhe-link OP_LOG_OTHERS' data-flag='0'>"+1+vlinktext+"</div>";}else{str+="<div cla{%*i*%}ss='op-zx-tv-video-juhe-link OP_LOG_OTHERS' data-flag='0'>"+1+"~"+(dataCnt-(juheCnt-1)*96)+vlinktext+"</div>";}}}}}return str;}function initJuheMenu(){$('.op-zx-tv-video-juhe-link').click(function(){if(videoSearching){return;}var $obj=$(this);if(!$obj.hasClass('op-zx-tv-video-juhe-cur-link')){var $wrap=$(this).parents('.op-zx-tv-video-dtl'),index=$wrap.find('.op-zx-tv-video-juhe-link').index(this),$oldmenu=$wrap.find('.op-zx-tv-video-juhe-cur-link').eq(0),$oldcont=$wrap.find('.op-zx-tv-video-juh{%*i*%}e-curcont').eq(0),$newcont=$wrap.find('.op-zx-tv-video-juhe-cont').eq(index),$nowcont=$wrap.parents('.c-tabs-content'),nowValue=$.parseJSON($wrap.attr('data-value'));getVideoData(nowValue, index*96, 96, $obj, $newcont,$nowcont);$oldmenu.removeClass('op-zx-tv-video-juhe-cur-link');$oldcont.removeClass('op-zx-tv-video-juhe-curcont');$obj.addClass('op-zx-tv-video-juhe-cur-link');$newcont.addClass('op-zx-tv-video-juhe-curcont');$newcont.find('ul').show();} });}function displayVideoDom($sobj,$hobj01){%*i*%}{$sobj.removeClass('op-zx-tv-video-hidden');$hobj01.addClass('op-zx-tv-video-hidden'); };function getVideoData(val, apn, arn, $obj, $cntdom,$nowCont){if($obj.attr('data-flag')=='1'){displayVideoDom($nowCont,$vload);return;} videoSearching = true;displayVideoDom($vload,$nowCont);if(val.season){var myCo='vlink[key=' + val.key + ',season='+val.season+']';}else{var myCo='vlink[key=' + val.key + ']';}if(sid>=6000&&sid<=7000){var url = 'http://opendata.baidu.com/api.php?format=json&ie=utf-8&oe=utf-8&q{%*i*%}uery='+encodeURIComponent(_this.data.key)+encodeURIComponent(val.title)+'&co='+myCo+'&apn='+apn+'&arn='+arn+'&resource_id='+sid;}else{var url = 'http://opendata.baidu.com/api.php?format=json&ie=utf-8&oe=utf-8&query='+encodeURIComponent(_this.data.key)+'&co='+myCo+'&apn='+apn+'&arn='+arn+'&resource_id='+sid; }$.ajax({ url: url,dataType:'jsonp', timeout: 6000, jsonp:'cb',success: function(data){if(data.data[0]&&data.data[0].vlink){if(ajaxFinished) return;videoSearching = false;addVideoLink(data, ${%*i*%}cntdom,$nowCont);$obj.attr('data-flag','1');$nowCont.removeClass('op-zx-tv-video-econ');}else{$obj.attr('data-flag','0');videoSearching = false;displayVideoDom($nowCont,$vload);$nowCont.addClass('op-zx-tv-video-econ');$cntdom.html('<p class="c-gap-top op-zx-tv-video-error">抱歉，网络发生错误，<span>请刷新</span></p>');$cntdom.parents('.op-zx-tv-video-dtl').attr('data-flag','0').find('.op-zx-tv-video-more-down').attr('data-flag','0');$cntdom.find('span').click(function(){var $sCont=$(this).parents('.op-zx-tv-{%*i*%}video-dtl');$sCont.attr('data-flag','0');var sValue=$.parseJSON($sCont.attr('data-value'));$sdom=$sCont.find('.op-zx-tv-video-juhe-cont');getVideoData(sValue, 0, 16, $sCont, $sdom,$sCont.parents('.c-tabs-content'));});}},error : function(){$obj.attr('data-flag','0');videoSearching = false;displayVideoDom($nowCont,$vload);$nowCont.addClass('op-zx-tv-video-econ');$cntdom.html('<p class="c-gap-top op-zx-tv-video-error">抱歉，网络发生错误，<span>请刷新</span></p>');$cntdom.parents('.op-zx-tv-video-dtl').attr('da{%*i*%}ta-flag','0').find('.op-zx-tv-video-more-down').attr('data-flag','0');$cntdom.find('span').click(function(){var $sCont=$(this).parents('.op-zx-tv-video-dtl');$sCont.attr('data-flag','0');var sValue=$.parseJSON($sCont.attr('data-value'));$sdom=$sCont.find('.op-zx-tv-video-juhe-cont');getVideoData(sValue, 0, 16, $sCont, $sdom,$sCont.parents('.c-tabs-content'));});}});};function addVideoLink(data, $cntdom,$nowCont){var data = data.data[0].vlink,html = '';if(!data){return;}var len = data.length;for {%*i*%}(var i = 0, j = 0; i < len; i ++) {if (i%16 == 0) {html += '<ul  class="c-numberset">';j++;}html += '<li class="c-gap-top';if(i%8==7){ html += ' c-numberset-last';}if(data[i].latest == 'true'){ html += ' op-zx-tv-video-new';}if(data[i].linkurl){html += '"><a target="_blank" href="'+ data[i].linkurl;}else{html +='"><a href="javascript:;" style="color:#666;"';}html +='">'+ data[i].linkcontent+ _this.data.vtxt;if (data[i].latest == 'true') {html += '<i class="c-text c-text-danger">新</i>';}html += '{%*i*%}</a></li>';if ( i == j*16-1 || i == len-1) {html += '</ul>';}};$cntdom.html(html);timer = setTimeout(function(){$nowCont.removeClass('op-zx-tv-video-hidden'); $vload.addClass('op-zx-tv-video-hidden'); }, 250);};initDrop($dropDoms,0);A.use('tabs5', function(){A.ui.tabs5(_this.find('.c-tabs')[0],{onChange:function(){videoSearching = false;insertDrop();}});});$('.op-zx-tv-video-more-down').click(function(){if(videoSearching){return;}var $downBtn=$(this),$upBtn=$downBtn.next('.op-zx-tv-video-more-up{%*i*%}'),$nowcont=$downBtn.parents('.op-zx-tv-video-dtl'),$menu=$nowcont.find('.op-zx-tv-video-juhe-menu'),$curWrap=$nowcont.find('.op-zx-tv-video-juhe-curcont'),nowValue=$.parseJSON($nowcont.attr('data-value')),sCnt=parseInt(nowValue.cnt);if($downBtn.attr('data-flag') == '0') {if(sCnt>96){$menu.html(initMenu(sCnt));initJuheMenu();}getVideoData(nowValue, 0, 96, $downBtn, $curWrap,$nowcont.parents('.c-tabs-content'));}$downBtn.css('display','none');$upBtn.css('display','block');if($curWrap) {$curWrap.f{%*i*%}ind('ul').show();}if(sCnt>96){$menu.removeClass('op-zx-tv-video-hidden');}});_this.find('.op-zx-tv-video-more-up').bind('click',function(){var $upBtn=$(this),$nowcont=$upBtn.parents('.op-zx-tv-video-dtl'),$curWrap=$nowcont.find('.op-zx-tv-video-juhe-curcont'),$menu=$nowcont.find('.op-zx-tv-video-juhe-menu'),$downBtn=$nowcont.find('.op-zx-tv-video-more-down');if($curWrap.length>0) {$curWrap.find('ul').eq(0).show().siblings('ul').hide();}$downBtn.css('display','block');$upBtn.css('display','none'){%*i*%};if($menu.length>0){$menu.addClass('op-zx-tv-video-hidden');};});this.dispose = function(){clearTimeout(timer);if(!ajaxFinished){ajaxFinished = true;}dd&&dd.dispose&&dd.dispose();};});</script>{%/block%}