{%extends 'c_base.tpl'%} {%block name='data_modifier'%}{%$extData.feData.hasTitleGap=false%}{%/block%}{%block name='title'%}{%/block%}{%block name='content'%}<style  data-merge>{%fe_fn_c_css css='input'%}{%fe_fn_c_css css='btn'%}.op_ticket_title,.op_ticket_notitle{font-size:1.07em;font-weight:bold}.op_ticket_safetip{color:#4bad37;font-weight:bold}.op_ticket_safetip .c-icon{_vertical-align:middle}.op_ticket_table{border-collapse:collapse}.op_ticket_table td{padding:0;font-size:1em;line-height:1.54}.op_ticket_col{display:inline-block;vertical-align:middle}.op_ticket_exchange{padding-left:5px;padding-right:5px}#op_ticket_input2,#op_ticket_span2{display:none}.tangram_sug_wpr{border:0}.tangram_sug_wpr table{z-index:999;min-w{%*i*%}idth:129px;width:auto;*width:136px;border:1px solid #d0d0d0}.tangram_sug_wpr td{white-space:nowrap}.op_ticket_error{margin:-2px;padding-left:5px;background-color:#d4443c;color:#fff}.op_ticket_noairplane{background:#f5f5f5;padding:4px 0}.op_ticket_noairplane p{margin:4px 4px 4px 7px}.op-ticket-calendarbox table.opui-calendar-cal .opui-calendar-mon{width:14em}.op-ticket-calendarbox table.opui-calendar-cal .opui-calendar-mon th{font-size:1.07em}.op-ticket-calendarbox table.opui-calendar-cal .opui-c{%*i*%}alendar-mon h5{font-size:1.23em;height:1.25em;line-height:1.25em;background:url();background-color:#e3e9f7}.op-ticket-calendarbox table.opui-calendar-cal td{font-size:1.07em;height:1.8em;-webkit-tap-highlight-color:#aaa}</style><div class="op_ticket_title" style="display:none"> </div>{%if $tplData.startcity%} {%fe_fn_c_title_prefix%} {%if  ($tplData.startcityAlias == '') && ($tplData.destinationAlias == '')%} <a href="about:blank" target="_blank" class="op_ticket_ttllink"> {%$tplData.title|highlight:0%} </a> {%else%} <span class="op_ticket_notitle">{%$tplData.title%}</span> {%/if%} {%fe_fn_c_title_suffix title="{%$tplData.title%}" url="{%$tplData.url%}"%} {%else%} {%fe_fn_c_title_prefix%}{%fe_fn_c_title title="{%$tplData.title%}" url="{%$tplData.url%}"%}{%fe_fn_c_title_suffix title="{%$tplData.title%}" url="{%$tplData.url%}"%} {%/if%}<div class="op_ticket"> <p class="op_ticket_safetip"> <i class="c-icon c-icon-safe c-gap-right-small"></i>已通过百度认证，请放心使用 </p> {%if ($tplData.startcityAlias != '') || ($tplData.destinationAlias != '')%} <div class="op_ticket_noairplane c-gap-top-small"> {%if $tplData.abstract1 != ''%} <p> {%$tplData.abstract1|highlight:0%}{%if $tplData.abstract2 != ''%}{%$tplData.abstract2|highlight:0%}{%/if%} </p> {%/if%} {%if $tplData.trainlink[0].url != ''%} <p> {%if $tplData.trainlink[0].tip != ''%}{%$tplData.trainlink[0].tip%}{%/if%}<a target="_blank" href="{%$tplData.trainlink[0].url%}">{%$tplData.trainlink[0].cont%}</a> </p> {%/if%} </div> {%/if%} <div class="c-border c-gap-top-small"> <table class="op_ticket_table"> <tr> <td> <span class="c-gap-right">出发城市</span> </td> <td> <span class="op_ticket_col c-gap-right-small"> <span class="c-input op_ticket_pos_start"> <input value="{%if $tplData.startcityAlias%}{%$tplData.startcityAlias%}{%else%}{%if $tplData.startcity%}{%$tplData.startcity|escape:'html'%}{%/if%}{%/if%}" class="op_ticket_text" name="op_ticket_start" id="op_ticket_start" type="text"> <i class="c-icon c-icon-map"></i> </span> </span><a href="javascript:;" class="c-btn op_ticket_exchange"><i class="c-icon c-icon-exchange"></i></a><span class="op_ticket_col c-gap-left-small"> <span class="c-input op_ticket_pos_end"> <input value="{%if $tplData.destinationAlias%}{%$tplData.destinationAlias%}{%else%}{%if $tplData.destination%}{%$tplData.destination|escape:'html'%}{%/if%}{%/if%}" class="op_ticket_text" name="op_ticket_end" id="op_ticket_end" type="text"> <i class="c-icon c-icon-map"></i> </span> </span> </td> </tr> <tr class=""> <td>航班类型</td> <td> <form class="c-gap-top-small c-gap-bottom-small" style="position:static" autocomplete="off" accept-charset="gb2312"> <label><input class="OP_LOG_BTN" checked="checked" type="radio" name="op_ticket_type" value="1" data-click="{'fm':'beha'}" />单程</label><label class="c-gap-left"><input  class="OP_LOG_BTN" type="radio" name="op_{%*i*%}ticket_type" value="0" data-click="{'fm':'beha'}" />往返</label> </form> </td> </tr> <tr> <td>出发时间</td> <td> <span class="op_ticket_col"> <div class="c-input op_ticket_input" id="op_ticket_input1"> <input readonly type="text" id="op_ticket_time1"> <i class="c-icon c-icon-calendar" id="op_ticket_cbtn1"></i> </div> </span><span class="op_ticket_col c-gap-right c-gap-left"><span id="op_ticket_span2" class="op_ticket_span2">返程时间</span></span><span class="op_ticket_col"> <div class="c-input op_ticket_i{%*i*%}nput" id="op_ticket_input2"> <input readonly type="text" id="op_ticket_time2"> <i id="op_ticket_cbtn2" class="c-icon c-icon-calendar"> </i> </div> </span> </td> </tr> <tr> {%if $tplData.button1 && $tplData.button2 && $tplData.button3 && $tplData.button4%} <td colspan="2"> {%else%} <td></td> <td> {%/if%} <div class="c-gap-top">{%if $tplData.button1%}<a class="c-btn c-btn-primary" onclick="op_ticket_url(this,'qunar',3)" href="javascript:void(0)"> 去哪儿网查询</a>{%/if%}{%if $tplData.button2%}<span class="c-gap-left"><a class="c-btn c-btn-primary" onclick="op_ticket_url(this,'ctrip',4)" href="javascript:void(0)">携程网查询</a></span>{%/if%}{%if $tplData.button3%}<span class="c-gap-left"><a class="c-btn c-btn-primary" onclick="op_ticket_url(this,'17u',5)" href="javascript:void(0)">同程网查询</a></span>{%/if%}{%if $tplData.button4%}<span class="c-gap-left"><a class="c-btn c-btn-primary" onclick="op_ticket_url(this,'mg',6)" href="javascript:void(0)"> 芒果网查询</a></span>{%/if%} </div> </td> </tr> </table> </div></div><div id="op_ticket_cc1" class="op-ticket-calendarbox"> </div><div id="op_ticket_cc2" class="op-ticket-calendarbox"> </div><script >var cityList = '阿克苏|akesu|AKU,阿勒泰|aletai|AAT,安康|ankang|AKA,安庆|anqing|AQG,鞍山|anshan|AOG,安顺|anshun|AVA,百色|baise|AEB,保山|baoshan|BSD,包头|baotou|BAV,北海|beihai|BHY,北京|beijing|BJS,博乐|bole|BPL,长白山|changbaishan|NBS,长春|changchun|CGQ,常德|changde|CGD,昌都|changdu|BPX,长沙|changsha|CSX,长治|changzhi|CIH,常州|changzhou|CZX,朝阳|chaoyang|CHG,成都|chengdu|{%*i*%}CTU,赤峰|chifeng|CIF,重庆|chongqing|CKG,大理|dali|DLU,大连|dalian|DLC,丹东|dandong|DDG,大庆|daqing|DQA,大同|datong|DAT,达州|dazhou|DAX,东营|dongying|DOY,敦煌|dunhuang|DNH,鄂尔多斯|eerduosi|DSN,恩施|enshi|ENH,二连浩特|erlianhaote|ERL,佛山|foshan|FUO,阜阳|fuyang|FUG,富蕴|fuyun|FYN,福州|fuzhou|FOC,赣州|ganzhou|KOW,格尔木|geermu|GOQ,广汉|guanghan|GHN,广元|guangyuan|GYS,广州|guangzhou|CAN,桂林|guilin|KWL,贵阳|guiyang|KWE,固原|guyuan|GYU,哈尔滨|haerbin|HRB,海口|haikou|HAK,海拉尔|hailaer|HLD,哈密|hami|HMI,邯郸|handan|HDG,杭州|hangzhou|HGH,汉中|hanzhong|HZG,合肥|hefei|HFE,黑河{%*i*%}|heihe|HEK,衡阳|hengyang|HNY,和田|hetian|HTN,淮安|huaian|HIA,黄龙|huanglong|JZH,黄山|huangshan|TXN,呼和浩特|huhehaote|HET,惠州|huizhou|HUZ,佳木斯|jiamusi|JMU,嘉峪关|jiayuguan|JGN,吉林|jilin|JIL,济南|jinan|TNA,景德镇|jingdezhen|JDZ,井冈山|jinggangshan|JGS,济宁|jining|JNG,晋江|jinjiang|JJN,锦州|jinzhou|JNZ,九江|jiujiang|JIU,酒泉|jiuquan|CHW,鸡西|jixi|JXA,喀纳斯|kanasi|KJI,康定|kangding|KGT,喀什|kashi|KHG,克拉玛依|kelamayi|KRY,库车|kuche|KCA,库尔勒|kuerle|KRL,昆明|kunming|KMG,兰州|lanzhou|LHW,拉萨|lasa|LXA,连城|liancheng|LCX,连云港|lianyungang|LYG,荔波|libo|LLB,丽江|lijia{%*i*%}ng|LJG,临沧|lincang|LNJ,临沂|linyi|LYI,林芝|linzhi|LZY,黎平|liping|HZH,柳州|liuzhou|LZH,洛阳|luoyang|LYA,泸州|luzhou|LZO,芒市|mangshi|LUM,满洲里|manzhouli|NZH,梅县|meixian|MXZ,绵阳|mianyang|MIG,漠河|mohe|OHE,牡丹江|mudanjiang|MDG,那拉提|nalati|NLT,南昌|nanchang|KHN,南充|nanchong|NAO,南京|nanjing|NKG,南宁|nanning|NNG,南通|nantong|NTG,南阳|nanyang|NNY,宁波|ningbo|NGB,攀枝花|panzhihua|PZI,黔江|qianjiang|JIQ,且末|qiemo|IQM,青岛|qingdao|TAO,庆阳|qingyang|IQN,秦皇岛|qinhuangdao|SHP,齐齐哈尔|qiqihaer|NDG,衢州|quzhou|JUZ,三亚|sanya|SYX,上海|shanghai|SHA,汕头|shantou|SWA,沙市{%*i*%}|shashi|SHS,沈阳|shenyang|SHE,深圳|shenzhen|SZX,石家庄|shijiazhuang|SJW,思茅|simao|SYM,塔城|tacheng|TCG,太原|taiyuan|TYN,台州|taizhou|HYN,唐山|tangshan|TVS,腾冲|tengchong|TCZ,天津|tianjin|TSN,天水|tianshui|THQ,通化|tonghua|TNH,通辽|tongliao|TGO,铜仁|tongren|TEN,吐鲁番|tulufan|TLQ,万州|wanzhou|WXN,潍坊|weifang|WEF,威海|weihai|WEH,文山|wenshan|WNH,温州|wenzhou|WNZ,乌海|wuhai|WUA,武汉|wuhan|WUH,乌兰浩特|wulanhaote|HLH,乌鲁木齐|wulumuqi|URC,无锡|wuxi|WUX,武夷山|wuyishan|WUS,梧州|wuzhou|WUZ,厦门|xiamen|XMN,西安|xian|SIA,襄樊|xiangfan|XFN,香格里拉|xianggelila|DIG,西昌|xich{%*i*%}ang|XIC,锡林浩特|xilinhaote|XIL,兴义|xingyi|ACX,西宁|xining|XNN,西双版纳|xishuangbanna|JHG,徐州|xuzhou|XUZ,延安|yanan|ENY,盐城|yancheng|YNZ,延吉|yanji|YNJ,烟台|yantai|YNT,宜宾|yibin|YBP,宜昌|yichang|YIH,伊春|yichunhlj|LDS,银川|yinchuan|INC,伊宁|yining|YIN,义乌|yiwu|YIW,永州|yongzhou|LLF,榆林|yulin|UYN,运城|yuncheng|YCU,玉树|yushu|YUS,张家界|zhangjiajie|DYG,湛江|zhanjiang|ZHA,昭通|zhaotong|ZAT,郑州|zhengzhou|CGO,芷江|zhijiang|HJJ,中卫|zhongwei|ZHY,舟山|zhoushan|HSN,珠海|zhuhai|ZUH,遵义|zunyi|ZYI';</script> <script >A.setup(function() {var _this = this;var {%*i*%}timere,timert,bapp,op_ticket_sg,op_ticket_sg1;var op_ticket_svalue = _this.find('.op_ticket_text').get(0),op_ticket_evalue = _this.find('.op_ticket_text')[1],exchange = _this.find('.op_ticket_exchange').eq(0),op_ticket_gevalue = op_ticket_evalue.value;$(op_ticket_svalue).on('focus', function() {this.select();});$(op_ticket_evalue).on('focus', function() {this.select();});exchange.on('click', function(){var tmp = op_ticket_evalue.value;op_ticket_evalue.value = op_ticket_svalue.value;op_ticket_sva{%*i*%}lue.value = tmp;});{%if $tplData.startcity%};var op_ticket_gsvalue = op_ticket_svalue.value,iframeHeight = 243; function p(s) {return s < 10 ? '0' + s : s;}function getNormalDate(date) {return '' + date.getFullYear() + '-' + ('0' + (date.getMonth() + 1)).slice(- 2) + '-' + ('0' + date.getDate()).slice(- 2);}function getRightDate(str) {str = str.toString().match(/^(\d+)(\d\d)(\d\d)/);str.shift();return new Date(str[0], str[1] - 1, str[2]);}{%if ($tplData.startcityAlias == '') && ($tplData.destinationAlias == '')%}var baidu_time = function(time) {var time = new Date(time),title = _this.find('.op_ticket_ttllink').get(0);var str = getNormalDate(getRightDate('' + time.getFullYear() + p(time.getMonth() + 1) + p(time.getDate() + 1)));title.href = 'http://flight.qunar.com/twell/flight/Search.jsp?searchType=OnewayFlight&fromCity=' + encodeURIComponent('{%$tplData.startcity|escape:'html'%}') + '&toCity=' + encodeURIComponent('{%$tplData.destination|escape:'html'%}') + '&fromDate=' + str + '&charset=utf8&ex_track=bd_aladding_flight_title';};baidu_time(bdServerTime * 1000);{%/if%}{%else%};_this.find('.op_ticket_text')[0].value = '{%$extData.AutoExtendedLocation|escape:'html'|escape:'javascript'%}';{%/if%};function sug_canlender(){var s = _this.find(".op_ticket_text")[0].value;var e = _this.find(".op_ticket_text")[1].value;var d = _this.find(".op_ticket_title")[0];var strHTML = d.innerHTML;if ("" == s || "" == e) {return}strHTML = strHTML.replace(s, "<span style='font-weight:bold'>" + s + "</span>");strHTML = strHTML.replace(e, "<span style='font-weight:bold'>" + e + "</span>");d.innerHTML = strHTML;var startinput = _this.find(".op_ticket_text")[0], endinput = _this.find(".op_ticket_text")[1];win{%*i*%}dow.op_ticket_startcity = ["", "", ""];window.op_ticket_endcity = ["", "", ""];var getD = function(id) {var a = _this.find('#'+id)[0].value.match(/^(\d+)-(\d\d)-(\d\d)/);if (a && a.length == 4) {return parseInt("" + a[1] + a[2] + a[3])} else {return false}};var getS = function(d) {d = d.toString().match(/^(\d+)(\d\d)(\d\d)\b/);d = new Date(d[1], d[2] - 1, d[3]);return "" + d.getFullYear() + "-" + ("0" + (d.getMonth() + 1)).slice(-2) + "-" + ("0" + d.getDate()).slice(-2) + "(周" + ("日一二三四五六".charA{%*i*%}t(d.getDay())) + ")"};var in1 = "op_ticket_time1", el1 = "op_ticket_cc1", in2 = "op_ticket_time2", el2 = "op_ticket_cc2";function hiDate() {var d = [D1];if (_this.find(".OP_LOG_BTN")[1].checked) {d.push(D2)}this.setDay(d, function(td) {this.addClass(td, "op_ticket_cell_seledted")})}var c0, c1;var D1, D2;var bdate;var Today;var baidu_time = function(time) {bdate = new Date(time)};baidu_time(bdServerTime * 1000);function getNormalDate(date) {return "" + date.getFullYear() + "-" + ("0" + (date.getM{%*i*%}onth() + 1)).slice(-2) + "-" + ("0" + date.getDate()).slice(-2)}function getRightDate(str) {str = str.toString().match(/^(\d+)(\d\d)(\d\d)/);str.shift();return new Date(str[0], str[1] - 1, str[2])}function calUiCallback() {if (!Today) {bdate = new Date(bdServerTime * 1000)}Today = bdate.getFullYear() * 10000 + (bdate.getMonth() + 1) * 100 + (bdate.getDate());G(in1).value = getS(Today + 1);G(in2).value = getS(Today + 3);D1 = getD(in1), D2 = getD(in2);c0 = A.ui.calendar({input : in1,position : "op{%*i*%}_ticket_input1",element : el1,count : 2,date : 20090921,today : Today,between : [Today, 99999999],onShow : function() {this.setHtml(D1);c1.hide();hiDate.call(this)},onChange : function() {hiDate.call(this)},onSelectDay : function(date, week) {D1 = date;c1.setBetween([date, 99999999]);if (D2 <= D1) {D2 = getNormalDate(getRightDate(date + 3)).replace(/-/g, "");G(in2).value = getS(D2)}}});c1 = A.ui.calendar({input : in2,position : "op_ticket_input2",element : el2,count : 2,today : Today,onShow : fu{%*i*%}nction() {this.setHtml(D2);c0.hide();this.setBetween([getD("op_ticket_time1"), 99999999]);hiDate.call(this)},onChange : function() {hiDate.call(this)},onSelectDay : function(date, week) {D2 = date}});c0.addEvent(c0.G("op_ticket_cbtn1"), "click", function() {c0.show()}, true);c1.addEvent(c0.G("op_ticket_cbtn2"), "click", function() {c1.show()}, true)}A.use('calendar',calUiCallback);var t1 = _this.find(".OP_LOG_BTN")[1], t2 = _this.find(".OP_LOG_BTN")[0];t1.onclick = function() {_this.find(".op_ti{%*i*%}cket_span2")[0].style.display = "block";_this.find(".op_ticket_input")[1].style.display = "block"};t2.onclick = function() {_this.find(".op_ticket_span2")[0].style.display = "none";_this.find(".op_ticket_input")[1].style.display = "none"};timere = setTimeout(function() {t2.setAttribute("checked", "checked");_this.find(".op_ticket_span2")[0].style.display = "none";_this.find(".op_ticket_input")[1].style.display = "none"}, 100);window.op_ticket_url = function(el, s, index) {if (!D1) {return false}{%*i*%}var b1 = op_ticket_getInfo(_this.find(".op_ticket_text")[0].value, "start", true);var b2 = op_ticket_getInfo(_this.find(".op_ticket_text")[1].value, "end", true);if (op_ticket_startcity[0] == "" || op_ticket_endcity[0] == "") {if (b1 && b2) {var url = {elong : "http://www.elong.com/",ctrip : "http://flights.ctrip.com/","17u" : "http://www.17u.cn/FlightQuery.aspx?TCAllianceID=1562159&RefId=1562159&",qunar : "http://flight.qunar.com/",mg : "http://flight.mangocity.com/flights-search-cn.shtml?query{%*i*%}Para.lineType=index&projectcode=0020010"};el.target = "_blank";el.href = url[s];return true}}var info = {t : _this.find(".OP_LOG_BTN")[0].checked ? "0" : "1",a1 : op_ticket_startcity[0],a2 : op_ticket_endcity[0],s1 : op_ticket_startcity[2],s2 : op_ticket_endcity[2],d1 : D1.toString().replace(/^(\d+)(\d\d)(\d\d)\b/, function(a, b, c, d) {return [b, c, d].join("-")}),d2 : D2.toString().replace(/^(\d+)(\d\d)(\d\d)\b/, function(a, b, c, d) {return [b, c, d].join("-")})};var url = {elong : ["http://w{%*i*%}ww.elong.com/redirect/redirect.aspx?f=300072&u=" + encodeURIComponent("http://www.elong.com/flights/TSearch.aspx?g=result&FLY_TYPE=0&DEPART_CITY=" + info.s1 + "&DEST_CITY=" + info.s2 + "&FLY_DATE=" + info.d1 + "&FLY_TIME=&isnative=1"), "http://www.elong.com/redirect/redirect.aspx?f=300072&u=" + encodeURIComponent("http://www.elong.com/flights/TSearch.aspx?&g=result&FLY_TYPE=1&FCY=1&DEPART_CITY=" + info.s1 + "&DEST_CITY=" + info.s2 + "&FLY_DATE=" + info.d1 + "&FLY_TIME=&+isnative=1&RETURN_DATE=" {%*i*%}+ info.d2 + "&RETURN_TIME=")],ctrip : ["http://flights.ctrip.com/Domestic/ShowFareFirst.aspx?HomeCity=" + info.s1 + "&DestCity1=" + info.s2 + "&DDatePeriod1=" + info.d1 + "&sourcepage=openbaidu", "http://flights.ctrip.com/Domestic/ShowFareFirst.aspx?HomeCity=" + info.s1 + "&DestCity1=" + info.s2 + "&DDatePeriod1=" + info.d1 + "&ADatePeriod1=" + info.d2 + "&FlightWay=D&sourcepage=openbaidu"],"17u" : ["http://www.17u.cn/flight/FlightBaiDuALaDing.aspx?DepartCity=" + encodeURIComponent(info.a1) + "&{%*i*%}DestCity=" + encodeURIComponent(info.a2) + "&Date=" + info.d1 + "&ReturnFlag=0", "http://www.17u.cn/flight/FlightBaiDuALaDing.aspx?DepartCity=" + encodeURIComponent(info.a1) + "&DestCity=" + encodeURIComponent(info.a2) + "&Date=" + info.d1 + "&ReturnDate=" + info.d2 + "&ReturnFlag=1"],qunar : ["http://www.qunar.com/twell/flight/Search.jsp?fromCity=" + encodeURIComponent(info.a1) + "&toCity=" + encodeURIComponent(info.a2) + "&fromDate=" + info.d1 + "&toDate=&searchType=OnewayFlight&charset=utf8&e{%*i*%}x_track=bd_aladding", "http://www.qunar.com/twell/flight/Search.jsp?fromCity=" + encodeURIComponent(info.a1) + "&toCity=" + encodeURIComponent(info.a2) + "&fromDate=" + info.d1 + "&toDate=" + info.d2 + "&searchType=RoundtripFlight&charset=utf8&ex_track=bd_aladding"],mg : ["http://flight.mangocity.com/flights-search-cn.shtml?queryPara.lineType=ow&queryPara.depCityCn=" + encodeURIComponent(info.a1) + "&queryPara.arrCityCn=" + encodeURIComponent(info.a2) + "&queryPara.depDate=" + info.d1 + "&projec{%*i*%}tcode=0020010", "http://flight.mangocity.com/flights-search-cn.shtml?queryPara.lineType=rt&queryPara.depCityCn=" + encodeURIComponent(info.a1) + "&queryPara.arrCityCn=" + encodeURIComponent(info.a2) + "&queryPara.depDate=" + info.d1 + "&queryPara.arrDate=" + info.d2 + "&projectcode=0020010"]};el.target = "_blank";el.href = url[s][info.t]};var startinput = _this.find(".op_ticket_text")[0];var endinput = _this.find(".op_ticket_text")[1];window.op_ticket_data = cityList.split(",");for (var i = 0; i{%*i*%} < op_ticket_data.length; i++) {op_ticket_data[i] = op_ticket_data[i].split("|")}window.op_ticket_startcity = ["", "", ""];function op_ticket_getInfo(query, tag, ifbtn) {var flag = false;if (tag == "start") {op_ticket_startcity[0] = "";op_ticket_startcity[1] = "";op_ticket_startcity[2] = ""} else {if (tag == "end") {op_ticket_endcity[0] = "";op_ticket_endcity[1] = "";op_ticket_endcity[2] = ""}}for (var i = 0; i < op_ticket_data.length; i++) {if (op_ticket_data[i][0] == query && tag == "start") {{%*i*%}op_ticket_startcity[0] = op_ticket_data[i][0];op_ticket_startcity[1] = op_ticket_data[i][1];op_ticket_startcity[2] = op_ticket_data[i][2];flag = true;continue} else {if (op_ticket_data[i][0] == query && tag == "end") {op_ticket_endcity[0] = op_ticket_data[i][0];op_ticket_endcity[1] = op_ticket_data[i][1];op_ticket_endcity[2] = op_ticket_data[i][2];flag = true}}}return true}function op_ticket_checkresult(arr) {if (arr.length == 0) {list.push("<div class='c-default op_ticket_error'>对不起，不支持该目的地。</d{%*i*%}iv>");citys.push("")}}function op_ticket_suggstdata(query) {if (query == "") {return []}var result = op_ticket_getInfo(query);var list = [];for (var i = 0; i < op_ticket_data.length; i++) {var r = new RegExp("^" + query + "");if (r.test(op_ticket_data[i][0]) || r.test(op_ticket_data[i][1])) {var str = (op_ticket_data[i][0] + "(" + op_ticket_data[i][1] + ")").replace(query, '<span style="color:#f00;">' + query + "</span>");list.push(str);op_ticket_citys.push(op_ticket_data[i][0])}if (list.length {%*i*%}>= 20) {break}}return list}var sug1 = {getData : function(word) {var list = [];op_ticket_citys = [];var _this = this;var result = op_ticket_suggstdata(word);if (result.length == 0) {list.push("<div class='c-default op_ticket_error'>对不起，不支持该目的地。</div>");op_ticket_citys.push("")} else {list = op_ticket_suggstdata(word)}_this.show(word, list);_this.highLight(0)},onbeforepick : function(evt) {if (!isNaN(evt.data.index)) {evt.data.item.value = op_ticket_citys[evt.data.index]}}};function sugInit(){sug{%*i*%}1.view=function(){var s=_this.find('.op_ticket_pos_start').get(0),p=$(s).position();return {top:p.top+26,left:p.left,width:s.offsetWidth};};op_ticket_sg1 = A.ui.suggestion(sug1);sug1.view=function(){var s=_this.find('.op_ticket_pos_end').get(0),p=$(s).position();return {top:p.top+26,left:p.left,width:s.offsetWidth};};op_ticket_sg = A.ui.suggestion(sug1);$(function() {timert = setTimeout(function() {op_ticket_sg1.render(startinput);op_ticket_sg.render(endinput)}, 100)});}$(function(){A.use('sugge{%*i*%}stion',sugInit);});};sug_canlender();this.dispose = function(){window.op_ticket_startcity = null;window.op_ticket_endcity = null;window.op_ticket_url = function(){};clearTimeout(timere);clearTimeout(timert);bapp&&bapp.dispose&&bapp.dispose();op_ticket_sg&&op_ticket_sg.dispose&&op_ticket_sg.dispose();op_ticket_sg1&&op_ticket_sg1.dispose&&op_ticket_sg1.dispose();}; });</script>{%/block%}