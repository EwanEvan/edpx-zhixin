{%extends 'c_base.tpl'%} {%block name="data_modifier"%}{%$extData.feData.hasBorder = true%}{%$extData.feData.hasShowURLGap = true%}{%/block%}{%block name='content'%}<style data-merge>{%fe_fn_c_css css='input'%}{%fe_fn_c_css css='btn'%}.op-traintimetable05-table .op-traintimetable05-swap{padding-left:5px;padding-right:5px}.op-traintimetable05-table td{padding-bottom:10px}.op-traintimetable05-thead{width:50px;padding-right:10px;white-space:nowrap}.op-traintimetable05-table .op-traintimetable05-btnbox{padding-bottom:0}.op-traintimetable05-submitbtn{display:inline-block;width:104px;height:26px;background:url(http://www.baidu.com/aladdin/img/traintimetable05/bg.png) no-repeat;color:#fff;line-height:26px;_line-height:28px;_overflow{%*i*%}:hidden;font-size:1.077em;padding-left:10px;text-decoration:none;font-weight:bold}.op-traintimetable05-submitbtn:hover{background-position:0 -40px;box-shadow:1px 1px 1px rgba(0,0,0,0.4);-webkit-box-shadow:1px 1px 1px rgba(0,0,0,0.4);-moz-box-shadow:1px 1px 1px rgba(0,0,0,0.4);-o-box-shadow:1px 1px 1px rgba(0,0,0,0.4)}.op-traintimetable05-submitbtn:active{background-position:0 -80px}.op-traintimetable05-red{color:#f00}</style><style>{%if $extData.feData.platform === 'ipad'%}.op-traintimetable05-calendarbox table.opui-calendar-cal .opui-calendar-mon{width:14em}.op-traintimetable05-calendarbox table.opui-calendar-cal .opui-calendar-mon th{font-size:1.07em}.op-traintimetable05-calendarbox table.opui-calendar-cal .opui-calendar-mon h5{font-size:1.23em;height:1.25em;line-height:1.25em;background:url();background-color:#e3e9f7}.op-traintimetable05-calendarbox table.opui-calendar-cal td{font-size:1.07em;height:1.8em;-webkit-tap-highlight-color:#aaa}{%/if%}</style><form action="{%$tplData.submitUrl%}" class="op-traintimetable05-form" method="GET" target="_blank" accept-charset="{%$tplData.acceptCharset|escape:'html'%}"><table class="op-traintimetable05-table"> <tr> <td class="op-traintimetable05-thead">出发城市</td> <td> <span class="c-input c-input-small c-gap-right-small op-traintimetable05-startcity"> <i class="c-icon c-icon-map"></i> <input type="text" value="" name="{%$tplData.city1name|escape:'html'%}" id="op-traintimetable05-startinput" tip="城市名" maxlength="100" autocomplete="off" /> </span><a hidefocus="true" class="c-btn c-gap-right-small op-traintimetable05-swap OP_LOG_BTN" title="起止城市互换" href="javascript:;"><i class="c-icon c-icon-exchange"></i></a><span class="c-input c-input-small c-gap-right-small op-traintimetable05-endcity"> <i class="c-icon c-icon-map"></i> <input type="text" value="" name="{%$tplData.city2name|escape:'html'%}" name="s2" id="op-traintimetable05-endinput" tip="城市名" maxlength="100" autocomplete="off" /> </span> </td> </tr> <tr> <td>出发日期</td> <td> <span class="c-input c-input-small op-traintimetable05-calendarcon"> <i class="c-icon c-icon-calendar"></i> <input type="text" value="" name="{%$tplData.calendarname|escape:'html'%}" class="op-traintimetable05-calendar" maxlength="100" autocomplete="off" readonly="readonly" /> </span> </td> </tr> <tr> <td></td> <td class="op-traintimetable05-btnbox"><a href="javascript:;" class="op-traintimetable05-submitbtn OP_LOG_BTN" >一键抢票</a></td> </tr></table></form><div class="op-traintimetable05-calendarbox"></div><script >
    A.setup( {
        'today': '{%time()|date_format:'%Y-%m-%d'%}',
        'selectDay': '{%$tplData.selectDay|escape%}'
    });
</script><script data-merge>A.setup(function(){var _this = this,tctimer1,calendar,today = _this.data.today,selectDay = _this.data.selectDay || today,week = _this.data.week,form = _this.find( '.op-traintimetable05-form' ),inputs = _this.find( 'input' );A.use("jquery", function(){var $ = window.jQuery;var ajaxFinished = false;var swapping = function() {return false;};var sugCity = 'http://opendata.baidu.com/ala_sug/ala_sug.php?ie=utf-8&sug_type=station&cb=op_func';var citys = [], start, end;var su{%*i*%}g = {getData: function(word) {if (swapping()) {return;}var t = this;var fn = function(data) {if(ajaxFinished) return;var SD = [];if (data.status == 0) {var datas = data.data;var len = datas.length;if (len > 0) {$.each(datas, function( i, v ) {SD.push(v.s);});}else {SD.push('dataerror');}fnSuccess(SD);}};$.ajax( sugCity, {data: {query: word,t: new Date().getTime()},dataType: 'jsonp',jsonp: 'cb',success: function(data){fn(data);}});function fnSuccess(sd) {var FD = [];citys = [];if (sd[0] == 'datae{%*i*%}rror') {if (word == '城市名') return false;FD.push('<p class="op-traintimetable05-red">不支持该目的地</p>');citys.push('');}else {$.each(sd, function( i, o) {var da = o.split('|'),w = word.toLowerCase(),w1 = word.toUpperCase();var str = da[0] + '(' + da[1].toLowerCase() + ')',str2 = da[0] + '(' + da[2].toUpperCase() + ')';citys.push(da[0]);if (w && str.indexOf(w) != -1) {FD.push(str.replace(w, "<span class='op-traintimetable05-red'>" + w + '</span>'));}else if (w1 && str2.indexOf(w1) != -1) {FD.push(str2.{%*i*%}replace(w1, "<span class='op-traintimetable05-red'>" + w1 + '</span>'));}});}t.show(word, FD);t.highLight(0);}},onpick: function(ev) {if (isNaN(ev.data.index)) {return;}else {var cs = citys[ev.data.index].split('|');ev.data.item.value = cs[0];}}};$(function(){A.use('suggestion',function(){var view = function( classname ) {var obj = _this.find( '.'+ classname ),pos = $(obj).position();return {top:pos.top+26,left:pos.left,width:obj[0].offsetWidth};};sug.view=function(){return view( 'op-traintimeta{%*i*%}ble05-startcity' );};start = A.ui.suggestion(sug);sug.view=function(){return view( 'op-traintimetable05-endcity' );};end = A.ui.suggestion(sug);tctimer1 = setTimeout(function() {start.render('op-traintimetable05-startinput');end.render('op-traintimetable05-endinput');},0);});A.use( 'calendar', function() {var calendarInput = _this.find('.op-traintimetable05-calendar')[0],isFirst = true,defaultDay = selectDay.split( '-' ),defaultDate = new Date( defaultDay[0], defaultDay[1] - 1, defaultDay[2] );c{%*i*%}alendarInput.value = selectDay + '(周' + '日一二三四五六'.charAt( defaultDate.getDay() ) + ')';today = today.split('-').join('');calendar = A.ui.calendar({input: calendarInput,position: _this.find('.op-traintimetable05-calendarcon')[0],element: _this.find('.op-traintimetable05-calendarbox')[0],count: 2,date: today,today: today,between: [today, 99999999],onShow: function(){if ( isFirst ) {this.setDay( defaultDay.join('') );isFirst = false;}}});$( 'i', calendarInput.parentNode ).click(function(e) {e.stopP{%*i*%}ropagation();calendar.show();});});_this.find('.op-traintimetable05-swap').click(function() {var value = inputs[0].value;swapping = (function() {var count = 0;return function() {count++;if (count >= 2) {swapping = function() {return false;}}return true;}})();inputs[0].value = inputs[1].value;inputs[1].value = value;});$.each( inputs, function( i, obj ) {var tip = obj.getAttribute( 'tip' ),$input = $( obj );if ( tip && tip.length ) {$input.focus(function() {if ( $.trim( this.value ) == tip ) {$in{%*i*%}put.val('');$input.css( 'color', '#000' );}});$input.blur(function() {if ( $.trim( this.value ) == '' ) {$input.val( tip );$input.css( 'color', '#666' );}});$input.blur();}});_this.find( '.op-traintimetable05-submitbtn' ).click(function() {var calendarVal = inputs[2].value;inputs[2].value = inputs[2].value.replace( /\(.+\)/g, '' );form.submit();inputs[2].value = calendarVal;});});_this.dispose = function() {ajaxFinished = true;clearTimeout( tctimer1 );start && start.dispose && start.dispose();en{%*i*%}d && end.dispose && end.dispose();calendar && calendar.dispose && calendar.dispose();}});});</script>{%/block%}