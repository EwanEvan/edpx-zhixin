{%extends 'c_base.tpl'%} {%block name='title'%}{%/block%}{%block name='foot'%}{%/block%}{%block name='data_modifier'%} {%function op_viewpoints_mulit_getTabsColor key=''%}{%strip%} {%if $key == 'can'%}#58b858 {%elseif $key == 'cant'%}#f54545 {%elseif $key == 'may'%}#ffba1a {%else%}#ccc {%/if%} {%/strip%}{%/function%}{%/block%}{%block name='content'%}<style>{%fe_fn_c_css css='img'%}{%fe_fn_c_css css='tabs'%}.op_viewpoints_mulit_main a,.op_viewpoints_mulit_ext a{text-decoration:none}.op_viewpoints_mulit_main a:hover,.op_viewpoints_mulit_ext a:hover{text-decoration:underline}.op_viewpoints_mulit_sep{color:#ccc;margin:0 8px}.op_viewpoints_mulit_title,.op_viewpoints_mulit_title a{color:#666;font-size:1.07em;font-weight:bold}.op_viewpoints_mulit_title span{color:#999;font-weight:normal}.op_viewpoints_mulit_tabs .c-tabs-nav-li{width:72px}.op_viewpoints_mulit_tabs .c-tabs-nav-li p{text-align:center}.op_vi{%*i*%}ewpoints_mulit_tabs .c-tabs-nav-sep{height:89px}.op_viewpoints_mulit_tabs_rate{font-size:1.07em;margin-top:-38px}.op_viewpoints_mulit_tabs_content{font-size:1.07em;font-weight:bold;margin-top:23px}.op_viewpoints_mulit_tabs_ring{width:56px;height:56px;margin-left:auto;margin-right:auto;display:block}.op_viewpoints_mulit_ext_title{color:#666;font-weight:bold}.op_viewpoints_mulit_ext{margin-bottom:-4px}.op_viewpoints_mulit_answer{position:relative;border-top:1px solid #edeff0;padding-top:5px;margin{%*i*%}-left:15px}.op_viewpoints_mulit_answer_first{border-top:0 none;margin-top:-5px}.op_viewpoints_mulit_answer_icon{position:absolute;top:10px;left:-17px;vertical-align:baseline}.op_viewpoints_mulit_answer_title{font-size:1.23em}.op_viewpoints_mulit_answer_title a{text-decoration:underline}.op_viewpoints_mulit_answer_showall{display:inline-block;white-space:nowrap}.op_viewpoints_mulit_answer_info,.op_viewpoints_mulit_answer_info a{color:#999}.op_viewpoints_mulit_more_answer{text-align:center;border-{%*i*%}top:1px solid #e8e9eb}.op_viewpoints_mulit_more_answer_btn,.op_viewpoints_mulit_hide_answer_btn{color:#00C;display:block;cursor:pointer}.op_viewpoints_mulit_more_answer_btn:hover,.op_viewpoints_mulit_hide_answer_btn:hover{text-decoration:underline}</style><div class="c-border"> <div class="op_viewpoints_mulit_main c-row"> <p class="op_viewpoints_mulit_title c-gap-bottom-small">{%$tplData.title|limitlen:60|escape:'html'%}{%if $tplData.answerSum%}<span>（{%$tplData.answerSum%}条网友回答）</span>{%/if%}：</p> <div class="c-tabs"> <ul class="c-tabs-nav op_viewpoints_mulit_tabs"> {%foreach $tplData.view as $view%} {%if !$view@first%}<li class="c-tabs-nav-sep"></li>{%/if%} <li class="c-tabs-nav-li OP_LOG_BTN {%if $view@first%}c-tabs-nav-selected{%/if%}" key="{%$view.key|escape:'html'%}" num="{%$view.answerValue|escape:'html'%}"> <canvas class="op_viewpoints_mulit_tabs_ring c-gap-top" width="56px" height="56px" rate="{%$view.rate|escape:'html'%}" color="{%op_viewpoints_mulit_getTabsColor key=$view.key%}"></canvas> <p class="op_viewpoints_mulit_tabs_rate">{%$view.rate|limitlen:5|escape:'html'|cat:'%'%}</p> <p class="op_viewpoints_mulit_tabs_content">{%$view.content|limitlen:10|escape:'html'%}</p> </li> {%/foreach%} </ul> {%foreach $tplData.view as $view%} <div class="c-tabs-content op_viewpoints_mulit_ext_title c-gap-top" {%if !$view@first%}style="display:none;"{%/if%}>认为“<em>{%$view.content|limitlen:10|escape:'html'%}</em>”的网友回答：</div> {%/foreach%} </div> </div> {%if $tplData.answer%}  <div class="op_viewpoints_mulit_ext c-gap-top-small"> <div class="op_viewpoints_mulit_ext_body"> {%foreach array_slice($tplData.answer, 0, 2) as $item%} {%$answerLimitlen = ($item.content|string_display_len > 226) ? 200 : 226%} <div class="op_viewpoints_mulit_answer c-gap-bottom-small {%if $item@first%}op_viewpoints_mulit_answer_first{%/if%}"> <i class="c-icon c-icon-circle-blue-s op_viewpoints_mulit_answer_icon"></i> <p class="op_viewpoints_mulit_answer_title"><a href="{%$item.originalurl%}" target="_blank">{%$item.original|limitlen:50|highlight:0%}_{%$item.source|escape:'html'%}</a></p> <p class="op_viewpoints_mulit_answer_content"><span class="c-gap-right-small">{%$item.content|limitlen:$answerLimitlen|escape:'html'%}</span>{%if $item.content|string_display_len > $answerLimitlen%}<a href="javascript:;" class="op_viewpoints_mulit_answer_showall OP_LOG_BTN" data-click="{fm:'beha'}" content="{%$item.content|escape:'html'%}">显示全部<i class="c-icon c-icon-triangle-down-blue"></i></a>{%/if%}</p> <p class="op_viewpoints_mulit_answer_info">{%if $item.source && $item.sourceurl%}来自<a href="{%$item.sourceurl|escape:'html'%}" target="_blank">{%$item.source|escape:'html'%}</a>{%/if%}{%if $item.date%}<span class="op_viewpoints_mulit_sep">|</span>{%$item.date|escape:'html'%}{%/if%}</p> </div> {%/foreach%} </div> {%if $tplData.view[0].answerValue > 2%} <div class="op_viewpoints_mulit_more_answer c-gap-top-small"> <p class="op_viewpoints_mulit_more_answer_btn c-gap-top-small OP_LOG_BTN" data-click="{fm:'beha'}">展开更多<i class="c-icon c-icon-triangle-down"></i></p> </div> {%/if%} </div> {%/if%}</div><script type="text/javascript" >
    A.setup({
        OriginQuery: "{%str_replace($extData.resourceid|cat:'_', '', $extData.fetchkey)|escape:'html'|escape:'javascript'%}"
    });
</script><script data-merge>A.setup(function(){var Ala = this,ajaxFinished = false,tabs;var srcid = Ala.srcid, originQuery = encodeURIComponent(Ala.data.OriginQuery), answerNum = $('.c-tabs-nav-selected', Ala.find('.op_viewpoints_mulit_tabs')).attr('num'), answerNum = Math.min(answerNum, 22), viewKey = $('.c-tabs-nav-selected', Ala.find('.op_viewpoints_mulit_tabs')).attr('key'), apn = 2, arn = 5, showType = 1; var $dom_moreAnswer = Ala.find('.op_viewpoints_mulit_more_answer'),$dom_tabs = Ala.fin{%*i*%}d('.c-tabs-nav-li'), $dom_ringCanvas = Ala.find('.op_viewpoints_mulit_tabs_ring'); if ($dom_ringCanvas.length) {var myDraw = {circle : function(obj, color, ox, oy, r, sRad, eRad, cPath){ cxt = obj.getContext('2d');cxt.beginPath();cxt.arc(ox, oy, r, Math.PI*sRad, Math.PI*eRad, cPath);cxt.lineTo(ox, oy);cxt.closePath();cxt.fillStyle = color;cxt.fill();},ring : function(obj, color, ox, oy, ro, ri, sRad, eRad, cPath){var BGC = "#FFF";myDraw.circle(obj, color, ox, oy, ro, sRad, eRad, cPath);myDraw.ci{%*i*%}rcle(obj, BGC, ox, oy, ri, 0, 2, cPath);}};$dom_ringCanvas.each(function(i, item) {var $item = $(item),rate = $item.attr('rate'), color = $item.attr('color'), eRad = 0.02 * rate + 1.5; myDraw.ring(item, '#d9d9d9', 28, 28, 27, 22, 0, 2, false); myDraw.ring(item, color, 28, 28, 28, 21, 1.5, eRad, false); });};A.use('tabs5', function(){tabs = A.ui.tabs5(Ala.find('.c-tabs')[0], {onChange: function(){var $dom_thisTab = $dom_tabs.eq(this.current);viewKey = $dom_thisTab.attr('key');answerNum = Math.min{%*i*%}($dom_thisTab.attr('num'), 22);showType = 0; asyncGetData(0, 2, viewKey);}});});bindShowallEvent();initMoreAnswerBtn();function bindShowallEvent(){Ala.find('.op_viewpoints_mulit_answer_showall').on('click', function(){$(this).parent().html($(this).attr('content'));});}function initMoreAnswerBtn(){if (answerNum <= 2) {$dom_moreAnswer.css({'display':'none'});} else {$dom_moreAnswer.html('<p class="op_viewpoints_mulit_more_answer_btn c-gap-top-small OP_LOG_BTN" data-click="{fm:\'beha\'}">展开更多<i cla{%*i*%}ss="c-icon c-icon-triangle-down"></i></p>').css({'display':'block'});apn = 2; Ala.find('.op_viewpoints_mulit_more_answer_btn').on('click', function(){showType = 1; asyncGetData(apn, arn, viewKey);});};}function asyncGetData(pn, rn, key){var url = 'http://opendata.baidu.com/api.php?resource_id=' + srcid + '&format=json&ie=utf-8&oe=utf-8&query=' + originQuery + '&apn=' + pn + '&arn=' + rn + '&co=answer[key=' + key + ']&limit=answer.*.original:46&hilight=answer.*.original';$.ajax({dataType : 'jsonp{%*i*%}',scriptCharset : 'utf-8',jsonp : 'cb',timeout : 6000,url : url,success : initData});}function initData(data){ if (ajaxFinished) return;if (data.status == '0' && data.data[0].answer) { var dispData = data.data[0].answer,dispHtml = [];for (var i = 0; i < dispData.length; i++) {var answerLimitlen = ($.getByteLength(dispData[i].content) > 226) ? 200 : 226;dispHtml = dispHtml.concat(['<div class="op_viewpoints_mulit_answer c-gap-bottom-small' + (showType == 0 && i == 0 ? ' op_viewpoints_mulit_answer{%*i*%}_first' : '') + '">','<i class="c-icon c-icon-circle-blue-s op_viewpoints_mulit_answer_icon"></i>','<p class="op_viewpoints_mulit_answer_title">','<a href="' + dispData[i].originalurl + '" target="_blank">' + dispData[i].original + '_' + dispData[i].source + '</a>','</p>','<p class="op_viewpoints_mulit_answer_content">','<span class="c-gap-right-small">' + $.subByte(dispData[i].content, answerLimitlen) + '</span>',$.getByteLength(dispData[i].content) > answerLimitlen ? '<a href="javascript:;" cl{%*i*%}ass="op_viewpoints_mulit_answer_showall OP_LOG_BTN" data-click="{fm:\'beha\'}" content="' + dispData[i].content + '">显示全部<i class="c-icon c-icon-triangle-down-blue"></i></a>' : '','</p>','<p class="op_viewpoints_mulit_answer_info">',(dispData[i].sourceurl && dispData[i].source) ? '来自<a href="' + dispData[i].sourceurl + '" target="_blank">' + dispData[i].source + '</a>' : '',dispData[i].date ? '<span class="op_viewpoints_mulit_sep">|</span>' + dispData[i].date : '','</p>','</div>']);};showData(di{%*i*%}spHtml.join(''));}}function showData(data){ var $dom_dataArea = Ala.find('.op_viewpoints_mulit_ext_body');if (showType == 0) {$dom_dataArea.html(data);initMoreAnswerBtn(); } else if (showType == 1) {$dom_dataArea.append(data);apn += arn; };bindShowallEvent(); if (answerNum <= apn) { var containerID = $(Ala.container).attr('id');$dom_moreAnswer.html('<a href="#' + containerID + '" class="op_viewpoints_mulit_hide_answer_btn c-gap-top-small OP_LOG_BTN" data-click="{fm:\'beha\'}">收起<i class="c-icon {%*i*%}c-icon-triangle-up"></i></a>');Ala.find('.op_viewpoints_mulit_hide_answer_btn').on('click', function(){$('.op_viewpoints_mulit_answer:gt(1)', $dom_dataArea).remove();initMoreAnswerBtn();});};}this.dispose = function(){if(!ajaxFinished){ajaxFinished = true;};tabs&&tabs.dispose&&tabs.dispose();};});</script>{%/block%}