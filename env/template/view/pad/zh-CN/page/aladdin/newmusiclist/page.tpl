{%extends 'c_base.tpl'%} {%block name='data_modifier'%}{%$extData.feData.hasBorder = true%} {%$escaped_query = implode('',$tplData.QueryTags)|cat:'歌曲'%} {%$escaped_query = $extData.OriginQuery%} {%$headtitlesuffix = "&nbsp;在线试听正版歌曲免费下载_百度音乐"%} {%$tplData.title = $escaped_query|cat:$headtitlefix|cat:$headtitlesuffix%} {%$tagText = "style"%} {%$tagSlected = $tplData.queryparser[0].tags%}{%$tagNames = $tplData.result[0].tag_list%} {%foreach $tagNames as $item%} {%if $tagSlected != "流行" && $tagSlected%} {%$tagText = "tag"%} {%break%} {%elseif $tagSlected == null%} {%$tagSlected = "流行"%} {%/if%} {%/foreach%} {%$tplData.url = "http://music.baidu.com/$tagText/$tagSlected"%} {%if !$tplData.showurl%} {%$tplData.showurl = 'music.baidu.com/'%} {%/if%} {%/block%}{%block name='content'%} <style type="text/css" data-merge>{%fe_fn_c_css css='table'%}{%fe_fn_c_css css='btn'%}.op_newmusiclist_list_playbutton{padding-left:8px;padding-right:10px}.op_newmusiclist_list .op_newmusiclist_list_more,.op_newmusiclist_list .op_newmusiclist_list_more em{font-family:simsun}.op_newmusiclist_list_new{position:relative;top:-4px}.op_newmusiclist_list_index{margin:0 2px;color:#666}.op_muslist_list_first,.op_muslist_list_second{display:block;float:left}.op_muslist_list_first{color:#999;padding:2px 0;height:12px;line-height:12px;font-size:.92em}.op_muslist_list_second{width:472px;heigh{%*i*%}t:53px;overflow:hidden}.op_muslist_list_second a{display:inline-block;height:12px;padding:2px 5px;text-align:center;vertical-align:text-bottom;font-size:.92em;line-height:12px;font-style:normal;overflow:hidden}.op_muslist_list_second .c-text{color:#00c}.op_muslist_list_second .c-text-public{color:#fff}.op_newmusiclist_list_switch{width:100%;text-align:center}.op_newmusiclist_list_switch a{text-decoration:none;display:inline-block;width:19px;border:1px solid #e2e2e2}.op_newmusiclist_list_switch a{%*i*%}.op_newmusiclist_list_active{text-decoration:none;display:inline-block;width:19px;color:#000;font-weight:bold;border:0}.op_newmusiclist_list_switch a.op_newmusiclist_list_pagemore{width:auto;border:0;text-decoration:underline}</style>{%*根据query搜索自动选中tag处理*%}{%$tempDataTagSelectedIndex=0%}{%foreach $tplData.result[0].tag_list as $item%} {%if $tplData.queryparser[0].tags == $item.name%} {%$tempDataTagSelectedIndex = $item@index%} {%/if%}{%/foreach%}<div class="c-row op_trickimage_container"> <span class="c-gap-right op_muslist_list_first">类别:</span> <span class="op_muslist_list_second c-gap-left-small"> {%foreach $tplData.result[0].tag_list as $item%} <a href="#" onclick="return false;" class="c-text c-text-mult c-gap-right-small c-gap-bottom{%if $item@index == $tempDataTagSelectedIndex%} c-text-public{%/if%}">{%$item.name%}</a> {%/foreach%} </span> </div> <div class="op_newmusiclist_list"> <div class="op_newmusiclist_list"> <table class="c-table op_newmusiclist_list_table"> <thead> <tr> <th><input class="op_newmusiclist_list_checkall OP_LOG_BTN" type="checkbox" checked=true/></th> <th>全选</th> <th colspan="2"> <a class="c-btn op_newmusiclist_list_playbutton" href="javascript:;"><i class="c-icon c-icon-play-blue c-gap-icon-right-small"></i>播放选中歌曲</a> </th> <th>播放</th> <th>歌词</th> <th>下载</th> </tr> </thead> <tbody class="op_newmusicl{%*i*%}ist_list_tbody"> {%foreach $tplData.result as $item%} {%if $item@index > 24 %}{%break%}{%/if%} <tr class="op-zx-musalbum-list-song"{%if $item@index > 4%} style="display:none;"{%/if%}> <td width="20"><input class="op_newmusiclist_list_checkbox OP_LOG_BTN" songid="{%$item.id%}" type="checkbox" checked=true/></td> <td width="30"><span class="op_newmusiclist_list_index">{%if $item@index < 9 %}0{%/if%}{%$item@index+1%}</span></td> <td width="200"><div class="op_newmusiclist_list_name"> <a href="{%$item.loc|cat:'?fm=altg8'%}"  target="_blank" title="{%$item.name%}"> {%$item.name|limitlen:18%} </a> {%if $item.isnew == '1'%} <span class="c-text c-text-danger op_newmusiclist_list_list-new">新</span> {%/if%} </div></td> <td width="160"> {%$singers = explode(',',$item.singer)%} {%$singerurlprefix = 'http://music.baidu.com/'%} {%$singerids = explode(',',$item.singerid)%} {%if !$singers[0]%}--{%/if%} {%foreach $singers as $ls%} {%if $singerids[$ls@index]%} {%$singerurl = $singerurlprefix|cat:'artist/'|cat:$singerids[$ls@index]|cat:'?fm=altg8'%} {%elseif $ls%} {%$singerurl = $singerurlprefix|cat:'search?key='|cat:$ls|cat:'&fm=altg8'%} {%/if%} {%if $ls@index > 2%}{%break%}{%/if%} {%if $ls@index > 0%}/ {%/if%} {%if $ls%} {%if $singerurl%} <a title="{%$ls%}" target="_blank" href="{%$singerurl%}" class="op-zx-mussong-singer">{%$ls|limitlen:8|escape%}</a> {%else%} <span title="{%$ls%}">{%$ls|limitlen:10|escape%}</span> {%/if%} {%/if%} {%/foreach%} </td> <td width="50"><a href="javascript:;" class="c-icon c-icon-play-circle op_newmusiclist_list_play" songid="{%$item.id%}" title="播放">&nbsp;</a></td> {%$lrcurl = "http://music.baidu.com/song/"|cat:$item.id|cat:"?fm=altg8#song_lyric"%} <td width="50"><a href="{%$lrcurl%}" target="_blank" class="c-icon c-icon-lyric op_newmusiclist_list_lrc" title="歌词">&nbsp;</a></td> {%$downloadurl = "http://music.baidu.com/song/"|cat:$item.id|cat:"/download?fm=altg8"%} <td width="50"><a href="{%$downloadurl%}" target="_blank" class="c-icon c-icon-download op_newmusiclist_list_down" title="下载">&nbsp;</a></td> </tr> {%/foreach%} </tbody> </table> <div class="op_newmusiclist_list_switch"> {%$number = 1%} {%foreach $tplData.result as $item%} {%if $item@index > 24%}{%break%}{%/if%} {%if ($item@index+1) % 5 == 0%} <a href="javascript:;" class="c-gap-right-small c-gap-left-small c-gap-top op_newmusiclist_list_page">{%$number++%}</a> {%/if%} {%/foreach%} <a href="http://music.baidu.com/" target="_blank" class="op_newmusiclist_list_pagemore c-gap-left-small">更多</a> </div> </div></div><script >
	A.setup({
		hotsongs:'{%$tplData.hotsongs%}',
		srcid:'{%$extData.resourceid%}'
    });
</script> <script data-merge>A.setup(function(){var _this = this;var singleBox;var hotsongs = _this.data.hotsongs;var pagemorelink = _this.find('.op_newmusiclist_list_pagemore')[0];var href = pagemorelink.href;var seconds = _this.find('.op_muslist_list_second')[0],cont = _this.find('.op_trickimage_container')[0], aA = cont.getElementsByTagName('a'); var trs = _this.find('.op_newmusiclist_list_tbody:first tr');var oA = _this.find('.op_newmusiclist_list_page');function subByte(str, len, tail){ var{%*i*%} a = [], s = str.split('');tail = tail || '…'; for(var i = 0, l = s.length; i < l; i++){if(s[i].charCodeAt(0) > 255){a.push("*");}a.push(s[i]);}if(len && len > 0 && a.length > len){ s = a.join("").substring(0, len - 1).replace(/\*/g,'') + tail;}else{return str;}return s;};A.use('mboxsingleton',function(){singleBox = new A.ui.mboxsingleton();var dom_checkall = _this.find('.op_newmusiclist_list_checkall')[0],dom_checkboxs = _this.find('.op_newmusiclist_list_checkbox'),dom_listplay = _this.find('.o{%*i*%}p_newmusiclist_list_play'),dom_playbutton = _this.find('.op_newmusiclist_list_playbutton')[0];var checkedbox = dom_checkboxs.length;function start(){dom_checkboxs = _this.find('.op_newmusiclist_list_checkbox');dom_listplay = _this.find('.op_newmusiclist_list_play');$.each(dom_listplay,function(i,item){$(item).on('click',function(){singleBox.openBox('mbc.ps',$(item).attr('songid'),{fr : 'altg8'});});}); $.each(dom_checkboxs,function(i,item){$(item).on('click',function(){if(item.checked){checkedbo{%*i*%}x++;}else{checkedbox--;}if(checkedbox == dom_checkboxs.length){dom_checkall.checked = true;}else{dom_checkall.checked = false;}if(checkedbox == 0){$(dom_playbutton).addClass('op_newmusiclist_list_disabled');}else{$(dom_playbutton).removeClass('op_newmusiclist_list_disabled');}});});};$(dom_checkall).on('click',function(){dom_checkboxs = _this.find('.op_newmusiclist_list_checkbox');$.each(dom_checkboxs,function(i,item){item.checked = dom_checkall.checked;if(dom_checkall.checked){checkedbox = dom_{%*i*%}checkboxs.length;$(dom_playbutton).removeClass('op_newmusiclist_list_disabled');}else{checkedbox = 0;$(dom_playbutton).addClass('op_newmusiclist_list_disabled');}});});dom_playbutton && $(dom_playbutton).on('click',function(){dom_checkboxs = _this.find('.op_newmusiclist_list_checkbox');if(!$(dom_playbutton).hasClass('op_newmusiclist_list_disabled')){var checkedsongs = '';$.each(dom_checkboxs,function(i,item){if(item.checked){checkedsongs = checkedsongs + $(item).attr('songid') + '_';};});singleB{%*i*%}ox.openBox('mbc.ps',checkedsongs,{fr : 'altg8'});}});start();function switchTable(page){var maxLen = page * 5, minLen = (page - 1) * 5;for(var j = 0, item; item = trs[j]; j++){if( j >= minLen && j < maxLen ){item.style.display = ''; }else{item.style.display = 'none';}} };oA[0].className = 'c-gap-right-small c-gap-left-small c-gap-top op_newmusiclist_list_active';for(var i=0;i<oA.length;i++){(function(index){$(oA[i]).on('click', function(){for(var i=0;i<oA.length;i++){oA[i].className = 'c-gap-rig{%*i*%}ht-small c-gap-left-small c-gap-top'; }this.className = 'c-gap-right-small c-gap-left-small c-gap-top op_newmusiclist_list_active';switchTable(index);}); })(i+1);}function pagemore(pagemore){$(pagemore).on('click', function(){var selectA = _this.find('.c-text-public')[0];if(selectA.innerHTML != '流行'){pagemore.href = href + 'tag/' + selectA.innerHTML; }else{pagemore.href = href + 'style/' + selectA.innerHTML; }});};pagemore(pagemorelink);for(var i=0;i<aA.length;i++){$(aA[i]).on('click', function({%*i*%}){pagemore(pagemorelink);var children=this.parentNode.children;for(var i=0;i<children.length;i++){children[i].className='c-text c-text-mult c-gap-right-small c-gap-bottom';}this.className='c-text c-text-mult c-gap-right-small c-gap-bottom c-text-public';var children=this.parentNode.children;for(var i=0;i<children.length;i++){children[i].className='c-text c-text-mult c-gap-right-small c-gap-bottom';}this.className='c-text c-text-mult c-gap-right-small c-gap-bottom c-text-public';var song = '的歌'; {%*i*%}var url='http://opendata.baidu.com/api.php?resource_id='+ _this.data.srcid +'&query='+ encodeURIComponent(this.innerHTML) + encodeURIComponent(song) +'&ie=utf-8&oe=utf-8&format=json&t='+(+new Date());$.ajax({url:url+'&cb=newmu',dataType:'jsonp',success:function(data){ for(var i=0;i<oA.length;i++){oA[i].className = 'c-gap-right-small c-gap-left-small c-gap-top';}oA[0].className = 'c-gap-right-small c-gap-left-small c-gap-top op_newmusiclist_list_active';dom_checkall = _this.find('.op_newmusiclist{%*i*%}_list_checkall')[0];dom_checkall.checked = true;var aTr = _this.find('.op_newmusiclist_list_tbody:first tr');if(data.data[0]){if(data.data[0].result){var data = data.data[0].result;for(var i=0,item; item=aTr[i]; i++){var oTd = item.getElementsByTagName('td'); oTd[0].innerHTML = '<input class="op_newmusiclist_list_checkbox OP_LOG_BTN" songid="'+ data[i].id +'" type="checkbox" checked=true />';oTd[1].innerHTML = '<span class="op_newmusiclist_list_index">'+(i < 9 ? '0' + (i+1) : '' + (i+1))+'</span{%*i*%}>';oTd[2].innerHTML = '<div class="op_newmusiclist_list_name">'+'<a href="'+ data[i].loc +'?fm=altg8"  target="_blank" title="'+ data[i].name +'">' + subByte(data[i].name,18) +'</a>'+(data[i].isnew == "1" ? '<span class="c-text c-text-danger op_newmusiclist_list_new">新</span>' : '')+'</div>';if(data[i].singer.length >= 2){var singers = data[i].singer.split(','); }else{var singers = data[i].singer.split(''); }if(data[i].singerid.length >= 2){var singerids = data[i].singerid.split(',');}else{var s{%*i*%}ingerids = data[i].singerid.split(','); }var singerurlprefix = 'http://music.baidu.com/';!singers[0] ? oTd[3].innerHTML = '--' : '';if(!singers[0]){oTd[3].innerHTML = '--'; }for(var j=0;j<singers.length;j++){if(singerids[j]){var singerurl = singerurlprefix + 'artist/' + singerids[j] +'?fm=altg8';}else if(singers[j]){var singerurl = singerurlprefix + 'search?key=' + singers[j] + '&fm=altg8';}if(j > 2){return;}if(j > 0){'/ ';}if(singers[j]){if(singerurl){oTd[3].innerHTML = '<a title="'+ singers[j]{%*i*%} +'" target="_blank" href="'+ singerurl +'" class="op-zx-mussong-singer">'+ subByte(singers[j],8) +'</a>';}else{oTd[3].innerHTML = '<span title="'+ singers[j] +'">'+ subByte(singers[j],10) +'</span>';}}} oTd[4].innerHTML = '<a href="javascript:;" class="c-icon c-icon-play-circle op_newmusiclist_list_play" songid="'+ data[i].id +'" title="播放">&nbsp;</a>';oTd[5].innerHTML = '<a href="http://music.baidu.com/song/'+ data[i].id +'?fm=altg8#song_lyric" target="_blank" class="c-icon c-icon-lyric op_new{%*i*%}musiclist_list_lrc" title="歌词">&nbsp;</a>';oTd[6].innerHTML = '<a href="http://music.baidu.com/song/'+ data[i].id +'/download?fm=altg8" target="_blank" class="c-icon c-icon-download op_newmusiclist_list_down" title="下载">&nbsp;</a>';switchTable(1);}}}start();},timeout:5000,jsonpCallback:'newmu'}); }); }}); this.dispose = function(){singleBox&&singleBox.dispose&&singleBox.dispose();};});</script> {%/block%}{%block name=foot%} <div {%if $extData.feData.hasBorder || $extData.feData.hasShowURLGap%} class="c-gap-top-small"{%/if%}>{%fe_fn_c_showurl%}<a href="{%$tplData.url%}" target="_blank" class="c-gap-left-small">查看更多</a></div>{%/block%}