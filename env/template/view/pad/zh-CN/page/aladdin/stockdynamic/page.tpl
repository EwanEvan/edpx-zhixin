{%extends 'c_base.tpl'%} {%block name='data_modifier'%}{%/block%}{%block name='content'%}<style data-merge>.op-sotckdynamic{color:#666}.op-stockdynamic-tabs-nav:after{display:block;height:0;content:"";clear:both;visibility:hidden}.op-stockdynamic-tabs-nav{height:27px;border-top:1px solid #d9d9d9;background-color:#fafafa;*zoom:1;margin-top:16px}.op-stockdynamic-tabs-nav li,.op-stockdynamic-tabs-nav a{color:#666}.op-stockdynamic-tabs-nav li{float:left;_display:inline;position:relative;_top:1px;height:25px;line-height:27px;text-align:center;border-style:solid;border-width:0 1px 2px 1px{%*i*%};border-color:transparent;_border-color:#d9d9d9 #fafafa #fafafa;list-style:none;cursor:pointer;white-space:nowrap;overflow:hidden}.op-stockdynamic-tabs-nav a{text-decoration:none}.op-stockdynamic-tabs-nav .op-stockdynamic-tabs-nav-sep{height:16px;width:0;padding:0;margin-top:6px;border-style:solid;border-width:0 1px 0;border-color:transparent #fff transparent #dedede}.op-stockdynamic-tabs-nav .op-stockdynamic-tabs-nav-selected{top:-1px;padding-top:0;border-color:#fff #e4e4e4 #2c99ff #dedede;back{%*i*%}ground-color:#fff;color:#000;cursor:default}.op-stockdynamic-tabs-nav-one .op-stockdynamic-tabs-nav-selected{padding-bottom:0;_top:0;border-color:transparent;_border-color:#d9d9d9 #fafafa #fafafa;background-color:transparent;_background-color:#fafafa;color:#666}.op-stockdynamic-tr{text-align:right}.op-stockdynamic-fl{float:left}.op-stockdynamic-fr{float:right}.op-stockdynamic-nounderline{text-decoration:none}.op-stockdynamic-top,.op-stockdynamic-middle,.op-stockdynamic-bottom{position:relative;z{%*i*%}oom:1}.op-stockdynamic-middle{margin-top:16px}.op-stockdynamic-top{*position:relative;*z-index:2}.op-stockdynamic-top-left{*position:relative;*z-index:2}.op-stockdynamic-cur{height:34px;line-height:34px;*margin-top:0}.op-stockdynamic-cur-num{font-size:32px}.op-stockdynamic-cur-info{font-size:22px;position:relative;top:-2px;margin-right:5px}.op-stockdynamic-cur-status-icon{position:relative;top:-2px;*top:-5px;display:inline-block;width:17px;height:16px;background:url(http://www.baidu.com/aladdin/i{%*i*%}mg/stockdynamic/arrow.png) no-repeat}.op-stockdynamic-cur-status-red-up{background-position:0 0}.op-stockdynamic-cur-status-red-down{background-position:0 -25px}.op-stockdynamic-cur-status-green-up{background-position:0 -51px}.op-stockdynamic-cur-status-green-down{background-position:0 -77px}.op-stockdynamic-cur-tip{position:relative;top:-3px;font-size:14px;color:#666;font-weight:normal;display:inline-block;border:1px solid #d9d9d9;height:22px;line-height:22px;padding:0 4px;text-decoration:none;{%*i*%}zoom:1;cursor:pointer}.op-stockdynamic-cur-tip-text{display:none;position:absolute;width:178px;top:24px;left:0;padding:10px 0 0;background:#fff;z-index:2;cursor:default;font-size:13px}.op-stockdynamic-cur-tip-text-inner{border:1px solid #d9d9d9;padding:10px;display:inline-block;position:relative;-webkit-box-shadow:2px 2px 2px rgba(0,0,0,0.1);-moz-box-shadow:2px 2px 2px rgba(0,0,0,0.1);-o-box-shadow:2px 2px 2px rgba(0,0,0,0.1);box-shadow:2px 2px 2px rgba(0,0,0,0.1)}.op-stockdynamic-cur-tip-text i{%*i*%}{position:absolute;top:-10px;left:20px}.op-stockdynamic-top-right{position:absolute;right:0;bottom:0;font-size:14px}.op-stockdynamic-pan{text-align:right}.op-stockdynamic-pan a{color:#666}.op-stockdynamic-middle-right{position:absolute;right:0;top:0;width:136px;font-size:14px}.op-stockdynamic-content{zoom:1;position:relative;width:300px;font-size:14px;color:#666;height:150px}.op-stockdynamic-map-x{position:absolute;right:0;bottom:0;width:408px;height:20px}.op-stockdynamic-map-y{position:absolute{%*i*%};left:0;top:4px;white-space:nowrap;text-align:left}.op-stockdynamic-map{position:absolute;right:0;top:4px;width:408px;height:126px;z-index:1;cursor:pointer;background:#fff;-webkit-touch-callout:none;-webkit-user-select:none}.op-stockdynamic-map-canvas-mask{position:absolute;top:0;left:0}.op-stockdynamic-map-tip{position:absolute;top:0;background:#fff;min-width:108px;*width:128px;width:128px\9;padding:8px;border:1px solid #e3e3e3;line-height:20px;z-index:1;display:none;-webkit-box-shadow:2px 2px {%*i*%}2px rgba(0,0,0,0.1);-moz-box-shadow:2px 2px 2px rgba(0,0,0,0.1);-o-box-shadow:2px 2px 2px rgba(0,0,0,0.1);box-shadow:2px 2px 2px rgba(0,0,0,0.1)}.op-stockdynamic-map-a{color:#666;text-decoration:none}.op-stockdynamic-map-tip dl{margin:0;padding:0}.op-stockdynamic-map-tip dt{margin:0;padding:0;margin-bottom:5px;color:#666}.op-stockdynamic-map-tip dd{margin:0;padding:0;height:22px;vertical-align:middle;color:#666}.op-stockdynamic-map-tip-name{float:left}.op-stockdynamic-map-tip-value{float:right;d{%*i*%}isplay:inline-block;text-align:right;_vertical-align:baseline;_zoom:1}.op-stockdynamic-map-x-div{display:inline-block}.op-stockdynamic-content i{font-style:normal}.op-stockdynamic-info{margin-top:-4px;margin-top:-2px}.op-stockdynamic-info li{height:30px;vertical-align:middle}.op-stockdynamic-info-name{float:left}.op-stockdynamic-info-value{float:right;display:inline-block;text-align:right;*vertical-align:baseline;*zoom:1;*line-height:14px}.op-stockdynamic-bottom-left{width:460px}.op-stockdynamic{%*i*%}-bottom-right{position:absolute;right:0;top:0;width:136px}.op-stockdynamic-more{*position:relative;*right:-10px}.op-stockdynamic-map-x-char{font-size:14px;*font-size:13px;display:inline-block;-webkit-transform:scale(0.833);-moz-transform:scale(0.833)}.op-stockdynamic-map-tag,.op-stockdynamic-map-y-char{font-size:14px;*font-size:12px;display:inline-block;vertical-align:middle;-webkit-transform:scale(0.917);-webkit-transform-origin:0 0;-moz-transform:scale(0.917);-moz-transform-origin:left center}{%*i*%}.op-stockdynamic-map-tag{position:absolute;top:-18px;background-color:#bdc1c7;padding:0 5px;height:20px;line-height:20px;white-space:nowrap;color:#fff;display:none}</style><!--[if IE]><script>document.createElement('canvas');</script><![endif]-->{%$tempDataColor=''%}{%if $tplData.cur['color']=='#f54545'%} {%$tempDataColor='-red'%}{%elseif $tplData.cur['color']=='#0f990f'%} {%$tempDataColor='-green'%}{%/if%}{%if $tplData.tab && !$tplData.tab[0]%}{%$tplData.tab=[$tplData.tab]%}{%/if%}{%if $tplData.tab[0].p && !$tplData.tab[0].p[0]%}{%$tplData.tab.p=[$tplData.tab.p]%}{%/if%}{%if $tplData.tab[0].cy.o && !$tplData.tab[0].cy.o[0]%}{%$tplData.tab[0].cy.o=[$tplData.tab[0].cy.o]%}{%/if%}{%if $tplData.tabs.tab && !$tplData.tabs.tab[0]%}{%$tplData.tabs.tab=[$tplData.tabs.tab]%}{%/if%}{%*
{%function name="opStockDynamicGetYMaxWidth"%}{%strip%}
{%$tempDataY=''%}
{%foreach $tplData.tab[0].cy[0].o as $item%}
    {%if !tempDataY || strlen($item) > strlen($tempDataY)%}
        {%$tempDataY = $item%}
    {%/if%}
{%/foreach%}
{%strlen($tempDataY)*5%}
{%/strip%}{%/function%}
*%}{%*y轴宽度*%}{%*
{%$tempDataYWidth=(int){%opStockDynamicGetYMaxWidth%}%}
*%}{%$tempDataType=['1'=>'开盘中', '2'=>'已收盘', '3'=>'停牌中', '4'=>'净值未公布', '5'=>'净值已公布', '6'=>'未开盘', '7'=>'休市']%}<div class="op-sotckdynamic"> <div class="op-stockdynamic-top"> <div class="op-stockdynamic-top-left">{%if $tplData.tabs && $tplData.tabs.tab && $tplData.tabs.tab[0] && $tplData.tabs.tab[0].cur%} {%foreach $tplData.tabs.tab as $item%} {%$tempDataCur=$item.cur%} {%$tempDataTip=$item.tip%} {%$tempDataColor=''%} {%if $tempDataCur['color']=='#f54545'%} {%$tempDataColor='-red'%} {%elseif $tempDataCur['color']=='#0f990f'%} {%$tempDataColor='-green'%} {%/if%} <div class="op-stockdynamic-cur op-stockdynamic-cur-{%$item@index%}" style="{%if $tempDataCur['color']%}color:{%$tempDataCur['color']%};{%/if%}{%if !$item@first%}display:none;{%/if%}"> <span class="op-stockdynamic-cur-num c-gap-right-small">{%$tempDataCur['num']|escape%}</span>{%if $tempDataCur['status']=='up' || $tempDataCur['status']=='down'%}<i class="op-stockdynamic-cur-status-icon op-stockdynamic-cur-status{%$tempDataColor%}{%if $tempDataCur['status']=='up'%}-up{%elseif $tempDataCur['status']=='down'%}-down{%else%}{%/if%} c-gap-right-small"></i>{%/if%}{%if $tempDataCur['info']%}<span class="op-stockdynamic-cur-info">{%$tempDataCur['info']|escape%}</span>{%/if%} {%if $tempDataTip%}<span class="op-stockdynamic-cur-tip op-stockdynamic-cur-tip-{%$item@index%}">{%$tempDataTip['label']|escape%}<span class="op-stockdynamic-cur-tip-text"><span class="op-stockdynamic-cur-tip-text-inner"><i class="c-icon c-icon-triangle-up-empty"></i>{%$tempDataTip['text']%}</span></span></span>{%/if%} </div> {%/foreach%} {%else%} <div class="op-stockdynamic-cur"{%if $tplData.cur['color']%} style="color:#666;color:{%$tplData.cur['color']%}"{%/if%}> <span class="op-stockdynamic-cur-num c-gap-right-small">{%$tplData.cur['num']|escape%}</span>{%if $tplData.cur['status']=='up' || $tplData.cur['status']=='down'%}<i class="op-stockdynamic-cur-status-icon op-stockdynamic-cur-status{%$tempDataColor%}{%if $tplData.cur['status']=='up'%}-up{%elseif $tplData.cur['status']=='down'%}-down{%else%}{%/if%} c-gap-right-small"></i>{%/if%}{%if $tplData.cur['info']%}<span class="op-stockdynamic-cur-info">{%$tplData.cur['info']|escape%}</span>{%/if%} {%if $tplData.tip%}<span class="op-stockdynamic-cur-tip">{%$tplData.tip['label']|escape%}<span class="op-stockdynamic-cur-tip-text"><span class="op-stockdynamic-cur-tip-text-inner"><i class="c-icon c-icon-triangle-up-empty"></i>{%$tplData.tip['text']%}</span></span></span>{%/if%} </div> {%/if%} <div class="op-stockdynamic-update"> {%$tplData.update['text']|escape%} <span class="c-gap-left-small"> {%if $tplData.update['type']=='1'%} {%if $tplData.update['time']%} {%strip%} {%$tempDataMinutes=round((time()-$tplData.update['time'])/60)%} {%if $tempDataMinutes<60%} {%$tempDataMinutes%}分钟前更新 {%elseif $tempDataMinutes>=60%} {%$tempDataHours=floor($tempDataMinutes/60)%} {%$tempDataMM=$tempDataMinutes-($tempDataHours*60)%} {%if $tempDataHours<24%} {%$tempDataHours%}小时{%$tempDataMM%}分钟前更新 {%else%} {%$tempDataDay=floor($tempDataHours/24)%} {%$tempDataHH=$tempDataHours-($tempDataDay*24)%} {%$tempDataDay%}天{%$tempDataHH%}小时{%$tempDataMM%}分钟前更新 {%/if%} {%/if%} {%/strip%} {%/if%} {%else%} {%$tempDataType[$tplData.update['type']]%} {%/if%} </span> {%if $tplData.update['timezone']%} <span>{%$tplData.update['timezone']|escape%}</span> {%/if%} </div> </div> <div class="op-stockdynamic-top-right"> {%if $tplData.pan && !$tplData.pan[0]%}{%$tplData.pan=[$tplData.pan]%}{%/if%} <div class="op-stockdynamic-pan"> {%foreach $tplData.pan as $item%} <div>{%if $item['url']%}<a href="{%$item['url']%}" target="_blank">{%/if%}{%$item['name']|escape%}{%if $item['url']%}</a>{%/if%}：{%$item['value']|escape%}</div> {%/foreach%} </div> </div> </div> <div class="op-stockdynamic-middle"> <div class="op-stockdynamic-middle-left"> {%foreach $tplData.tabs.tab as $item%} <div class="op-stockdynamic-content"{%if !$item['selected']%}style="display:none;"{%/if%}> <div class="op-stockdynamic-map-x"></div> <a class="op-stockdynamic-map-a" href="{%$tplData.url%}" target="_blank"><div class="op-stockdynamic-map"> <canvas class="op-stockdynamic-map-canvas" width="406" height="126"></canvas> <canvas class="op-stockdynamic-map-canvas-mask" width="406" height="126"></canvas> <div class="op-stockdynamic-map-tip"></div> <div class="op-stockdynamic-map-tag"></div> </div></a> <div class="op-stockdynamic-map-y"></div> </div> {%/foreach%} <ul class="op-stockdynamic-tabs-nav{%if count($tplData.tabs.tab)==1%} op-stockdynamic-tabs-nav-one{%/if%}"> {%foreach $tplData.tabs.tab as $item%} <li class="op-stockdynamic-tab {%if $item['selected']%}op-stockdynamic-tabs-nav-selected{%/if%} OP_LOG_BTN" data-tabid="{%$item.id%}"{%if $item@index>0%} data-resourceid="{%trim($item['dayupdate'])%}"{%/if%} data-click="{fm: 'beha'}">{%$item['text']|escape%}</li> {%/foreach%} </ul> </div> <div class="op-stockdynamic-middle-right"> <ul class="op-stockdynamic-info"> {%if $tplData.info && !$tplData.info[0]%}{%$tplData.info=[$tplData.info]%}{%/if%} {%foreach $tplData.info as $item%} <li><span class="op-stockdynamic-info-name">{%$item['name']|escape%}</span><span class="op-stockdynamic-info-value"{%if $item['color']%}style="color:{%$item['color']%}"{%/if%}>{%$item['value']|escape%}</span></li> {%/foreach%} </ul> </div> </div> <div class="op-stockdynamic-bottom c-gap-top"> <div class="op-stockdynamic-bottom-left"> {%if $tplData.news && !$tplData.news[0]%}{%$tplData.news=[$tplData.news]%}{%/if%} <ul class="op-stockdynamic-news"> {%foreach $tplData.news as $item%} <li><span>{%$item['tag']|escape%}</span><span class="c-gap-left-small c-gap-right-small"><a href="{%$item['url']%}" target="_blank">{%$item['text']|limitlen:40|escape%}</a></span><span>{%$item['date']|escape%}</span></li> {%/foreach%} </ul> </div> <div class="op-stockdynamic-bottom-right"> {%if isset($tplData.more) && $tplData.more[1]%} {%if $tplData.more|count >= 2%} <ul class="op-stockdynamic-more op-stockdynamic-fr"> <li><a href="{%$tplData.more[0]['url']%}" target="_blank">{%$tplData.more[0]['text']|limitlen:8|escape%}</a></li> <li><a href="{%$tplData.more[1]['url']%}" target="_blank">{%$tplData.more[1]['text']|limitlen:8|escape%}</a></li> </ul> {%if $tplData.more|count >=4%} <ul class="op-stockdynamic-more op-stockdynamic-fr c-gap-right"> <li><a href="{%$tplData.more[2]['url']%}" target="_blank">{%$tplData.more[2]['text']|limitlen:8|escape%}</a></li> <li><a href="{%$tplData.more[3]['url']%}" target="_blank">{%$tplData.more[3]['text']|limitlen:8|escape%}</a></li> </ul> {%/if%} {%/if%} {%/if%} </div> </div></div><script >
    A.setup({
        'code': '{%$tplData.code%}',
        'tab0': {%json_encode($tplData.tab[0])%}
    });
</script><script data-merge>A.setup(function(){var _this = this,canvasable = true,$canvases = _this.find('.op-stockdynamic-map-canvas'),tabnav = _this.find('.op-stockdynamic-tabs-nav')[0], $cur = _this.find('.op-stockdynamic-cur'),$curTip = _this.find('.op-stockdynamic-cur-tip'), tabs = tabnav.getElementsByTagName('li'),$contents = _this.find('.op-stockdynamic-content'),$maps = _this.find('.op-stockdynamic-map'),$masks = _this.find('.op-stockdynamic-map-canvas-mask'),$tips = _this.find('.op-stoc{%*i*%}kdynamic-map-tip'),$tags = _this.find('.op-stockdynamic-map-tag'),$xdoms = _this.find('.op-stockdynamic-map-x'),$ydoms = _this.find('.op-stockdynamic-map-y'),w = 406,h = 126,yMaxNums = 9,yPxWidth = 6,curIndex = 0;var ajaxFinished = false;initTabs();initData(0, _this.data.tab0);tabs[0].loaded = true;function initTabs(){for(var i = 0; i < tabs.length; i++){if($(tabs[i]).hasClass('op-stockdynamic-tab-cur')){curIndex = i;}(function(index){$(tabs[i]).on('click',function(){if(curIndex !== index){ $con{%*i*%}tents.eq(curIndex).css("display","none");$contents.eq(index).css("display","");$(tabs[curIndex]).removeClass('op-stockdynamic-tabs-nav-selected');$(this).addClass('op-stockdynamic-tabs-nav-selected');if($cur.length > 1){($cur.eq(curIndex)[0]) && ($cur.eq(curIndex).css('display', 'none'));($curTip.eq(curIndex)[0]) && ($curTip.eq(curIndex).css('display', 'none'));($cur.eq(curIndex)[0]) && ($cur.eq(curIndex).css('display', 'inline-block'));($curTip.eq(index)[0]) && ($curTip.eq(curIndex).css('displa{%*i*%}y', 'inline-block'));}curIndex = index;}if(!this.loaded){loadData(index, $.trim(this.getAttribute('data-tabid')), $.trim(this.getAttribute('data-resourceid')));this.loaded = true;}});})(i);}}function loadData(index, tabId, resourceid){$.ajax({url:'http://opendata.baidu.com/api.php?resource_id=' + resourceid + '&query=' + encodeURIComponent(_this.data.code) + '&co=tab'+ (tabId == 2 ? '' : ('[id=' + tabId + ']')),dataType:'jsonp',success:function(data){ if(ajaxFinished) return;if(data && data.stat{%*i*%}us === '0' && data.data && data.data[0]){data = tabId == 2 ? data.data[0].tab : data.data[0].tab[0];initData(index, data);}},scriptCharset:'gbk',jsonp:'cb'});}function initData(index, data){var canvas = $canvases.eq(index)[0];var mask = $masks.eq(index)[0];var supportCanvas = !!document.createElement('canvas').getContext;if(!supportCanvas){A.use('canvas', function(){A.ui.canvas.init([canvas, mask]);;initCanvas(index, data);});}else{initCanvas(index, data);}}function initCanvas(index, data){var c{%*i*%}ontent = $contents.eq(index)[0];var map = $maps.eq(index)[0];var canvas = $canvases.eq(index)[0];var mask = $masks.eq(index)[0];var tip = $tips.eq(index)[0];var tag = $tags.eq(index)[0];var xdom = $xdoms.eq(index)[0];var ydom = $ydoms.eq(index)[0];var cx = data.cx.o;var cy = data.cy.o;var maxPoints = data.points;var poptitle = data.poptitle;var pop = data.pop.o;data.p = $.trim(data.p);data.p = data.p.replace(/\;$/, '');var p = data.p.split(';');var shoupan = data.shoupan;var xDistance = w/(maxPo{%*i*%}ints-1);var cyDistance = h/(cy.length-1);var yMax = cy[0];var yMin = cy[cy.length-1];initXY(cx, xdom, cy, ydom, content, index);var ctx = canvas.getContext('2d');ctx.clearRect(0, 0, canvas.width, canvas.height);ctx.beginPath();for(var i = 0; i < cy.length; i++){var yy = Math.round(cyDistance*i)+0.5;yy = yy > h ? h-0.5 : yy;ctx.moveTo(0, yy);ctx.lineTo(w, yy);}ctx.strokeStyle = '#ebebeb';ctx.stroke();ctx.closePath();if(shoupan){var shoupanyy = Math.floor(h*(yMax-(shoupan*1))/(yMax-yMin));ctx.begi{%*i*%}nPath();ctx.moveTo(0, shoupanyy+0.5);ctx.lineTo(w, shoupanyy+0.5);ctx.strokeStyle = '#67bf67';ctx.stroke();ctx.closePath();}ctx.beginPath();var pxMap = [];var temp = '';var pData = [];for(var i = 0, l = p.length; i < l; i++){var pp = p[i].split(',');var x = $.trim(pp[0]||'');var y = $.trim(pp[1]||'');var dt = $.trim(pp[2]||'');if(dt){temp = dt;}else{dt = temp;}var dd = [];dd.push($.trim(pp[3]||''));dd.push($.trim(pp[4]||''));dd.push($.trim(pp[5]||''));pData.push({'x': x,'y': y,'dt': dt,'dd': dd}{%*i*%});}p = pData;for(var i = 0, l = p.length; i < l; i++){var croodY = p[i]['y'];var c = h*(yMax-(croodY*1))/(yMax-yMin);var px = Math.floor(i*xDistance);pxMap.push({p: p[i], x: px});var py = Math.floor(c);var pxx = px + 0.5;var pyy = py + 0.5;px = pxx > w ? px - 0.5 : pxx;py = pyy > h ? py - 0.5 : pyy;if(i==0){ctx.moveTo(px, py);}else{ctx.lineTo(px, py);}}ctx.strokeStyle = '#006aff';ctx.stroke();ctx.closePath();var mskctx = mask.getContext('2d');mskctx.strokeStyle = "#bdc1c7";var curX = null;functi{%*i*%}on touchMoveEventHandle(e){var mapOffset = getOffset(map);var crood = {x: (e.pageX || (e.clientX + document.documentElement.scrollLeft)) - mapOffset.left, y: (e.pageY || (e.clientY + document.documentElement.scrollTop)) - mapOffset.top};var closest = getClosest(crood.x, pxMap);if((curX === null || closest['x'] !== curX) && crood.x >= pxMap[0]['x'] && crood.x <= pxMap[pxMap.length-1]['x']){mskctx.clearRect(0, 0, mask.width, mask.height);mskctx.beginPath();var xx = closest['x'] + 0.5;xx = xx > w ?{%*i*%} closest['x'] - 0.5 : xx;mskctx.moveTo(xx, 0);mskctx.lineTo(xx, h);mskctx.stroke();mskctx.closePath();showTip(closest, tip, tag, pop);curX = closest['x'];}}map.ontouchstart = function(e){touchMoveEventHandle(e); };map.ontouchmove = function(e){touchMoveEventHandle(e); };map.ontouchend = function(e){touchMoveEventHandle(e); };}function showTip(pxMap, tip, tag, pop){if(!pxMap['p']){return;}var point = pxMap['p'];var x = pxMap['x'];if(x <= w/2){tip.style.left = 'auto';tip.style.right = '0px';}else{{%*i*%}tip.style.left = '0px';tip.style.right = 'auto';}var tipHtml = '<dl><dt>' + point['dt'] + '</dt>';var ddHtml = '<dd><span class="op-stockdynamic-map-tip-name">#{k}</span><span class="op-stockdynamic-map-tip-value" style="color:#{c};">#{v}</span></dd>';var k = '', vc, v = '', c = 'auto';if(Object.prototype.toString.call(pop).toLowerCase().slice(8,-1)==='string'){pop=[pop];}for(var i = 0, l = pop.length; i < l; i++){k = pop[i];vc = point['dd'][i];if(vc){vc = vc.split(' ');v = vc[0]||'';c = vc[1]||{%*i*%}'auto';}tipHtml += $.format(ddHtml, {k:k, c:c, v:v});}tipHtml += '</dl>';tip.innerHTML = tipHtml;tip.style.display = 'block';tag.innerHTML = point['x'];tag.style.display = 'block';tag.style.left = x - Math.round(tag.offsetWidth/2) + 'px';}function getClosest(goal, pxMap){var closest = null;for(var i = 0, l = pxMap.length; i < l; i++){if(closest === null || Math.abs(pxMap[i]['x'] - goal) < Math.abs(closest['x'] - goal)){closest = pxMap[i];}}return closest;}function getOffset(e){var x = 0, y = 0;w{%*i*%}hile (e != null) {x += e.offsetLeft;y += e.offsetTop;e = e.offsetParent;}return { left: x, top: y };}function getYMaxWidth(cy){var y = '';for(var i = 0, l = cy.length; i < l; i++){if(!y || cy[i].length > y.length){y = cy[i];}}return y.length*yPxWidth;}function initXY(cx, xDom, cy, yDom, content, index){var cxHtml = '';var cxw = w/(cx.length-1);var cyw = getYMaxWidth(cy);if (!cyw || (cyw+'').length>yMaxNums){cyw = yMaxNums*yPxWidth;}var contentWidth = cyw + w + 2 + 10;content.style.width = conten{%*i*%}tWidth + 'px';tabnav.style.width = contentWidth + 'px';var tabWidth = contentWidth/tabs.length;for(var i = 0, t; t = tabs[i]; i++){t.style.width = tabWidth - 2 + 'px';}if(index === 0){var seps = [];var sep = 0;for(var j = 0; j < cx.length; j++){var ww = 36;if(j < cx.length - 1){var timeStart = cx[j];var timeEnd= cx[j+1];if(timeStart.indexOf('/')!=-1){ww = ww*2;timeStart = timeStart.split('/')[1];}if(timeEnd.indexOf('/')!=-1){timeEnd= timeEnd.split('/')[0];}timeStart = timeStart.split(':');timeEn{%*i*%}d = timeEnd.split(':');var hourStart = parseInt(timeStart[0], 10);var hourEnd = parseInt(timeEnd[0], 10);var minStart = parseInt(timeStart[1], 10);var minEnd = parseInt(timeEnd[1], 10);sep += ((hourEnd - hourStart) * 60) + (minEnd - minStart);}seps.push({o: cx[j], w: ww, sep: sep});}var left = 0;var sepLeft = 0;for(var j = 0, s; o = seps[j]; j++){if(j == 0){left = 0; sepLeft = '0';}else if(j == seps.length - 1){left = w - o.w + 2;sepLeft = 'auto;right:0'}else{left = w*seps[j-1].sep/sep - o.w/2;s{%*i*%}epLeft = '50%';}cxHtml += '<span style="position:absolute;left:'+left+'px;bottom:0;display:block;height:14px;line-height:14px;"><span class="op-stockdynamic-map-x-char">' + o.o + '</span><i style="position:absolute;top:-8px;left:'+sepLeft+';display:inline-block;width:1px;height:4px;overflow:hidden;border:none;border-left:1px solid #ebebeb;">&nbsp;</i></span>';}}else{cxHtml += '<div style="width:'+(cxw*cx.length)+'px;height:14px;line-height:14px;position:absolute;left:-'+(cxw/2)+'px;bottom:0;">';{%*i*%}for(var j = 0; j < cx.length; j++){cxHtml += '<div class="op-stockdynamic-map-x-span" style="position:relative;width:'+cxw+'px;text-align:center;float:left;">';if(j == 0){cxHtml += '<span style="display:inline-block;float:right;text-align:left;width:'+(cxw/2)+'px">'+'<span class="op-stockdynamic-map-x-char">' + cx[j] + '</span>'+'</span>';}else if(j == cx.length - 1){cxHtml += '<span style="display:inline-block;float:left;text-align:right;width:'+(cxw/2)+'px">'+'<span class="op-stockdynamic-map-{%*i*%}x-char">' + cx[j] + '</span>'+'</span>';}else{cxHtml += '<span class="op-stockdynamic-map-x-char">' + cx[j] + '</span>';}cxHtml += '<i style="position:absolute;top:-8px;left:50%;display:inline-block;width:1px;height:4px;overflow:hidden;border:none;border-left:1px solid #ebebeb;">&nbsp;</i>';cxHtml += '</div>';}cxHtml += '</div>';}xDom.innerHTML = cxHtml;var cyh = h/(cy.length-1);var cyHtml = '';cyHtml += '<div style="height:'+(cyh*cy.length)+'px;position:absolute;top:-'+(cyh/2)+'px;width:'+cyw+'{%*i*%}px;">';for(var j = 0; j < cy.length; j++){cyHtml += '<div class="op-stockdynamic-map-y-span" style="position:relative;height:'+cyh+'px;line-height:'+cyh+'px;">';cyHtml += '<span class="op-stockdynamic-map-y-char">' + cy[j] + '</span>';cyHtml += '</div>';}cyHtml += '</div>';yDom.innerHTML = cyHtml;}if($curTip){$curTip.each(function(i,temp){$(temp).on('click',function(e){if(!temp.show){temp.style.borderColor = '#389cff';var text = $(temp).find('op-stockdynamic-cur-tip-text')[0];text && (text.style{%*i*%}.display = 'block');temp.show = true;}else{temp.style.borderColor = '#d9d9d9';var text = $(temp).find('op-stockdynamic-cur-tip-text')[0];text && (text.style.display = 'none');temp.show = false;} });$(temp).on('mouseout',function(e){temp.style.borderColor = '#d9d9d9';var text = $(temp).find('op-stockdynamic-cur-tip-text')[0];text && (text.style.display = 'none'); temp.show = false;});});}this.dispose = function(){if(!ajaxFinished){ajaxFinished = true;}};});</script>{%/block%}