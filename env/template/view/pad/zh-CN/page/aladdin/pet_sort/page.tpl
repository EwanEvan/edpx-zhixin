{%extends 'c_base.tpl'%} {%block name="data_modifier"%}{%$extData.feData.hasBorder=true%}{%$pageNumber = 12%}{%function op_pet_sort_buildurl wd=''%}/s?wd={%$wd|escape:'html'%}&rsv_dl=0_left_pet_sort_{%$extData.resourceid%}{%/function%}{%/block%}{%block name="title"%}{%/block%}{%block name="foot"%}{%/block%}{%block name='content'%}<style data-merge>{%fe_fn_c_css css='tabs'%}.op-pet-sort-title{font-weight:bold}.op-pet-sort-title-desc{font-weight:normal;font-size:.87em;font-size:13px\9}.op-pet-sort-recommand{border-top:1px solid #ebebeb;padding-top:5px}.op-pet-sort-name{display:block;padding:15px 0;position:relative}.op-pet-sort-name span{display:block;position:absolute;width:120%;left:-10%;top:5px;text-align:center}.op-pet-sort-name a{text-decoration:none}.op-pet-sort-name a:hover{text-decoration:underline}.op-pet-sort-pager{padding:5px 0}.op-pet-sort-result{padding{%*i*%}-top:5px}.op-pet-sort-suffix{display:block;position:absolute;top:0;left:0;width:20px;height:27px;color:#fff;font-size:.92em;font-size:12px\9;text-align:center;white-space:nowrap;text-decoration:none}.op-pet-sort-suffix1 .op-pet-sort-suffix-bg{border-color:#f8433f transparent transparent #f8433f}.op-pet-sort-suffix2 .op-pet-sort-suffix-bg{border-color:#ff8138 transparent transparent #ff8138}.op-pet-sort-suffix3 .op-pet-sort-suffix-bg{border-color:#ffad23 transparent transparent #ffad23}.op-pet-so{%*i*%}rt-suffix-bg{position:absolute;top:0;left:0;display:block;width:0;height:0;overflow:hidden;border-width:1.2em;border-width:15px\9;border-style:solid dashed dashed solid;border-color:#39f transparent transparent #39f}.op-pet-sort-suffix-index{position:relative;z-index:1;margin-left:-2px;text-decoration:none}.op-pet-sort-list li{position:relative}.op-pet-sort-list a{text-decoration:none}.op-pet-sort-title{font-size:1.17em;margin:0;padding:0}</style><style>.op-pet-sort-list img{height:{%fe_fn_c_get_img_height border="1"%}px}</style><h4 class="op-pet-sort-title">{%$tplData.title%}{%if $tplData.title_desc%}<span class="op-pet-sort-title-desc c-gray">{%build_search_url_limit_ubburl content=$tplData.title_desc%}</span>{%/if%}</h4>{%if !$tplData.tab[0]%}{%$tplData.tab = [ $tplData.tab ]%}{%/if%}{%if $tplData.tab[1]%}<div class="op-pet-sort-tabcon c-gap-top"> <ul class="c-tabs-nav op-pet-sort-tab"{%if $tplData.tab|@count == 1%} style="display:none"{%/if%}> {%foreach $tplData.tab as $item%} {%if $item.title%} {%if !$item@first%}<li class="c-tabs-nav-sep" style="visibility:hidden"></li>{%/if%} <li class="c-tabs-nav-li OP_LOG_BTN{%if $item@first%} c-tabs-nav-selected{%/if%}" data-click="{'fm':'beha'}" data-index="{%$item@index%}">{%$item.title|escape:'html'%}</li> {%/if%} {%/foreach%} </ul> {%foreach $tplData.tab as $item%} <div class="c-tabs-content" style="display:none"></div> {%/foreach%}</div>{%/if%}<div class="op-pet-sort-result c-row"> <ul class="op-pet-sort-list"> {%foreach array_slice($tplData.tab[0].pet, 0, $pageNumber) as $ls%} <li class="c-span6 c-gap-top-small{%if ($ls@index + 1) % 4 == 0%} c-span-last{%/if%}"> <a href="{%op_pet_sort_buildurl wd=$ls.word%}" title="{%$ls.name|escape:'html'%}" target="_blank"><img class="c-img c-img6" src="{%$ls.img%}" /><span class="op-pet-sort-suffix op-pet-sort-suffix{%($ls@index + 1)|escape:'html'%}"><span class="op-pet-sort-suffix-index">{%($ls@index + 1)|escape:'html'%}</span><span class="op-pet-sort-suffix-bg"></span></span></a> <span class="op-pet-sort-name"><span><a href="{%op_pet_sort_buildurl wd=$ls.word%}" title="{%$ls.name|escape:'html'%}" target="_blank">{%$ls.name|limitlen:20|escape:'html'%}</a></span></span> </li> {%/foreach%} </ul></div><div class="op-pet-sort-pager"></div>{%if $tplData.recommand_title && $tplData.recommand_link%}<div class="op-pet-sort-recommand c-gap-top-small"> <span class="c-gray">{%$tplData.recommand_title|escape:'html'%}</span> {%foreach $tplData.recommand_link as $item%} <a href="{%$item.url%}" class="c-gap-right-small" target="_blank">{%$item.name|escape:'html'%}</a> {%/foreach%}</div>{%/if%}<script >
    A.setup({
        srcid: '{%$extData.resourceid%}',
        query: '{%str_replace($extData.resourceid|cat:'_','',$extData.fetchkey)%}',
        length: '{%count($tplData.tab[0].pet)%}',
        pageNumber: '{%$pageNumber|escape:'javascript'%}'
    });
</script><script data-merge>A.setup(function(){var _this = this,this_data = _this.data,length = this_data.length,pageNumber = this_data.pageNumber,query = this_data.query,srcid = this_data.srcid,$tabCon = $( '.op-pet-sort-tabcon' ),$pager = $( '.op-pet-sort-pager' ),$con = $( '.op-pet-sort-result' ),$doc = $( document ),$listBox = $( '.op-pet-sort-list' ),pager,renderPager,index = 0,tab,renderData,buildUrl,data,getData;renderPager = function() {var top = $con.offset().top;pager && pager.dispose {%*i*%}&& pager.dispose();if ( length <= pageNumber ) {$pager.hide();return;};$pager.show();A.use('page', function(){pager = A.ui.page( $pager.get( 0 ), 1, Math.ceil( length / pageNumber ), {onChange: function( curPage, endPage ){if ( $doc.scrollTop() > top ) {$doc.scrollTop( top );}getData( curPage - 1, renderData );}});});};buildUrl = function( word ) {return '/s?wd=' + word + '&rsv_dl=0_left_pet_sort_' + srcid;};renderData = function( list, page ) {$listBox.html( $.map( list, function( v, i ) {retur{%*i*%}n $.format( '<li class="c-span6 c-gap-top-small #{last}">\<a href="#{url}" title="#{title}" target="_blank"><img class="c-img c-img6" src="#{img}" /><span class="op-pet-sort-suffix op-pet-sort-suffix#{suffix}"><span class="op-pet-sort-suffix-index">#{suffix}</span><span class="op-pet-sort-suffix-bg"></span></span></a>\<span class="op-pet-sort-name"><span><a href="#{url}" title="#{title}" target="_blank">#{name}</a></span></span>\</li>', {last: ( i + 1 ) % 4 == 0 ? 'c-span-last' : '',url: buildUr{%*i*%}l( v.word ),img: v.img,name: $.subByte( v.name, 20 ),title: v.name,suffix: ( page * pageNumber + i + 1 )});}).join('') );};getData = function( curPage, callback ) {var get = function() {length = data.tab[ index ][ 'pet' ].length;callback && callback( data.tab[ index ][ 'pet' ].slice( curPage * pageNumber, ( curPage + 1 ) * pageNumber ), curPage );};if ( !data ) {_this.ajax( query, srcid, {success: function( d ) {if ( data ) {return;}data = d[0];if ( !data.tab[ 0 ] ) {data.tab = [ data.tab ];}get{%*i*%}();},error: function() {}});} else {get();}};if ( $tabCon.size() ) {A.use('tabs5', function(){var tabChange;tabChange = function( i ) {index = i;getData( 0, function( data ) {renderPager();renderData( data, 0 );});};tab = A.ui.tabs5( $tabCon.get(0), { onChange: tabChange });});}renderPager();this.dispose = function() {pager && pager.dispose && pager.dispose();tab && tab.dispose && tab.dispose();};});</script>{%/block%}