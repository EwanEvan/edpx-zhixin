{%* AS结果的时间显示逻辑 *%}{%function name=display_as_time%}{%* 计算lastModifyTime *%}{%$lastModifyTime = (strlen($timeShow) > 0) ? $timeShow : $lastModified%}{%* 计算时间差的因子是否存在 *%}{%if $FactorTimePrecision >= 0 && $FactorTime >=0 && $LastModTime >= 0 && $LinkFoundTime >=0 %}{%* 计算时间差的因子是否合法 *%}{%if $FactorTimePrecision == 2 || (($serverTime - $FactorTime) / 3600) > 24 || (($serverTime - $LastModTime) / 3600) > 48 || (($serverTime - $LinkFoundTime) / 3600) > 24%}{%$lastModifyTime%}{%else%}{%$second = ($FactorTimePrecision==1) ? $LinkFoundTime : $FactorTime%}{%* 显示时间差逻辑 *%}{%* 计算时间差 *%}{%$timeDiff=$serverTime-$second%}{%$timeDiffMin=$timeDiff/60%}{%$timeDiffHour=$timeDiff/3600%}{%$timeDiffDay=$timeDiff/86400%}{%if $timeDiffMin < 60%}{%if $timeDiff < 0%}{%$lastModifyTime%}{%else%}{%($timeDiffMin <= 1) ? "1" : $timeDiffMin|string_format:'%d' %}分钟前{%/if%}{%else%}{%($timeDiffHour < 24) ? "`$timeDiffHour|string_format:'%d'`小时前" : $lastModifyTime%}{%/if%}{%* /显示时间差逻辑 *%}{%/if%}{%else%}{%$lastModifyTime%}{%/if%}{%/function%}{%function name=display_time%}{%$timeDiff=$serverTime-$second%}{%$timeDiffMin=$timeDiff/60%}{%$timeDiffHour=$timeDiff/3600%}{%$timeDiffDay=$timeDiff/86400%}{%if $timeDiff > 0%}{%if $timeDiffMin < 60%}{%($timeDiffMin <= 1) ? "1" : $timeDiffMin|string_format:'%d' %}分钟{%else%}{%($timeDiffHour < 24) ? "`$timeDiffHour|string_format:'%d'`小时" : "`$timeDiffDay|string_format:'%d'`天"%}{%/if%}前{%/if%}{%/function%}{%function name=make_url%}{%(strlen($eurl)>0 && strlen($eurl)<$urlEncMaxLen)?"`$urlEncryption_jump``$eurl`":"`$ourl`"%}{%/function%}{%function name=get_url%}{%if $urlEncryption && $encryptionUrl%}{%if $token && $resToken[$token]%}{%$urlTokenMd5Str = "`$originUrl``$serverTime`"%}{%$urlTokenMd5 = md5($urlTokenMd5Str)%}{%$urlToken = "`$urlTokenMd5`&`$serverTime`"|encryptUrl:3:$productEncKey%}{%if strlen($urlToken)>0 && strlen($urlToken)<$urlEncMaxLen%}{%$originUrl = "`$originUrl`&__bd_tkn__=`$urlToken`"%}{%/if%}{%make_url eurl=$originUrl|encryptUrl ourl=$originUrl%}{%else%}{%make_url eurl=$encryptionUrl ourl=$originUrl%}{%/if%}{%else%}{%$originUrl%}{%/if%}{%/function%}{%function name=get_mu%}{%if $urlEncryption && $encryptionUrl%}{%make_url eurl=$encryptionUrl ourl=$originUrl%}{%else%}{%$originUrl%}{%/if%}{%/function%}{%function name=enc_url%}{%if $urlEncryption%}{%if $token && $resToken[$token]%}{%$urlTokenMd5Str = "`$url``$serverTime`"%}{%$urlTokenMd5 = md5($urlTokenMd5Str)%}{%$urlToken = "`$urlTokenMd5`&`$serverTime`"|encryptUrl:3:$productEncKey%}{%if strlen($urlToken)>0 && strlen($urlToken)<$urlEncMaxLen%}{%$url = "`$url`&__bd_tkn__=`$urlToken`"%}{%/if%}{%/if%}{%make_url eurl=$url|encryptUrl ourl=$url%}{%else%}{%$url%}{%/if%}{%/function%}{%function name=enc_str%}{%if $urlEncryption%}{%$str|encryptUrl:3%}{%else%}{%$str%}{%/if%}{%/function%}{%function name=pdc_mark%}{%if $PDC%}<script>if(typeof PDC != 'undefined'){PDC.mark("c_{%$tag|escape:'javascript'%}");}</script>{%/if%}{%/function%}{%* 循环结果，用于上侧结果、右侧结果 *%}{%function name=loop_results%}{%if $theResult && $theResult.item%}<div id="con-{%$id%}">{%foreach $theResult.item as $res%}{%if $res.dispData.resultData.extData%}{%$res.dispData.resultData.extData.feData=[
                'rsv_stl' => $res.dispData.StdStl,
				'cssUI'=>$cssUI
            ]%}{%/if%}{%$useSmarty = $res.dispData.strategy%}{%$aladdinHTML = ''%}{%if $useSmarty%}{%$aladdinHTML = $res.dispData|common_render:"{%if $res.dispData.strategy.type%}{%$res.dispData.strategy.type%}{%else%}aladdin{%/if%}":$res.dispData.strategy.tempName:$res@index%}{%/if%}{%if $test%}<small>render by smarty :{%$res.dispData.strategy.tempName%}| SrcId:{%$res.dispData.SrcId%}</small><p>{%/if%}{%if $aladdinHTML != ''%}<div class="result-op xpath-log" data-click="{fm:'{%$fm%}',p1:'{%$res@index + 1%}'{%if $res.dispData.SrcId%},rsv_srcid:'{%$res.dispData.SrcId%}'{%/if%},mu:'{%trim($res.itemUrl)%}',rsv_stl:'{%$res.dispData.StdStl%}'}">{%$aladdinHTML%}</div>{%/if%}{%/foreach%}</div>{%/if%}{%/function%}{%*栅格化按需加载css函数*%}{%function fe_fn_ui_c_css_write css='' ext=''%}{%if !isset($cssState[$css][$ext])%}{%$cssUI[$css][$ext]%}{%$cssState[$css][$ext]=1%}{%/if%}{%/function%}{%function fe_fn_ui_c_css css='' ext=''%}{%if $css%}{%fe_fn_ui_c_css_write css=$css ext='common'%}{%if $ext%}{%if is_array($ext)%}{%foreach $ext as $item%}{%fe_fn_ui_c_css_write css=$css ext=$item%}{%/foreach%}{%else%}{%fe_fn_ui_c_css_write css=$css ext=$ext%}{%/if%}{%/if%}{%/if%}{%/function%}