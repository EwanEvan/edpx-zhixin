/***************************************************************************
*
* Copyright (C) 2014 Baidu.com, Inc. All Rights Reserved
*
***************************************************************************/

/**
 * @file wise-word-decode.js ~ 2014-05-28 13:07
 * @author mengke01 (kekee000@gmail.com)
 * @description
 *  对wise的word参数进行解码
 */

//IX参数hash表
var ixHash = {"1":"186","2":"58","3":"107","4":"113","5":"2","6":"200","7":"49","8":"49","9":"55","10":"57","11":"186","12":"154","13":"224","14":"183","15":"155","16":"153","17":"177","18":"158","19":"12","20":"56","21":"96","22":"209","23":"104","24":"157","25":"142","26":"210","27":"199","28":"190","29":"122","30":"88","31":"51","32":"74","33":"12","34":"21","35":"244","36":"148","37":"178","38":"71","39":"239","40":"157","41":"211","42":"136","43":"107","44":"215","45":"151","46":"30","47":"97","48":"71","49":"106","50":"19","51":"53","52":"85","53":"106","54":"36","55":"28","56":"103","57":"229","58":"161","59":"207","60":"86","61":"192","62":"137","63":"29","64":"12","65":"75","66":"71","67":"65","68":"104","69":"65","70":"173","71":"206","72":"150","73":"108","74":"85","75":"87","76":"95","77":"88","78":"0","79":"91","80":"236","81":"25","82":"143","83":"68","84":"218","85":"40","86":"48","87":"193","88":"41","89":"123","90":"157","91":"159","92":"19","93":"251","94":"19","95":"142","96":"234","97":"96","98":"237","99":"227","100":"208","101":"218","102":"89","103":"32","104":"235","105":"89","106":"41","107":"136","108":"28","109":"187","110":"145","111":"28","112":"138","113":"222","114":"3","115":"148","116":"35","117":"227","118":"55","119":"252","120":"219","121":"138","122":"71","123":"93","124":"75","125":"207","126":"140","127":"244","128":"60","129":"230","130":"149","131":"96","132":"158","133":"170","134":"35","135":"17","136":"80","137":"155","138":"56","139":"139","140":"83","141":"12","142":"173","143":"79","144":"179","145":"123","146":"26","147":"228","148":"185","149":"160","150":"60","151":"19","152":"240","153":"230","154":"3","155":"253","156":"11","157":"53","158":"156","159":"89","160":"99","161":"236","162":"129","163":"222","164":"253","165":"153","166":"35","167":"246","168":"135","169":"15","170":"240","171":"135","172":"203","173":"9","174":"0","175":"39","176":"170","177":"147","178":"81","179":"157","180":"124","181":"248","182":"127","183":"57","184":"8","185":"70","186":"190","187":"17","188":"220","189":"255","190":"215","191":"10","192":"54","193":"88","194":"168","195":"150","196":"34","197":"230","198":"208","199":"245","200":"5","201":"73","202":"27","203":"91","204":"141","205":"122","206":"187","207":"120","208":"203","209":"47","210":"102","211":"112","212":"19","213":"2","214":"10","215":"164","216":"86","217":"202","218":"237","219":"211","220":"55","221":"149","222":"197","223":"50","224":"174","225":"87","226":"80","227":"232","228":"244","229":"57","230":"200","231":"35","232":"82","233":"240","234":"227","235":"12","236":"188","237":"91","238":"210","239":"142","240":"134","241":"109","242":"28","243":"19","244":"129","245":"57","246":"223","247":"248","248":"67","249":"229","250":"107","251":"51","252":"203","253":"106","254":"45","255":"223","256":"59","257":"191","258":"95","259":"174","260":"28","261":"148","262":"34","263":"150","264":"224","265":"107","266":"9","267":"1","268":"61","269":"51","270":"36","271":"67","272":"112","273":"182","274":"60","275":"74","276":"169","277":"129","278":"107","279":"46","280":"87","281":"173","282":"130","283":"53","284":"91","285":"206","286":"113","287":"231","288":"220","289":"240","290":"153","291":"139","292":"143","293":"134","294":"219","295":"29","296":"242","297":"245","298":"42","299":"250","300":"117","301":"34","302":"210","303":"23","304":"84","305":"20","306":"13","307":"153","308":"74","309":"45","310":"153","311":"167","312":"243","313":"195","314":"219","315":"223","316":"214","317":"155","318":"60","319":"2","320":"224","321":"204","322":"120","323":"107","324":"162","325":"40","326":"155","327":"155","328":"72","329":"95","330":"55","331":"247","332":"48","333":"170","334":"67","335":"6","336":"241","337":"187","338":"29","339":"151","340":"100","341":"106","342":"3","343":"221","344":"189","345":"65","346":"65","347":"197","348":"249","349":"183","350":"134","351":"96","352":"24","353":"115","354":"190","355":"49","356":"67","357":"69","358":"164","359":"243","360":"8","361":"141","362":"63","363":"85","364":"170","365":"181","366":"59","367":"213","368":"80","369":"237","370":"210","371":"79","372":"64","373":"51","374":"28","375":"176","376":"136","377":"194","378":"30","379":"98","380":"103","381":"16","382":"163","383":"13","384":"206","385":"191","386":"90","387":"67","388":"9","389":"184","390":"24","391":"105","392":"17","393":"25","394":"73","395":"92","396":"109","397":"108","398":"29","399":"197","400":"34","401":"111","402":"187","403":"152","404":"185","405":"151","406":"170","407":"121","408":"8","409":"4","410":"145","411":"8","412":"2","413":"91","414":"72","415":"23","416":"254","417":"1","418":"92","419":"111","420":"221","421":"56","422":"87","423":"211","424":"136","425":"163","426":"201","427":"226","428":"89","429":"47","430":"18","431":"150","432":"154","433":"236","434":"134","435":"174","436":"46","437":"237","438":"37","439":"245","440":"41","441":"81","442":"64","443":"235","444":"156","445":"86","446":"77","447":"87","448":"201","449":"210","450":"104","451":"26","452":"118","453":"56","454":"152","455":"67","456":"201","457":"13","458":"69","459":"244","460":"92","461":"71","462":"71","463":"151","464":"227","465":"165","466":"133","467":"166","468":"120","469":"224","470":"234","471":"19","472":"252","473":"51","474":"76","475":"19","476":"52","477":"114","478":"150","479":"157","480":"132","481":"122","482":"157","483":"43","484":"235","485":"20","486":"121","487":"225","488":"175","489":"98","490":"153","491":"34","492":"247","493":"242","494":"165","495":"157","496":"50","497":"156","498":"239","499":"200","500":"136","501":"74","502":"87","503":"68","504":"249","505":"224","506":"200","507":"15","508":"192","509":"180","510":"223","511":"60","512":"6","513":"119","514":"16","515":"204","516":"27","517":"247","518":"45","519":"131","520":"231","521":"212","522":"19","523":"81","524":"30","525":"216","526":"183","527":"119","528":"57","529":"212","530":"85","531":"13","532":"26","533":"15","534":"76","535":"230","536":"138","537":"232","538":"156","539":"242","540":"57","541":"97","542":"225","543":"179","544":"85","545":"3","546":"99","547":"149","548":"118","549":"226","550":"49","551":"253","552":"108","553":"183","554":"155","555":"225","556":"4","557":"234","558":"191","559":"155","560":"198","561":"220","562":"31","563":"48","564":"222","565":"109","566":"157","567":"110","568":"80","569":"136","570":"222","571":"137","572":"130","573":"178","574":"129","575":"222","576":"11","577":"254","578":"2","579":"155","580":"136","581":"222","582":"193","583":"60","584":"108","585":"179","586":"157","587":"244","588":"173","589":"148","590":"188","591":"32","592":"51","593":"109","594":"112","595":"1","596":"83","597":"223","598":"165","599":"161","600":"160","601":"100","602":"145","603":"243","604":"102","605":"26","606":"169","607":"56","608":"253","609":"180","610":"45","611":"230","612":"235","613":"70","614":"130","615":"166","616":"4","617":"157","618":"209","619":"198","620":"119","621":"116","622":"221","623":"241","624":"108","625":"155","626":"76","627":"117","628":"182","629":"139","630":"17","631":"186","632":"10","633":"138","634":"162","635":"138","636":"177","637":"65","638":"109","639":"29","640":"145","641":"94","642":"103","643":"60","644":"244","645":"202","646":"213","647":"34","648":"203","649":"135","650":"120","651":"65","652":"100","653":"22","654":"197","655":"26","656":"241","657":"64","658":"114","659":"199","660":"140","661":"80","662":"107","663":"243","664":"9","665":"117","666":"23","667":"207","668":"179","669":"231","670":"83","671":"61","672":"250","673":"39","674":"70","675":"189","676":"183","677":"211","678":"122","679":"56","680":"17","681":"34","682":"236","683":"169","684":"221","685":"21","686":"111","687":"250","688":"101","689":"233","690":"187","691":"208","692":"91","693":"79","694":"213","695":"97","696":"239","697":"245","698":"123","699":"162","700":"25","701":"153","702":"144","703":"167","704":"34","705":"16","706":"241","707":"41","708":"32","709":"183","710":"249","711":"18","712":"212","713":"83","714":"155","715":"3","716":"202","717":"147","718":"100","719":"210","720":"211","721":"205","722":"66","723":"43","724":"8","725":"161","726":"61","727":"141","728":"115","729":"65","730":"90","731":"104","732":"31","733":"164","734":"232","735":"39","736":"104","737":"146","738":"155","739":"172","740":"3","741":"152","742":"108","743":"189","744":"53","745":"19","746":"129","747":"65","748":"229","749":"212","750":"62","751":"83","752":"177","753":"160","754":"17","755":"26","756":"183","757":"253","758":"71","759":"199","760":"148","761":"113","762":"172","763":"150","764":"14","765":"238","766":"74","767":"208","768":"216","769":"211","770":"78","771":"61","772":"71","773":"198","774":"140","775":"229","776":"192","777":"231","778":"238","779":"115","780":"206","781":"57","782":"161","783":"232","784":"97","785":"3","786":"197","787":"233","788":"82","789":"243","790":"65","791":"101","792":"10","793":"246","794":"114","795":"225","796":"157","797":"127","798":"61","799":"4","800":"166","801":"186","802":"240","803":"89","804":"89","805":"229","806":"58","807":"199","808":"236","809":"64","810":"116","811":"96","812":"89","813":"223","814":"60","815":"171","816":"4","817":"25","818":"74","819":"145","820":"5","821":"112","822":"148","823":"229","824":"88","825":"219","826":"32","827":"176","828":"207","829":"101","830":"182","831":"71","832":"40","833":"176","834":"150","835":"28","836":"242","837":"134","838":"99","839":"243","840":"254","841":"71","842":"251","843":"202","844":"240","845":"87","846":"237","847":"37","848":"33","849":"86","850":"141","851":"193","852":"87","853":"239","854":"107","855":"201","856":"77","857":"94","858":"138","859":"219","860":"61","861":"33","862":"95","863":"157","864":"89","865":"56","866":"230","867":"103","868":"230","869":"166","870":"207","871":"55","872":"160","873":"131","874":"238","875":"191","876":"208","877":"229","878":"179","879":"76","880":"14","881":"156","882":"67","883":"49","884":"244","885":"174","886":"211","887":"163","888":"23","889":"132","890":"69","891":"194","892":"44","893":"108","894":"24","895":"227","896":"231","897":"195","898":"241","899":"242","900":"77","901":"76","902":"167","903":"35","904":"128","905":"85","906":"227","907":"80","908":"0","909":"98","910":"85","911":"173","912":"122","913":"99","914":"30","915":"207","916":"201","917":"146","918":"132","919":"146","920":"236","921":"251","922":"218","923":"166","924":"188","925":"27","926":"181","927":"175","928":"78","929":"132","930":"9","931":"0","932":"95","933":"199","934":"165","935":"9","936":"48","937":"228","938":"120","939":"11","940":"84","941":"210","942":"195","943":"168","944":"72","945":"223","946":"152","947":"125","948":"54","949":"123","950":"156","951":"98","952":"214","953":"143","954":"189","955":"153","956":"165","957":"126","958":"158","959":"212","960":"1","961":"17","962":"62","963":"136","964":"96","965":"22","966":"183","967":"157","968":"235","969":"33","970":"231","971":"140","972":"157","973":"55","974":"157","975":"30","976":"110","977":"197","978":"193","979":"171","980":"43","981":"78","982":"33","983":"18","984":"8","985":"127","986":"179","987":"174","988":"79","989":"117","990":"253","991":"194","992":"203","993":"198","994":"246","995":"143","996":"228","997":"147","998":"158","999":"115"};


/**
 * 解码word加密串
 * 
 * @param {string} s 加密串
 * @param {number} p 密钥
 * @return {string} 解密串
 */
function decode(s, p) {
    p = 1024 - p;
    s = s.replace(/%(.{2})/gi, function($0, $1) {
        var t = parseInt($1, 16);
        t = ((t + p) % 256) + 256;
        return '%' + t.toString(16).slice(1);
    });
    return decodeURIComponent(s);
}


/**
 * 解码word串
 * 
 * @param {string} s 加密串
 * @param {number} ix 加密参数
 * @return {string} 解密串
 */
function decodeWord(s, ix) {
    var p = ixHash[ix];
    if(undefined == p) {
        return false;
    }

    try {
        return decode(s, p);
    }
    catch (ex){
        return false;
    }
}

module.exports = decodeWord;